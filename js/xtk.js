/*
 * 
 *                  xxxxxxx      xxxxxxx
 *                   x:::::x    x:::::x 
 *                    x:::::x  x:::::x  
 *                     x:::::xx:::::x   
 *                      x::::::::::x    
 *                       x::::::::x     
 *                       x::::::::x     
 *                      x::::::::::x    
 *                     x:::::xx:::::x   
 *                    x:::::x  x:::::x  
 *                   x:::::x    x:::::x 
 *              THE xxxxxxx      xxxxxxx TOOLKIT
 *                    
 *                  http://www.goXTK.com
 *                   
 * Copyright (c) 2012 The X Toolkit Developers <dev@goXTK.com>
 *                   
 *    The X Toolkit (XTK) is licensed under the MIT License:
 *      http://www.opensource.org/licenses/mit-license.php
 * 
 *      "Free software" is a matter of liberty, not price.
 *      "Free" as in "free speech", not as in "free beer".
 *                                         - Richard M. Stallman
 * 
 * FUELED BY:
 *  - the wonderful Constructive Solid Geometry library by Evan Wallace (http://madebyevan.com)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/csg/LICENSE
 *
 *  - parts of the Google Closure Library (http://code.google.com/closure/library)
 *    LICENSE: https://raw.github.com/xtk/google-closure-library/master/LICENSE
 *
 *  - zlib.js, the ultimate gzip/zlib javascript implementation (https://github.com/imaya/zlib.js)
 *    LICENSE: https://raw.github.com/imaya/zlib.js/master/LICENSE
 *
 * MORE CREDITS: https://raw.github.com/xtk/X/master/LICENSE
 *
 */
var COMPILED=!0,goog=goog||{};goog.global=this;goog.define=function(a,b){var c=b;COMPILED||goog.global.CLOSURE_DEFINES&&Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_DEFINES,a)&&(c=goog.global.CLOSURE_DEFINES[a]);goog.exportPath_(a,c)};goog.DEBUG=!1;goog.LOCALE="en";goog.TRUSTED_SITE=!0;
goog.provide=function(a){if(!COMPILED){if(goog.isProvided_(a))throw Error('Namespace "'+a+'" already declared.');delete goog.implicitNamespaces_[a];for(var b=a;(b=b.substring(0,b.lastIndexOf(".")))&&!goog.getObjectByName(b);)goog.implicitNamespaces_[b]=!0}goog.exportPath_(a)};goog.setTestOnly=function(a){if(COMPILED&&!goog.DEBUG)throw a=a||"",Error("Importing test-only code into non-debug environment"+a?": "+a:".");};
COMPILED||(goog.isProvided_=function(a){return!goog.implicitNamespaces_[a]&&!!goog.getObjectByName(a)},goog.implicitNamespaces_={});goog.exportPath_=function(a,b,c){a=a.split(".");c=c||goog.global;!(a[0]in c)&&c.execScript&&c.execScript("var "+a[0]);for(var d;a.length&&(d=a.shift());)!a.length&&goog.isDef(b)?c[d]=b:c=c[d]?c[d]:c[d]={}};goog.getObjectByName=function(a,b){for(var c=a.split("."),d=b||goog.global,e;e=c.shift();)if(goog.isDefAndNotNull(d[e]))d=d[e];else return null;return d};
goog.globalize=function(a,b){var c=b||goog.global,d;for(d in a)c[d]=a[d]};goog.addDependency=function(a,b,c){if(!COMPILED){var d;a=a.replace(/\\/g,"/");for(var e=goog.dependencies_,f=0;d=b[f];f++)e.nameToPath[d]=a,a in e.pathToNames||(e.pathToNames[a]={}),e.pathToNames[a][d]=!0;for(d=0;b=c[d];d++)a in e.requires||(e.requires[a]={}),e.requires[a][b]=!0}};goog.ENABLE_DEBUG_LOADER=!0;
goog.require=function(a){if(!COMPILED&&!goog.isProvided_(a)){if(goog.ENABLE_DEBUG_LOADER){var b=goog.getPathFromDeps_(a);if(b){goog.included_[b]=!0;goog.writeScripts_();return}}a="goog.require could not find: "+a;goog.global.console&&goog.global.console.error(a);throw Error(a);}};goog.basePath="";goog.nullFunction=function(){};goog.identityFunction=function(a){return a};goog.abstractMethod=function(){throw Error("unimplemented abstract method");};
goog.addSingletonGetter=function(a){a.getInstance=function(){if(a.instance_)return a.instance_;goog.DEBUG&&(goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=a);return a.instance_=new a}};goog.instantiatedSingletons_=[];
!COMPILED&&goog.ENABLE_DEBUG_LOADER&&(goog.included_={},goog.dependencies_={pathToNames:{},nameToPath:{},requires:{},visited:{},written:{}},goog.inHtmlDocument_=function(){var a=goog.global.document;return"undefined"!=typeof a&&"write"in a},goog.findBasePath_=function(){if(goog.global.CLOSURE_BASE_PATH)goog.basePath=goog.global.CLOSURE_BASE_PATH;else if(goog.inHtmlDocument_())for(var a=goog.global.document.getElementsByTagName("script"),b=a.length-1;0<=b;--b){var c=a[b].src,d=c.lastIndexOf("?"),d=
-1==d?c.length:d;if("base.js"==c.substr(d-7,7)){goog.basePath=c.substr(0,d-7);break}}},goog.importScript_=function(a){var b=goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_;!goog.dependencies_.written[a]&&b(a)&&(goog.dependencies_.written[a]=!0)},goog.writeScriptTag_=function(a){if(goog.inHtmlDocument_()){var b=goog.global.document;if("complete"==b.readyState){if(/\bdeps.js$/.test(a))return!1;throw Error('Cannot write "'+a+'" after document load');}b.write('<script type="text/javascript" src="'+
a+'">\x3c/script>');return!0}return!1},goog.writeScripts_=function(){function a(e){if(!(e in d.written)){if(!(e in d.visited)&&(d.visited[e]=!0,e in d.requires))for(var g in d.requires[e])if(!goog.isProvided_(g))if(g in d.nameToPath)a(d.nameToPath[g]);else throw Error("Undefined nameToPath for "+g);e in c||(c[e]=!0,b.push(e))}}var b=[],c={},d=goog.dependencies_,e;for(e in goog.included_)d.written[e]||a(e);for(e=0;e<b.length;e++)if(b[e])goog.importScript_(goog.basePath+b[e]);else throw Error("Undefined script input");
},goog.getPathFromDeps_=function(a){return a in goog.dependencies_.nameToPath?goog.dependencies_.nameToPath[a]:null},goog.findBasePath_(),goog.global.CLOSURE_NO_DEPS||goog.importScript_(goog.basePath+"deps.js"));
goog.typeOf=function(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b};goog.isDef=function(a){return void 0!==a};goog.isNull=function(a){return null===a};goog.isDefAndNotNull=function(a){return null!=a};goog.isArray=function(a){return"array"==goog.typeOf(a)};goog.isArrayLike=function(a){var b=goog.typeOf(a);return"array"==b||"object"==b&&"number"==typeof a.length};goog.isDateLike=function(a){return goog.isObject(a)&&"function"==typeof a.getFullYear};goog.isString=function(a){return"string"==typeof a};
goog.isBoolean=function(a){return"boolean"==typeof a};goog.isNumber=function(a){return"number"==typeof a};goog.isFunction=function(a){return"function"==goog.typeOf(a)};goog.isObject=function(a){var b=typeof a;return"object"==b&&null!=a||"function"==b};goog.getUid=function(a){return a[goog.UID_PROPERTY_]||(a[goog.UID_PROPERTY_]=++goog.uidCounter_)};goog.removeUid=function(a){"removeAttribute"in a&&a.removeAttribute(goog.UID_PROPERTY_);try{delete a[goog.UID_PROPERTY_]}catch(b){}};
goog.UID_PROPERTY_="closure_uid_"+(1E9*Math.random()>>>0);goog.uidCounter_=0;goog.getHashCode=goog.getUid;goog.removeHashCode=goog.removeUid;goog.cloneObject=function(a){var b=goog.typeOf(a);if("object"==b||"array"==b){if(a.clone)return a.clone();var b="array"==b?[]:{},c;for(c in a)b[c]=goog.cloneObject(a[c]);return b}return a};goog.bindNative_=function(a,b,c){return a.call.apply(a.bind,arguments)};
goog.bindJs_=function(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}};goog.bind=function(a,b,c){goog.bind=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?goog.bindNative_:goog.bindJs_;return goog.bind.apply(null,arguments)};
goog.partial=function(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}};goog.mixin=function(a,b){for(var c in b)a[c]=b[c]};goog.now=goog.TRUSTED_SITE&&Date.now||function(){return+new Date};
goog.globalEval=function(a){if(goog.global.execScript)goog.global.execScript(a,"JavaScript");else if(goog.global.eval)if(null==goog.evalWorksForGlobals_&&(goog.global.eval("var _et_ = 1;"),"undefined"!=typeof goog.global._et_?(delete goog.global._et_,goog.evalWorksForGlobals_=!0):goog.evalWorksForGlobals_=!1),goog.evalWorksForGlobals_)goog.global.eval(a);else{var b=goog.global.document,c=b.createElement("script");c.type="text/javascript";c.defer=!1;c.appendChild(b.createTextNode(a));b.body.appendChild(c);
b.body.removeChild(c)}else throw Error("goog.globalEval not available");};goog.evalWorksForGlobals_=null;goog.getCssName=function(a,b){var c=function(a){return goog.cssNameMapping_[a]||a},d=function(a){a=a.split("-");for(var b=[],d=0;d<a.length;d++)b.push(c(a[d]));return b.join("-")},d=goog.cssNameMapping_?"BY_WHOLE"==goog.cssNameMappingStyle_?c:d:function(a){return a};return b?a+"-"+d(b):d(a)};goog.setCssNameMapping=function(a,b){goog.cssNameMapping_=a;goog.cssNameMappingStyle_=b};
!COMPILED&&goog.global.CLOSURE_CSS_NAME_MAPPING&&(goog.cssNameMapping_=goog.global.CLOSURE_CSS_NAME_MAPPING);goog.getMsg=function(a,b){var c=b||{},d;for(d in c){var e=(""+c[d]).replace(/\$/g,"$$$$");a=a.replace(RegExp("\\{\\$"+d+"\\}","gi"),e)}return a};goog.getMsgWithFallback=function(a){return a};goog.exportSymbol=function(a,b,c){goog.exportPath_(a,b,c)};goog.exportProperty=function(a,b,c){a[b]=c};
goog.inherits=function(a,b){function c(){}c.prototype=b.prototype;a.superClass_=b.prototype;a.prototype=new c;a.prototype.constructor=a};
goog.base=function(a,b,c){var d=arguments.callee.caller;if(goog.DEBUG&&!d)throw Error("arguments.caller not defined.  goog.base() expects not to be running in strict mode. See http://www.ecma-international.org/ecma-262/5.1/#sec-C");if(d.superClass_)return d.superClass_.constructor.apply(a,Array.prototype.slice.call(arguments,1));for(var e=Array.prototype.slice.call(arguments,2),f=!1,g=a.constructor;g;g=g.superClass_&&g.superClass_.constructor)if(g.prototype[b]===d)f=!0;else if(f)return g.prototype[b].apply(a,
e);if(a[b]===d)return a.constructor.prototype[b].apply(a,e);throw Error("goog.base called from a method of one name to a method of a different name");};goog.scope=function(a){a.call(goog.global)};var csgVector=function(a,b,c){this.z_=this.y_=this.x_=0;3==arguments.length?(this.x_=Number(a),this.y_=Number(b),this.z_=Number(c)):a instanceof csgVector?(this.x_=Number(a.x()),this.y_=Number(a.y()),this.z_=Number(a.z())):(this.x_=Number(a[0]),this.y_=Number(a[1]),this.z_=Number(a[2]))};
csgVector.prototype={clone:function(){return new csgVector(this.x_,this.y_,this.z_)},negated:function(){return new csgVector(-this.x_,-this.y_,-this.z_)},plus:function(a){return new csgVector(this.x_+a.x(),this.y_+a.y(),this.z_+a.z())},minus:function(a){return new csgVector(this.x_-a.x(),this.y_-a.y(),this.z_-a.z())},times:function(a){return new csgVector(this.x_*a,this.y_*a,this.z_*a)},dividedBy:function(a){return new csgVector(this.x_/a,this.y_/a,this.z_/a)},dot:function(a){return this.x_*a.x()+
this.y_*a.y()+this.z_*a.z()},lerp:function(a,b){return this.plus(a.minus(this).times(b))},length:function(){return Math.sqrt(this.dot(this))},unit:function(){return this.dividedBy(this.length())},cross:function(a){return new csgVector(this.y_*a.z()-this.z_*a.y(),this.z_*a.x()-this.x_*a.z(),this.x_*a.y()-this.y_*a.x())},x:function(){return this.x_},y:function(){return this.y_},z:function(){return this.z_}};var X=X||{};X.DEV=!0;X.TIMER=function(a){eval("X.DEV === undefined")||window.console.time(a)};X.TIMERSTOP=function(a){eval("X.DEV === undefined")||window.console.timeEnd(a)};X.counter=function(){this._counter=0;this.uniqueId=function(){return this._counter++}};window["X.counter"]=new X.counter;function inject(a,b){for(var c in b){var d=b.__lookupGetter__(c),e=b.__lookupSetter__(c);c in a||(d||e?(d&&a.__defineGetter__(c,d),e&&a.__defineSetter__(c,e)):a[c]=b[c])}return a}var $=window.$;
function bind_shim(){Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice,c=b.call(arguments,1),d=this,e=function(){},f=function(){return d.apply(this instanceof e?this:a||window,c.concat(b.call(arguments)))};e.prototype=this.prototype;f.prototype=new e;return f})}
function requestAnimationFrame_shim(){for(var a=0,b=["ms","moz","webkit","o"],c=0;c<b.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[b[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[b[c]+"CancelAnimationFrame"]||window[b[c]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(b){var c=Date.now(),f=Math.max(0,16-(c-a)),g=window.setTimeout(function(){b(c+f)},f);a=c+f;return g});window.cancelAnimationFrame||
(window.cancelAnimationFrame=function(a){clearTimeout(a)})}
function arrayBufferSlice_shim(){"slice"in ArrayBuffer.prototype||(ArrayBuffer.prototype.slice=function(a,b){if(void 0===a)throw Error("Not enough arguments.");var c=b||this.byteLength;0>a&&(a=this.byteLength+a);0>c&&(c=this.byteLength+c);c<a&&(c=a=0);0>a&&(a=0);0>c&&(c=0);a>this.byteLength&&(a=this.byteLength);c>this.byteLength&&(c=this.byteLength);for(var d=new ArrayBuffer(c-a),e=new Uint8Array(this),f=new Uint8Array(d),g=a,h=0;g<c;++g,++h)f[h]=e[g];return d})}bind_shim();requestAnimationFrame_shim();
arrayBufferSlice_shim();goog.exportSymbol("$",$);goog.exportSymbol("Function.prototype.bind",Function.prototype.bind);goog.exportSymbol("window.requestAnimationFrame",window.requestAnimationFrame);goog.exportSymbol("window.cancelAnimationFrame",window.cancelAnimationFrame);goog.events={};goog.events.Listenable=function(){};goog.events.Listenable.USE_LISTENABLE_INTERFACE=!1;goog.events.Listenable.IMPLEMENTED_BY_PROP="closure_listenable_"+(1E6*Math.random()|0);goog.events.Listenable.addImplementation=function(a){a.prototype[goog.events.Listenable.IMPLEMENTED_BY_PROP]=!0};goog.events.Listenable.isImplementedBy=function(a){return!(!a||!a[goog.events.Listenable.IMPLEMENTED_BY_PROP])};goog.events.ListenableKey=function(){};goog.events.ListenableKey.counter_=0;
goog.events.ListenableKey.reserveKey=function(){return++goog.events.ListenableKey.counter_};goog.events.Listener=function(){goog.events.Listener.ENABLE_MONITORING&&(this.creationStack=Error().stack)};goog.events.Listener.ENABLE_MONITORING=!1;goog.events.Listener.prototype.key=0;goog.events.Listener.prototype.removed=!1;goog.events.Listener.prototype.callOnce=!1;
goog.events.Listener.prototype.init=function(a,b,c,d,e,f){if(goog.isFunction(a))this.isFunctionListener_=!0;else if(a&&a.handleEvent&&goog.isFunction(a.handleEvent))this.isFunctionListener_=!1;else throw Error("Invalid listener argument");this.listener=a;this.proxy=b;this.src=c;this.type=d;this.capture=!!e;this.handler=f;this.callOnce=!1;this.key=goog.events.ListenableKey.reserveKey();this.removed=!1};
goog.events.Listener.prototype.handleEvent=function(a){return this.isFunctionListener_?this.listener.call(this.handler||this.src,a):this.listener.handleEvent.call(this.listener,a)};goog.object={};goog.object.forEach=function(a,b,c){for(var d in a)b.call(c,a[d],d,a)};goog.object.filter=function(a,b,c){var d={},e;for(e in a)b.call(c,a[e],e,a)&&(d[e]=a[e]);return d};goog.object.map=function(a,b,c){var d={},e;for(e in a)d[e]=b.call(c,a[e],e,a);return d};goog.object.some=function(a,b,c){for(var d in a)if(b.call(c,a[d],d,a))return!0;return!1};goog.object.every=function(a,b,c){for(var d in a)if(!b.call(c,a[d],d,a))return!1;return!0};
goog.object.getCount=function(a){var b=0,c;for(c in a)b++;return b};goog.object.getAnyKey=function(a){for(var b in a)return b};goog.object.getAnyValue=function(a){for(var b in a)return a[b]};goog.object.contains=function(a,b){return goog.object.containsValue(a,b)};goog.object.getValues=function(a){var b=[],c=0,d;for(d in a)b[c++]=a[d];return b};goog.object.getKeys=function(a){var b=[],c=0,d;for(d in a)b[c++]=d;return b};
goog.object.getValueByKeys=function(a,b){for(var c=goog.isArrayLike(b),d=c?b:arguments,c=c?0:1;c<d.length&&!(a=a[d[c]],!goog.isDef(a));c++);return a};goog.object.containsKey=function(a,b){return b in a};goog.object.containsValue=function(a,b){for(var c in a)if(a[c]==b)return!0;return!1};goog.object.findKey=function(a,b,c){for(var d in a)if(b.call(c,a[d],d,a))return d};goog.object.findValue=function(a,b,c){return(b=goog.object.findKey(a,b,c))&&a[b]};
goog.object.isEmpty=function(a){for(var b in a)return!1;return!0};goog.object.clear=function(a){for(var b in a)delete a[b]};goog.object.remove=function(a,b){var c;(c=b in a)&&delete a[b];return c};goog.object.add=function(a,b,c){if(b in a)throw Error('The object already contains the key "'+b+'"');goog.object.set(a,b,c)};goog.object.get=function(a,b,c){return b in a?a[b]:c};goog.object.set=function(a,b,c){a[b]=c};goog.object.setIfUndefined=function(a,b,c){return b in a?a[b]:a[b]=c};
goog.object.clone=function(a){var b={},c;for(c in a)b[c]=a[c];return b};goog.object.unsafeClone=function(a){var b=goog.typeOf(a);if("object"==b||"array"==b){if(a.clone)return a.clone();var b="array"==b?[]:{},c;for(c in a)b[c]=goog.object.unsafeClone(a[c]);return b}return a};goog.object.transpose=function(a){var b={},c;for(c in a)b[a[c]]=c;return b};goog.object.PROTOTYPE_FIELDS_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");
goog.object.extend=function(a,b){for(var c,d,e=1;e<arguments.length;e++){d=arguments[e];for(c in d)a[c]=d[c];for(var f=0;f<goog.object.PROTOTYPE_FIELDS_.length;f++)c=goog.object.PROTOTYPE_FIELDS_[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}};
goog.object.create=function(a){var b=arguments.length;if(1==b&&goog.isArray(arguments[0]))return goog.object.create.apply(null,arguments[0]);if(b%2)throw Error("Uneven number of arguments");for(var c={},d=0;d<b;d+=2)c[arguments[d]]=arguments[d+1];return c};goog.object.createSet=function(a){var b=arguments.length;if(1==b&&goog.isArray(arguments[0]))return goog.object.createSet.apply(null,arguments[0]);for(var c={},d=0;d<b;d++)c[arguments[d]]=!0;return c};
goog.object.createImmutableView=function(a){var b=a;Object.isFrozen&&!Object.isFrozen(a)&&(b=Object.create(a),Object.freeze(b));return b};goog.object.isImmutableView=function(a){return!!Object.isFrozen&&Object.isFrozen(a)};goog.string={};goog.string.Unicode={NBSP:"\u00a0"};goog.string.startsWith=function(a,b){return 0==a.lastIndexOf(b,0)};goog.string.endsWith=function(a,b){var c=a.length-b.length;return 0<=c&&a.indexOf(b,c)==c};goog.string.caseInsensitiveStartsWith=function(a,b){return 0==goog.string.caseInsensitiveCompare(b,a.substr(0,b.length))};goog.string.caseInsensitiveEndsWith=function(a,b){return 0==goog.string.caseInsensitiveCompare(b,a.substr(a.length-b.length,b.length))};
goog.string.caseInsensitiveEquals=function(a,b){return a.toLowerCase()==b.toLowerCase()};goog.string.subs=function(a,b){for(var c=1;c<arguments.length;c++){var d=String(arguments[c]).replace(/\$/g,"$$$$");a=a.replace(/\%s/,d)}return a};goog.string.collapseWhitespace=function(a){return a.replace(/[\s\xa0]+/g," ").replace(/^\s+|\s+$/g,"")};goog.string.isEmpty=function(a){return/^[\s\xa0]*$/.test(a)};goog.string.isEmptySafe=function(a){return goog.string.isEmpty(goog.string.makeSafe(a))};
goog.string.isBreakingWhitespace=function(a){return!/[^\t\n\r ]/.test(a)};goog.string.isAlpha=function(a){return!/[^a-zA-Z]/.test(a)};goog.string.isNumeric=function(a){return!/[^0-9]/.test(a)};goog.string.isAlphaNumeric=function(a){return!/[^a-zA-Z0-9]/.test(a)};goog.string.isSpace=function(a){return" "==a};goog.string.isUnicodeChar=function(a){return 1==a.length&&" "<=a&&"~">=a||"\u0080"<=a&&"\ufffd">=a};goog.string.stripNewlines=function(a){return a.replace(/(\r\n|\r|\n)+/g," ")};
goog.string.canonicalizeNewlines=function(a){return a.replace(/(\r\n|\r|\n)/g,"\n")};goog.string.normalizeWhitespace=function(a){return a.replace(/\xa0|\s/g," ")};goog.string.normalizeSpaces=function(a){return a.replace(/\xa0|[ \t]+/g," ")};goog.string.collapseBreakingSpaces=function(a){return a.replace(/[\t\r\n ]+/g," ").replace(/^[\t\r\n ]+|[\t\r\n ]+$/g,"")};goog.string.trim=function(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")};
goog.string.trimLeft=function(a){return a.replace(/^[\s\xa0]+/,"")};goog.string.trimRight=function(a){return a.replace(/[\s\xa0]+$/,"")};goog.string.caseInsensitiveCompare=function(a,b){var c=String(a).toLowerCase(),d=String(b).toLowerCase();return c<d?-1:c==d?0:1};goog.string.numerateCompareRegExp_=/(\.\d+)|(\d+)|(\D+)/g;
goog.string.numerateCompare=function(a,b){if(a==b)return 0;if(!a)return-1;if(!b)return 1;for(var c=a.toLowerCase().match(goog.string.numerateCompareRegExp_),d=b.toLowerCase().match(goog.string.numerateCompareRegExp_),e=Math.min(c.length,d.length),f=0;f<e;f++){var g=c[f],h=d[f];if(g!=h)return c=parseInt(g,10),!isNaN(c)&&(d=parseInt(h,10),!isNaN(d)&&c-d)?c-d:g<h?-1:1}return c.length!=d.length?c.length-d.length:a<b?-1:1};goog.string.urlEncode=function(a){return encodeURIComponent(String(a))};
goog.string.urlDecode=function(a){return decodeURIComponent(a.replace(/\+/g," "))};goog.string.newLineToBr=function(a,b){return a.replace(/(\r\n|\r|\n)/g,b?"<br />":"<br>")};
goog.string.htmlEscape=function(a,b){if(b)return a.replace(goog.string.amperRe_,"&amp;").replace(goog.string.ltRe_,"&lt;").replace(goog.string.gtRe_,"&gt;").replace(goog.string.quotRe_,"&quot;");if(!goog.string.allRe_.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(goog.string.amperRe_,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(goog.string.ltRe_,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(goog.string.gtRe_,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(goog.string.quotRe_,"&quot;"));return a};
goog.string.amperRe_=/&/g;goog.string.ltRe_=/</g;goog.string.gtRe_=/>/g;goog.string.quotRe_=/\"/g;goog.string.allRe_=/[&<>\"]/;goog.string.unescapeEntities=function(a){return goog.string.contains(a,"&")?"document"in goog.global?goog.string.unescapeEntitiesUsingDom_(a):goog.string.unescapePureXmlEntities_(a):a};
goog.string.unescapeEntitiesUsingDom_=function(a){var b={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"'},c=document.createElement("div");return a.replace(goog.string.HTML_ENTITY_PATTERN_,function(a,e){var f=b[a];if(f)return f;if("#"==e.charAt(0)){var g=Number("0"+e.substr(1));isNaN(g)||(f=String.fromCharCode(g))}f||(c.innerHTML=a+" ",f=c.firstChild.nodeValue.slice(0,-1));return b[a]=f})};
goog.string.unescapePureXmlEntities_=function(a){return a.replace(/&([^;]+);/g,function(a,c){switch(c){case "amp":return"&";case "lt":return"<";case "gt":return">";case "quot":return'"';default:if("#"==c.charAt(0)){var d=Number("0"+c.substr(1));if(!isNaN(d))return String.fromCharCode(d)}return a}})};goog.string.HTML_ENTITY_PATTERN_=/&([^;\s<&]+);?/g;goog.string.whitespaceEscape=function(a,b){return goog.string.newLineToBr(a.replace(/  /g," &#160;"),b)};
goog.string.stripQuotes=function(a,b){for(var c=b.length,d=0;d<c;d++){var e=1==c?b:b.charAt(d);if(a.charAt(0)==e&&a.charAt(a.length-1)==e)return a.substring(1,a.length-1)}return a};goog.string.truncate=function(a,b,c){c&&(a=goog.string.unescapeEntities(a));a.length>b&&(a=a.substring(0,b-3)+"...");c&&(a=goog.string.htmlEscape(a));return a};
goog.string.truncateMiddle=function(a,b,c,d){c&&(a=goog.string.unescapeEntities(a));if(d&&a.length>b){d>b&&(d=b);var e=a.length-d;a=a.substring(0,b-d)+"..."+a.substring(e)}else a.length>b&&(d=Math.floor(b/2),e=a.length-d,a=a.substring(0,d+b%2)+"..."+a.substring(e));c&&(a=goog.string.htmlEscape(a));return a};goog.string.specialEscapeChars_={"\x00":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\x0B",'"':'\\"',"\\":"\\\\"};goog.string.jsEscapeCache_={"'":"\\'"};
goog.string.quote=function(a){a=String(a);if(a.quote)return a.quote();for(var b=['"'],c=0;c<a.length;c++){var d=a.charAt(c),e=d.charCodeAt(0);b[c+1]=goog.string.specialEscapeChars_[d]||(31<e&&127>e?d:goog.string.escapeChar(d))}b.push('"');return b.join("")};goog.string.escapeString=function(a){for(var b=[],c=0;c<a.length;c++)b[c]=goog.string.escapeChar(a.charAt(c));return b.join("")};
goog.string.escapeChar=function(a){if(a in goog.string.jsEscapeCache_)return goog.string.jsEscapeCache_[a];if(a in goog.string.specialEscapeChars_)return goog.string.jsEscapeCache_[a]=goog.string.specialEscapeChars_[a];var b=a,c=a.charCodeAt(0);if(31<c&&127>c)b=a;else{if(256>c){if(b="\\x",16>c||256<c)b+="0"}else b="\\u",4096>c&&(b+="0");b+=c.toString(16).toUpperCase()}return goog.string.jsEscapeCache_[a]=b};goog.string.toMap=function(a){for(var b={},c=0;c<a.length;c++)b[a.charAt(c)]=!0;return b};
goog.string.contains=function(a,b){return-1!=a.indexOf(b)};goog.string.countOf=function(a,b){return a&&b?a.split(b).length-1:0};goog.string.removeAt=function(a,b,c){var d=a;0<=b&&(b<a.length&&0<c)&&(d=a.substr(0,b)+a.substr(b+c,a.length-b-c));return d};goog.string.remove=function(a,b){var c=RegExp(goog.string.regExpEscape(b),"");return a.replace(c,"")};goog.string.removeAll=function(a,b){var c=RegExp(goog.string.regExpEscape(b),"g");return a.replace(c,"")};
goog.string.regExpEscape=function(a){return String(a).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")};goog.string.repeat=function(a,b){return Array(b+1).join(a)};goog.string.padNumber=function(a,b,c){a=goog.isDef(c)?a.toFixed(c):String(a);c=a.indexOf(".");-1==c&&(c=a.length);return goog.string.repeat("0",Math.max(0,b-c))+a};goog.string.makeSafe=function(a){return null==a?"":String(a)};goog.string.buildString=function(a){return Array.prototype.join.call(arguments,"")};
goog.string.getRandomString=function(){return Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^goog.now()).toString(36)};
goog.string.compareVersions=function(a,b){for(var c=0,d=goog.string.trim(String(a)).split("."),e=goog.string.trim(String(b)).split("."),f=Math.max(d.length,e.length),g=0;0==c&&g<f;g++){var h=d[g]||"",k=e[g]||"",j=RegExp("(\\d*)(\\D*)","g"),m=RegExp("(\\d*)(\\D*)","g");do{var l=j.exec(h)||["","",""],n=m.exec(k)||["","",""];if(0==l[0].length&&0==n[0].length)break;var c=0==l[1].length?0:parseInt(l[1],10),p=0==n[1].length?0:parseInt(n[1],10),c=goog.string.compareElements_(c,p)||goog.string.compareElements_(0==
l[2].length,0==n[2].length)||goog.string.compareElements_(l[2],n[2])}while(0==c)}return c};goog.string.compareElements_=function(a,b){return a<b?-1:a>b?1:0};goog.string.HASHCODE_MAX_=4294967296;goog.string.hashCode=function(a){for(var b=0,c=0;c<a.length;++c)b=31*b+a.charCodeAt(c),b%=goog.string.HASHCODE_MAX_;return b};goog.string.uniqueStringCounter_=2147483648*Math.random()|0;goog.string.createUniqueString=function(){return"goog_"+goog.string.uniqueStringCounter_++};
goog.string.toNumber=function(a){var b=Number(a);return 0==b&&goog.string.isEmpty(a)?NaN:b};goog.string.toCamelCase=function(a){return String(a).replace(/\-([a-z])/g,function(a,c){return c.toUpperCase()})};goog.string.toSelectorCase=function(a){return String(a).replace(/([A-Z])/g,"-$1").toLowerCase()};goog.string.toTitleCase=function(a,b){var c=goog.isString(b)?goog.string.regExpEscape(b):"\\s";return a.replace(RegExp("(^"+(c?"|["+c+"]+":"")+")([a-z])","g"),function(a,b,c){return b+c.toUpperCase()})};
goog.string.parseInt=function(a){isFinite(a)&&(a=String(a));return goog.isString(a)?/^\s*-?0x/i.test(a)?parseInt(a,16):parseInt(a,10):NaN};goog.userAgent={};goog.userAgent.ASSUME_IE=!1;goog.userAgent.ASSUME_GECKO=!1;goog.userAgent.ASSUME_WEBKIT=!1;goog.userAgent.ASSUME_MOBILE_WEBKIT=!1;goog.userAgent.ASSUME_OPERA=!1;goog.userAgent.ASSUME_ANY_VERSION=!1;goog.userAgent.BROWSER_KNOWN_=goog.userAgent.ASSUME_IE||goog.userAgent.ASSUME_GECKO||goog.userAgent.ASSUME_MOBILE_WEBKIT||goog.userAgent.ASSUME_WEBKIT||goog.userAgent.ASSUME_OPERA;
goog.userAgent.getUserAgentString=function(){return goog.global.navigator?goog.global.navigator.userAgent:null};goog.userAgent.getNavigator=function(){return goog.global.navigator};
goog.userAgent.init_=function(){goog.userAgent.detectedOpera_=!1;goog.userAgent.detectedIe_=!1;goog.userAgent.detectedWebkit_=!1;goog.userAgent.detectedMobile_=!1;goog.userAgent.detectedGecko_=!1;var a;if(!goog.userAgent.BROWSER_KNOWN_&&(a=goog.userAgent.getUserAgentString())){var b=goog.userAgent.getNavigator();goog.userAgent.detectedOpera_=0==a.indexOf("Opera");goog.userAgent.detectedIe_=!goog.userAgent.detectedOpera_&&-1!=a.indexOf("MSIE");goog.userAgent.detectedWebkit_=!goog.userAgent.detectedOpera_&&
-1!=a.indexOf("WebKit");goog.userAgent.detectedMobile_=goog.userAgent.detectedWebkit_&&-1!=a.indexOf("Mobile");goog.userAgent.detectedGecko_=!goog.userAgent.detectedOpera_&&!goog.userAgent.detectedWebkit_&&"Gecko"==b.product}};goog.userAgent.BROWSER_KNOWN_||goog.userAgent.init_();goog.userAgent.OPERA=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_OPERA:goog.userAgent.detectedOpera_;goog.userAgent.IE=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_IE:goog.userAgent.detectedIe_;
goog.userAgent.GECKO=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_GECKO:goog.userAgent.detectedGecko_;goog.userAgent.WEBKIT=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_WEBKIT||goog.userAgent.ASSUME_MOBILE_WEBKIT:goog.userAgent.detectedWebkit_;goog.userAgent.MOBILE=goog.userAgent.ASSUME_MOBILE_WEBKIT||goog.userAgent.detectedMobile_;goog.userAgent.SAFARI=goog.userAgent.WEBKIT;goog.userAgent.determinePlatform_=function(){var a=goog.userAgent.getNavigator();return a&&a.platform||""};
goog.userAgent.PLATFORM=goog.userAgent.determinePlatform_();goog.userAgent.ASSUME_MAC=!1;goog.userAgent.ASSUME_WINDOWS=!1;goog.userAgent.ASSUME_LINUX=!1;goog.userAgent.ASSUME_X11=!1;goog.userAgent.ASSUME_ANDROID=!1;goog.userAgent.ASSUME_IPHONE=!1;goog.userAgent.ASSUME_IPAD=!1;goog.userAgent.PLATFORM_KNOWN_=goog.userAgent.ASSUME_MAC||goog.userAgent.ASSUME_WINDOWS||goog.userAgent.ASSUME_LINUX||goog.userAgent.ASSUME_X11||goog.userAgent.ASSUME_ANDROID||goog.userAgent.ASSUME_IPHONE||goog.userAgent.ASSUME_IPAD;
goog.userAgent.initPlatform_=function(){goog.userAgent.detectedMac_=goog.string.contains(goog.userAgent.PLATFORM,"Mac");goog.userAgent.detectedWindows_=goog.string.contains(goog.userAgent.PLATFORM,"Win");goog.userAgent.detectedLinux_=goog.string.contains(goog.userAgent.PLATFORM,"Linux");goog.userAgent.detectedX11_=!!goog.userAgent.getNavigator()&&goog.string.contains(goog.userAgent.getNavigator().appVersion||"","X11");var a=goog.userAgent.getUserAgentString();goog.userAgent.detectedAndroid_=!!a&&
0<=a.indexOf("Android");goog.userAgent.detectedIPhone_=!!a&&0<=a.indexOf("iPhone");goog.userAgent.detectedIPad_=!!a&&0<=a.indexOf("iPad")};goog.userAgent.PLATFORM_KNOWN_||goog.userAgent.initPlatform_();goog.userAgent.MAC=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_MAC:goog.userAgent.detectedMac_;goog.userAgent.WINDOWS=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_WINDOWS:goog.userAgent.detectedWindows_;
goog.userAgent.LINUX=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_LINUX:goog.userAgent.detectedLinux_;goog.userAgent.X11=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_X11:goog.userAgent.detectedX11_;goog.userAgent.ANDROID=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_ANDROID:goog.userAgent.detectedAndroid_;goog.userAgent.IPHONE=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPHONE:goog.userAgent.detectedIPhone_;
goog.userAgent.IPAD=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPAD:goog.userAgent.detectedIPad_;
goog.userAgent.determineVersion_=function(){var a="",b;goog.userAgent.OPERA&&goog.global.opera?(a=goog.global.opera.version,a="function"==typeof a?a():a):(goog.userAgent.GECKO?b=/rv\:([^\);]+)(\)|;)/:goog.userAgent.IE?b=/MSIE\s+([^\);]+)(\)|;)/:goog.userAgent.WEBKIT&&(b=/WebKit\/(\S+)/),b&&(a=(a=b.exec(goog.userAgent.getUserAgentString()))?a[1]:""));return goog.userAgent.IE&&(b=goog.userAgent.getDocumentMode_(),b>parseFloat(a))?String(b):a};
goog.userAgent.getDocumentMode_=function(){var a=goog.global.document;return a?a.documentMode:void 0};goog.userAgent.VERSION=goog.userAgent.determineVersion_();goog.userAgent.compare=function(a,b){return goog.string.compareVersions(a,b)};goog.userAgent.isVersionOrHigherCache_={};
goog.userAgent.isVersionOrHigher=function(a){return goog.userAgent.ASSUME_ANY_VERSION||goog.userAgent.isVersionOrHigherCache_[a]||(goog.userAgent.isVersionOrHigherCache_[a]=0<=goog.string.compareVersions(goog.userAgent.VERSION,a))};goog.userAgent.isVersion=goog.userAgent.isVersionOrHigher;goog.userAgent.isDocumentMode=function(a){return goog.userAgent.IE&&goog.userAgent.DOCUMENT_MODE>=a};
goog.userAgent.DOCUMENT_MODE=function(){var a=goog.global.document;return!a||!goog.userAgent.IE?void 0:goog.userAgent.getDocumentMode_()||("CSS1Compat"==a.compatMode?parseInt(goog.userAgent.VERSION,10):5)}();goog.events.BrowserFeature={HAS_W3C_BUTTON:!goog.userAgent.IE||goog.userAgent.isDocumentMode(9),HAS_W3C_EVENT_SUPPORT:!goog.userAgent.IE||goog.userAgent.isDocumentMode(9),SET_KEY_CODE_TO_PREVENT_DEFAULT:goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("9"),HAS_NAVIGATOR_ONLINE_PROPERTY:!goog.userAgent.WEBKIT||goog.userAgent.isVersionOrHigher("528"),HAS_HTML5_NETWORK_EVENT_SUPPORT:goog.userAgent.GECKO&&goog.userAgent.isVersionOrHigher("1.9b")||goog.userAgent.IE&&goog.userAgent.isVersionOrHigher("8")||
goog.userAgent.OPERA&&goog.userAgent.isVersionOrHigher("9.5")||goog.userAgent.WEBKIT&&goog.userAgent.isVersionOrHigher("528"),HTML5_NETWORK_EVENTS_FIRE_ON_BODY:goog.userAgent.GECKO&&!goog.userAgent.isVersionOrHigher("8")||goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("9"),TOUCH_ENABLED:"ontouchstart"in goog.global||!(!goog.global.document||!(document.documentElement&&"ontouchstart"in document.documentElement))||!(!goog.global.navigator||!goog.global.navigator.msMaxTouchPoints)};goog.debug={};goog.debug.Error=function(a){Error.captureStackTrace?Error.captureStackTrace(this,goog.debug.Error):this.stack=Error().stack||"";a&&(this.message=String(a))};goog.inherits(goog.debug.Error,Error);goog.debug.Error.prototype.name="CustomError";goog.asserts={};goog.asserts.ENABLE_ASSERTS=goog.DEBUG;goog.asserts.AssertionError=function(a,b){b.unshift(a);goog.debug.Error.call(this,goog.string.subs.apply(null,b));b.shift();this.messagePattern=a};goog.inherits(goog.asserts.AssertionError,goog.debug.Error);goog.asserts.AssertionError.prototype.name="AssertionError";goog.asserts.doAssertFailure_=function(a,b,c,d){var e="Assertion failed";if(c)var e=e+(": "+c),f=d;else a&&(e+=": "+a,f=b);throw new goog.asserts.AssertionError(""+e,f||[]);};
goog.asserts.assert=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!a&&goog.asserts.doAssertFailure_("",null,b,Array.prototype.slice.call(arguments,2));return a};goog.asserts.fail=function(a,b){if(goog.asserts.ENABLE_ASSERTS)throw new goog.asserts.AssertionError("Failure"+(a?": "+a:""),Array.prototype.slice.call(arguments,1));};
goog.asserts.assertNumber=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!goog.isNumber(a)&&goog.asserts.doAssertFailure_("Expected number but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};goog.asserts.assertString=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!goog.isString(a)&&goog.asserts.doAssertFailure_("Expected string but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};
goog.asserts.assertFunction=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!goog.isFunction(a)&&goog.asserts.doAssertFailure_("Expected function but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};goog.asserts.assertObject=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!goog.isObject(a)&&goog.asserts.doAssertFailure_("Expected object but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};
goog.asserts.assertArray=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!goog.isArray(a)&&goog.asserts.doAssertFailure_("Expected array but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};goog.asserts.assertBoolean=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!goog.isBoolean(a)&&goog.asserts.doAssertFailure_("Expected boolean but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};
goog.asserts.assertInstanceof=function(a,b,c,d){goog.asserts.ENABLE_ASSERTS&&!(a instanceof b)&&goog.asserts.doAssertFailure_("instanceof check failed.",null,c,Array.prototype.slice.call(arguments,3));return a};goog.array={};goog.NATIVE_ARRAY_PROTOTYPES=goog.TRUSTED_SITE;goog.array.peek=function(a){return a[a.length-1]};goog.array.ARRAY_PROTOTYPE_=Array.prototype;
goog.array.indexOf=goog.NATIVE_ARRAY_PROTOTYPES&&goog.array.ARRAY_PROTOTYPE_.indexOf?function(a,b,c){goog.asserts.assert(null!=a.length);return goog.array.ARRAY_PROTOTYPE_.indexOf.call(a,b,c)}:function(a,b,c){c=null==c?0:0>c?Math.max(0,a.length+c):c;if(goog.isString(a))return!goog.isString(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1};
goog.array.lastIndexOf=goog.NATIVE_ARRAY_PROTOTYPES&&goog.array.ARRAY_PROTOTYPE_.lastIndexOf?function(a,b,c){goog.asserts.assert(null!=a.length);return goog.array.ARRAY_PROTOTYPE_.lastIndexOf.call(a,b,null==c?a.length-1:c)}:function(a,b,c){c=null==c?a.length-1:c;0>c&&(c=Math.max(0,a.length+c));if(goog.isString(a))return!goog.isString(b)||1!=b.length?-1:a.lastIndexOf(b,c);for(;0<=c;c--)if(c in a&&a[c]===b)return c;return-1};
goog.array.forEach=goog.NATIVE_ARRAY_PROTOTYPES&&goog.array.ARRAY_PROTOTYPE_.forEach?function(a,b,c){goog.asserts.assert(null!=a.length);goog.array.ARRAY_PROTOTYPE_.forEach.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=goog.isString(a)?a.split(""):a,f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)};goog.array.forEachRight=function(a,b,c){for(var d=a.length,e=goog.isString(a)?a.split(""):a,d=d-1;0<=d;--d)d in e&&b.call(c,e[d],d,a)};
goog.array.filter=goog.NATIVE_ARRAY_PROTOTYPES&&goog.array.ARRAY_PROTOTYPE_.filter?function(a,b,c){goog.asserts.assert(null!=a.length);return goog.array.ARRAY_PROTOTYPE_.filter.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=[],f=0,g=goog.isString(a)?a.split(""):a,h=0;h<d;h++)if(h in g){var k=g[h];b.call(c,k,h,a)&&(e[f++]=k)}return e};
goog.array.map=goog.NATIVE_ARRAY_PROTOTYPES&&goog.array.ARRAY_PROTOTYPE_.map?function(a,b,c){goog.asserts.assert(null!=a.length);return goog.array.ARRAY_PROTOTYPE_.map.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=Array(d),f=goog.isString(a)?a.split(""):a,g=0;g<d;g++)g in f&&(e[g]=b.call(c,f[g],g,a));return e};goog.array.reduce=function(a,b,c,d){if(a.reduce)return d?a.reduce(goog.bind(b,d),c):a.reduce(b,c);var e=c;goog.array.forEach(a,function(c,g){e=b.call(d,e,c,g,a)});return e};
goog.array.reduceRight=function(a,b,c,d){if(a.reduceRight)return d?a.reduceRight(goog.bind(b,d),c):a.reduceRight(b,c);var e=c;goog.array.forEachRight(a,function(c,g){e=b.call(d,e,c,g,a)});return e};
goog.array.some=goog.NATIVE_ARRAY_PROTOTYPES&&goog.array.ARRAY_PROTOTYPE_.some?function(a,b,c){goog.asserts.assert(null!=a.length);return goog.array.ARRAY_PROTOTYPE_.some.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=goog.isString(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return!0;return!1};
goog.array.every=goog.NATIVE_ARRAY_PROTOTYPES&&goog.array.ARRAY_PROTOTYPE_.every?function(a,b,c){goog.asserts.assert(null!=a.length);return goog.array.ARRAY_PROTOTYPE_.every.call(a,b,c)}:function(a,b,c){for(var d=a.length,e=goog.isString(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&!b.call(c,e[f],f,a))return!1;return!0};goog.array.count=function(a,b,c){var d=0;goog.array.forEach(a,function(a,f,g){b.call(c,a,f,g)&&++d},c);return d};
goog.array.find=function(a,b,c){b=goog.array.findIndex(a,b,c);return 0>b?null:goog.isString(a)?a.charAt(b):a[b]};goog.array.findIndex=function(a,b,c){for(var d=a.length,e=goog.isString(a)?a.split(""):a,f=0;f<d;f++)if(f in e&&b.call(c,e[f],f,a))return f;return-1};goog.array.findRight=function(a,b,c){b=goog.array.findIndexRight(a,b,c);return 0>b?null:goog.isString(a)?a.charAt(b):a[b]};
goog.array.findIndexRight=function(a,b,c){for(var d=a.length,e=goog.isString(a)?a.split(""):a,d=d-1;0<=d;d--)if(d in e&&b.call(c,e[d],d,a))return d;return-1};goog.array.contains=function(a,b){return 0<=goog.array.indexOf(a,b)};goog.array.isEmpty=function(a){return 0==a.length};goog.array.clear=function(a){if(!goog.isArray(a))for(var b=a.length-1;0<=b;b--)delete a[b];a.length=0};goog.array.insert=function(a,b){goog.array.contains(a,b)||a.push(b)};
goog.array.insertAt=function(a,b,c){goog.array.splice(a,c,0,b)};goog.array.insertArrayAt=function(a,b,c){goog.partial(goog.array.splice,a,c,0).apply(null,b)};goog.array.insertBefore=function(a,b,c){var d;2==arguments.length||0>(d=goog.array.indexOf(a,c))?a.push(b):goog.array.insertAt(a,b,d)};goog.array.remove=function(a,b){var c=goog.array.indexOf(a,b),d;(d=0<=c)&&goog.array.removeAt(a,c);return d};
goog.array.removeAt=function(a,b){goog.asserts.assert(null!=a.length);return 1==goog.array.ARRAY_PROTOTYPE_.splice.call(a,b,1).length};goog.array.removeIf=function(a,b,c){b=goog.array.findIndex(a,b,c);return 0<=b?(goog.array.removeAt(a,b),!0):!1};goog.array.concat=function(a){return goog.array.ARRAY_PROTOTYPE_.concat.apply(goog.array.ARRAY_PROTOTYPE_,arguments)};goog.array.toArray=function(a){var b=a.length;if(0<b){for(var c=Array(b),d=0;d<b;d++)c[d]=a[d];return c}return[]};goog.array.clone=goog.array.toArray;
goog.array.extend=function(a,b){for(var c=1;c<arguments.length;c++){var d=arguments[c],e;if(goog.isArray(d)||(e=goog.isArrayLike(d))&&Object.prototype.hasOwnProperty.call(d,"callee"))a.push.apply(a,d);else if(e)for(var f=a.length,g=d.length,h=0;h<g;h++)a[f+h]=d[h];else a.push(d)}};goog.array.splice=function(a,b,c,d){goog.asserts.assert(null!=a.length);return goog.array.ARRAY_PROTOTYPE_.splice.apply(a,goog.array.slice(arguments,1))};
goog.array.slice=function(a,b,c){goog.asserts.assert(null!=a.length);return 2>=arguments.length?goog.array.ARRAY_PROTOTYPE_.slice.call(a,b):goog.array.ARRAY_PROTOTYPE_.slice.call(a,b,c)};goog.array.removeDuplicates=function(a,b){for(var c=b||a,d={},e=0,f=0;f<a.length;){var g=a[f++],h=goog.isObject(g)?"o"+goog.getUid(g):(typeof g).charAt(0)+g;Object.prototype.hasOwnProperty.call(d,h)||(d[h]=!0,c[e++]=g)}c.length=e};
goog.array.binarySearch=function(a,b,c){return goog.array.binarySearch_(a,c||goog.array.defaultCompare,!1,b)};goog.array.binarySelect=function(a,b,c){return goog.array.binarySearch_(a,b,!0,void 0,c)};goog.array.binarySearch_=function(a,b,c,d,e){for(var f=0,g=a.length,h;f<g;){var k=f+g>>1,j;j=c?b.call(e,a[k],k,a):b(d,a[k]);0<j?f=k+1:(g=k,h=!j)}return h?f:~f};goog.array.sort=function(a,b){goog.asserts.assert(null!=a.length);goog.array.ARRAY_PROTOTYPE_.sort.call(a,b||goog.array.defaultCompare)};
goog.array.stableSort=function(a,b){for(var c=0;c<a.length;c++)a[c]={index:c,value:a[c]};var d=b||goog.array.defaultCompare;goog.array.sort(a,function(a,b){return d(a.value,b.value)||a.index-b.index});for(c=0;c<a.length;c++)a[c]=a[c].value};goog.array.sortObjectsByKey=function(a,b,c){var d=c||goog.array.defaultCompare;goog.array.sort(a,function(a,c){return d(a[b],c[b])})};
goog.array.isSorted=function(a,b,c){b=b||goog.array.defaultCompare;for(var d=1;d<a.length;d++){var e=b(a[d-1],a[d]);if(0<e||0==e&&c)return!1}return!0};goog.array.equals=function(a,b,c){if(!goog.isArrayLike(a)||!goog.isArrayLike(b)||a.length!=b.length)return!1;var d=a.length;c=c||goog.array.defaultCompareEquality;for(var e=0;e<d;e++)if(!c(a[e],b[e]))return!1;return!0};goog.array.compare=function(a,b,c){return goog.array.equals(a,b,c)};
goog.array.compare3=function(a,b,c){c=c||goog.array.defaultCompare;for(var d=Math.min(a.length,b.length),e=0;e<d;e++){var f=c(a[e],b[e]);if(0!=f)return f}return goog.array.defaultCompare(a.length,b.length)};goog.array.defaultCompare=function(a,b){return a>b?1:a<b?-1:0};goog.array.defaultCompareEquality=function(a,b){return a===b};goog.array.binaryInsert=function(a,b,c){c=goog.array.binarySearch(a,b,c);return 0>c?(goog.array.insertAt(a,b,-(c+1)),!0):!1};
goog.array.binaryRemove=function(a,b,c){b=goog.array.binarySearch(a,b,c);return 0<=b?goog.array.removeAt(a,b):!1};goog.array.bucket=function(a,b){for(var c={},d=0;d<a.length;d++){var e=a[d],f=b(e,d,a);goog.isDef(f)&&(c[f]||(c[f]=[])).push(e)}return c};goog.array.toObject=function(a,b,c){var d={};goog.array.forEach(a,function(e,f){d[b.call(c,e,f,a)]=e});return d};
goog.array.range=function(a,b,c){var d=[],e=0,f=a;c=c||1;void 0!==b&&(e=a,f=b);if(0>c*(f-e))return[];if(0<c)for(a=e;a<f;a+=c)d.push(a);else for(a=e;a>f;a+=c)d.push(a);return d};goog.array.repeat=function(a,b){for(var c=[],d=0;d<b;d++)c[d]=a;return c};goog.array.flatten=function(a){for(var b=[],c=0;c<arguments.length;c++){var d=arguments[c];goog.isArray(d)?b.push.apply(b,goog.array.flatten.apply(null,d)):b.push(d)}return b};
goog.array.rotate=function(a,b){goog.asserts.assert(null!=a.length);a.length&&(b%=a.length,0<b?goog.array.ARRAY_PROTOTYPE_.unshift.apply(a,a.splice(-b,b)):0>b&&goog.array.ARRAY_PROTOTYPE_.push.apply(a,a.splice(0,-b)));return a};goog.array.zip=function(a){if(!arguments.length)return[];for(var b=[],c=0;;c++){for(var d=[],e=0;e<arguments.length;e++){var f=arguments[e];if(c>=f.length)return b;d.push(f[c])}b.push(d)}};
goog.array.shuffle=function(a,b){for(var c=b||Math.random,d=a.length-1;0<d;d--){var e=Math.floor(c()*(d+1)),f=a[d];a[d]=a[e];a[e]=f}};goog.debug.entryPointRegistry={};goog.debug.EntryPointMonitor=function(){};goog.debug.entryPointRegistry.refList_=[];goog.debug.entryPointRegistry.monitors_=[];goog.debug.entryPointRegistry.monitorsMayExist_=!1;goog.debug.entryPointRegistry.register=function(a){goog.debug.entryPointRegistry.refList_[goog.debug.entryPointRegistry.refList_.length]=a;if(goog.debug.entryPointRegistry.monitorsMayExist_)for(var b=goog.debug.entryPointRegistry.monitors_,c=0;c<b.length;c++)a(goog.bind(b[c].wrap,b[c]))};
goog.debug.entryPointRegistry.monitorAll=function(a){goog.debug.entryPointRegistry.monitorsMayExist_=!0;for(var b=goog.bind(a.wrap,a),c=0;c<goog.debug.entryPointRegistry.refList_.length;c++)goog.debug.entryPointRegistry.refList_[c](b);goog.debug.entryPointRegistry.monitors_.push(a)};
goog.debug.entryPointRegistry.unmonitorAllIfPossible=function(a){var b=goog.debug.entryPointRegistry.monitors_;goog.asserts.assert(a==b[b.length-1],"Only the most recent monitor can be unwrapped.");a=goog.bind(a.unwrap,a);for(var c=0;c<goog.debug.entryPointRegistry.refList_.length;c++)goog.debug.entryPointRegistry.refList_[c](a);b.length--};goog.events.EventType={CLICK:"click",DBLCLICK:"dblclick",MOUSEDOWN:"mousedown",MOUSEUP:"mouseup",MOUSEOVER:"mouseover",MOUSEOUT:"mouseout",MOUSEMOVE:"mousemove",SELECTSTART:"selectstart",KEYPRESS:"keypress",KEYDOWN:"keydown",KEYUP:"keyup",BLUR:"blur",FOCUS:"focus",DEACTIVATE:"deactivate",FOCUSIN:goog.userAgent.IE?"focusin":"DOMFocusIn",FOCUSOUT:goog.userAgent.IE?"focusout":"DOMFocusOut",CHANGE:"change",SELECT:"select",SUBMIT:"submit",INPUT:"input",PROPERTYCHANGE:"propertychange",DRAGSTART:"dragstart",
DRAG:"drag",DRAGENTER:"dragenter",DRAGOVER:"dragover",DRAGLEAVE:"dragleave",DROP:"drop",DRAGEND:"dragend",TOUCHSTART:"touchstart",TOUCHMOVE:"touchmove",TOUCHEND:"touchend",TOUCHCANCEL:"touchcancel",BEFOREUNLOAD:"beforeunload",CONTEXTMENU:"contextmenu",ERROR:"error",HELP:"help",LOAD:"load",LOSECAPTURE:"losecapture",READYSTATECHANGE:"readystatechange",RESIZE:"resize",SCROLL:"scroll",UNLOAD:"unload",HASHCHANGE:"hashchange",PAGEHIDE:"pagehide",PAGESHOW:"pageshow",POPSTATE:"popstate",COPY:"copy",PASTE:"paste",
CUT:"cut",BEFORECOPY:"beforecopy",BEFORECUT:"beforecut",BEFOREPASTE:"beforepaste",ONLINE:"online",OFFLINE:"offline",MESSAGE:"message",CONNECT:"connect",TRANSITIONEND:goog.userAgent.WEBKIT?"webkitTransitionEnd":goog.userAgent.OPERA?"oTransitionEnd":"transitionend",MSGESTURECHANGE:"MSGestureChange",MSGESTUREEND:"MSGestureEnd",MSGESTUREHOLD:"MSGestureHold",MSGESTURESTART:"MSGestureStart",MSGESTURETAP:"MSGestureTap",MSGOTPOINTERCAPTURE:"MSGotPointerCapture",MSINERTIASTART:"MSInertiaStart",MSLOSTPOINTERCAPTURE:"MSLostPointerCapture",
MSPOINTERCANCEL:"MSPointerCancel",MSPOINTERDOWN:"MSPointerDown",MSPOINTERMOVE:"MSPointerMove",MSPOINTEROVER:"MSPointerOver",MSPOINTEROUT:"MSPointerOut",MSPOINTERUP:"MSPointerUp",TEXTINPUT:"textinput",COMPOSITIONSTART:"compositionstart",COMPOSITIONUPDATE:"compositionupdate",COMPOSITIONEND:"compositionend"};goog.disposable={};goog.disposable.IDisposable=function(){};goog.Disposable=function(){goog.Disposable.MONITORING_MODE!=goog.Disposable.MonitoringMode.OFF&&(this.creationStack=Error().stack,goog.Disposable.instances_[goog.getUid(this)]=this)};goog.Disposable.MonitoringMode={OFF:0,PERMANENT:1,INTERACTIVE:2};goog.Disposable.MONITORING_MODE=0;goog.Disposable.instances_={};goog.Disposable.getUndisposedObjects=function(){var a=[],b;for(b in goog.Disposable.instances_)goog.Disposable.instances_.hasOwnProperty(b)&&a.push(goog.Disposable.instances_[Number(b)]);return a};
goog.Disposable.clearUndisposedObjects=function(){goog.Disposable.instances_={}};goog.Disposable.prototype.disposed_=!1;goog.Disposable.prototype.isDisposed=function(){return this.disposed_};goog.Disposable.prototype.getDisposed=goog.Disposable.prototype.isDisposed;
goog.Disposable.prototype.dispose=function(){if(!this.disposed_&&(this.disposed_=!0,this.disposeInternal(),goog.Disposable.MONITORING_MODE!=goog.Disposable.MonitoringMode.OFF)){var a=goog.getUid(this);if(goog.Disposable.MONITORING_MODE==goog.Disposable.MonitoringMode.PERMANENT&&!goog.Disposable.instances_.hasOwnProperty(a))throw Error(this+" did not call the goog.Disposable base constructor or was disposed of after a clearUndisposedObjects call");delete goog.Disposable.instances_[a]}};
goog.Disposable.prototype.registerDisposable=function(a){this.addOnDisposeCallback(goog.partial(goog.dispose,a))};goog.Disposable.prototype.addOnDisposeCallback=function(a,b){this.onDisposeCallbacks_||(this.onDisposeCallbacks_=[]);this.onDisposeCallbacks_.push(goog.bind(a,b))};goog.Disposable.prototype.disposeInternal=function(){if(this.onDisposeCallbacks_)for(;this.onDisposeCallbacks_.length;)this.onDisposeCallbacks_.shift()()};
goog.Disposable.isDisposed=function(a){return a&&"function"==typeof a.isDisposed?a.isDisposed():!1};goog.dispose=function(a){a&&"function"==typeof a.dispose&&a.dispose()};goog.disposeAll=function(a){for(var b=0,c=arguments.length;b<c;++b){var d=arguments[b];goog.isArrayLike(d)?goog.disposeAll.apply(null,d):goog.dispose(d)}};goog.events.Event=function(a,b){this.type=a;this.currentTarget=this.target=b};goog.events.Event.prototype.disposeInternal=function(){};goog.events.Event.prototype.dispose=function(){};goog.events.Event.prototype.propagationStopped_=!1;goog.events.Event.prototype.defaultPrevented=!1;goog.events.Event.prototype.returnValue_=!0;goog.events.Event.prototype.stopPropagation=function(){this.propagationStopped_=!0};
goog.events.Event.prototype.preventDefault=function(){this.defaultPrevented=!0;this.returnValue_=!1};goog.events.Event.stopPropagation=function(a){a.stopPropagation()};goog.events.Event.preventDefault=function(a){a.preventDefault()};goog.reflect={};goog.reflect.object=function(a,b){return b};goog.reflect.sinkValue=function(a){goog.reflect.sinkValue[" "](a);return a};goog.reflect.sinkValue[" "]=goog.nullFunction;goog.reflect.canAccessProperty=function(a,b){try{return goog.reflect.sinkValue(a[b]),!0}catch(c){}return!1};goog.events.BrowserEvent=function(a,b){a&&this.init(a,b)};goog.inherits(goog.events.BrowserEvent,goog.events.Event);goog.events.BrowserEvent.MouseButton={LEFT:0,MIDDLE:1,RIGHT:2};goog.events.BrowserEvent.IEButtonMap=[1,4,2];goog.events.BrowserEvent.prototype.target=null;goog.events.BrowserEvent.prototype.relatedTarget=null;goog.events.BrowserEvent.prototype.offsetX=0;goog.events.BrowserEvent.prototype.offsetY=0;goog.events.BrowserEvent.prototype.clientX=0;
goog.events.BrowserEvent.prototype.clientY=0;goog.events.BrowserEvent.prototype.screenX=0;goog.events.BrowserEvent.prototype.screenY=0;goog.events.BrowserEvent.prototype.button=0;goog.events.BrowserEvent.prototype.keyCode=0;goog.events.BrowserEvent.prototype.charCode=0;goog.events.BrowserEvent.prototype.ctrlKey=!1;goog.events.BrowserEvent.prototype.altKey=!1;goog.events.BrowserEvent.prototype.shiftKey=!1;goog.events.BrowserEvent.prototype.metaKey=!1;
goog.events.BrowserEvent.prototype.platformModifierKey=!1;goog.events.BrowserEvent.prototype.event_=null;
goog.events.BrowserEvent.prototype.init=function(a,b){var c=this.type=a.type;goog.events.Event.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var d=a.relatedTarget;d?goog.userAgent.GECKO&&(goog.reflect.canAccessProperty(d,"nodeName")||(d=null)):c==goog.events.EventType.MOUSEOVER?d=a.fromElement:c==goog.events.EventType.MOUSEOUT&&(d=a.toElement);this.relatedTarget=d;this.offsetX=goog.userAgent.WEBKIT||void 0!==a.offsetX?a.offsetX:a.layerX;this.offsetY=goog.userAgent.WEBKIT||void 0!==
a.offsetY?a.offsetY:a.layerY;this.clientX=void 0!==a.clientX?a.clientX:a.pageX;this.clientY=void 0!==a.clientY?a.clientY:a.pageY;this.screenX=a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.platformModifierKey=goog.userAgent.MAC?a.metaKey:a.ctrlKey;this.state=a.state;this.event_=a;a.defaultPrevented&&this.preventDefault();
delete this.propagationStopped_};goog.events.BrowserEvent.prototype.isButton=function(a){return goog.events.BrowserFeature.HAS_W3C_BUTTON?this.event_.button==a:"click"==this.type?a==goog.events.BrowserEvent.MouseButton.LEFT:!!(this.event_.button&goog.events.BrowserEvent.IEButtonMap[a])};goog.events.BrowserEvent.prototype.isMouseActionButton=function(){return this.isButton(goog.events.BrowserEvent.MouseButton.LEFT)&&!(goog.userAgent.WEBKIT&&goog.userAgent.MAC&&this.ctrlKey)};
goog.events.BrowserEvent.prototype.stopPropagation=function(){goog.events.BrowserEvent.superClass_.stopPropagation.call(this);this.event_.stopPropagation?this.event_.stopPropagation():this.event_.cancelBubble=!0};
goog.events.BrowserEvent.prototype.preventDefault=function(){goog.events.BrowserEvent.superClass_.preventDefault.call(this);var a=this.event_;if(a.preventDefault)a.preventDefault();else if(a.returnValue=!1,goog.events.BrowserFeature.SET_KEY_CODE_TO_PREVENT_DEFAULT)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};goog.events.BrowserEvent.prototype.getBrowserEvent=function(){return this.event_};goog.events.BrowserEvent.prototype.disposeInternal=function(){};goog.events.STRICT_EVENT_TARGET=!0;goog.events.listeners_={};goog.events.listenerTree_={};goog.events.sources_={};goog.events.onString_="on";goog.events.onStringMap_={};goog.events.keySeparator_="_";
goog.events.listen=function(a,b,c,d,e){if(goog.isArray(b)){for(var f=0;f<b.length;f++)goog.events.listen(a,b[f],c,d,e);return null}a=goog.events.Listenable.USE_LISTENABLE_INTERFACE&&goog.events.Listenable.isImplementedBy(a)?a.listen(b,goog.events.wrapListener_(c),d,e):goog.events.listen_(a,b,c,!1,d,e);b=a.key;goog.events.listeners_[b]=a;return b};goog.events.CUSTOM_EVENT_ATTR="customEvent_";
goog.events.listen_=function(a,b,c,d,e,f){if(!b)throw Error("Invalid event type");e=!!e;var g=goog.events.listenerTree_;b in g||(g[b]={count_:0,remaining_:0});g=g[b];e in g||(g[e]={count_:0,remaining_:0},g.count_++);var g=g[e],h=goog.getUid(a),k;g.remaining_++;if(g[h]){k=g[h];for(var j=0;j<k.length;j++)if(g=k[j],g.listener==c&&g.handler==f){if(g.removed)break;d||(k[j].callOnce=!1);return k[j]}}else k=g[h]=[],g.count_++;j=goog.events.getProxy();g=new goog.events.Listener;g.init(c,j,a,b,e,f);g.callOnce=
d;j.src=a;j.listener=g;k.push(g);goog.events.sources_[h]||(goog.events.sources_[h]=[]);goog.events.sources_[h].push(g);a.addEventListener?a==goog.global||!a[goog.events.CUSTOM_EVENT_ATTR]?a.addEventListener(b,j,e):goog.events.STRICT_EVENT_TARGET&&a.assertInitialized():a.attachEvent(goog.events.getOnString_(b),j);return g};
goog.events.getProxy=function(){var a=goog.events.handleBrowserEvent_,b=goog.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT?function(c){return a.call(b.src,b.listener,c)}:function(c){c=a.call(b.src,b.listener,c);if(!c)return c};return b};
goog.events.listenOnce=function(a,b,c,d,e){if(goog.isArray(b)){for(var f=0;f<b.length;f++)goog.events.listenOnce(a,b[f],c,d,e);return null}a=goog.events.Listenable.USE_LISTENABLE_INTERFACE&&goog.events.Listenable.isImplementedBy(a)?a.listenOnce(b,goog.events.wrapListener_(c),d,e):goog.events.listen_(a,b,c,!0,d,e);b=a.key;goog.events.listeners_[b]=a;return b};goog.events.listenWithWrapper=function(a,b,c,d,e){b.listen(a,c,d,e)};
goog.events.unlisten=function(a,b,c,d,e){if(goog.isArray(b)){for(var f=0;f<b.length;f++)goog.events.unlisten(a,b[f],c,d,e);return null}if(goog.events.Listenable.USE_LISTENABLE_INTERFACE&&goog.events.Listenable.isImplementedBy(a))return a.unlisten(b,goog.events.wrapListener_(c),d,e);d=!!d;a=goog.events.getListeners_(a,b,d);if(!a)return!1;for(f=0;f<a.length;f++)if(a[f].listener==c&&a[f].capture==d&&a[f].handler==e)return goog.events.unlistenByKey(a[f].key);return!1};
goog.events.unlistenByKey=function(a){var b=goog.events.listeners_[a];if(!b||b.removed)return!1;var c=b.src;if(goog.events.Listenable.USE_LISTENABLE_INTERFACE&&goog.events.Listenable.isImplementedBy(c))return c.unlistenByKey(b);var d=b.type,e=b.proxy,f=b.capture;c.removeEventListener?(c==goog.global||!c[goog.events.CUSTOM_EVENT_ATTR])&&c.removeEventListener(d,e,f):c.detachEvent&&c.detachEvent(goog.events.getOnString_(d),e);c=goog.getUid(c);goog.events.sources_[c]&&(e=goog.events.sources_[c],goog.array.remove(e,
b),0==e.length&&delete goog.events.sources_[c]);b.removed=!0;if(b=goog.events.listenerTree_[d][f][c])b.needsCleanup_=!0,goog.events.cleanUp_(d,f,c,b);delete goog.events.listeners_[a];return!0};goog.events.unlistenWithWrapper=function(a,b,c,d,e){b.unlisten(a,c,d,e)};goog.events.cleanUp=function(a){delete goog.events.listeners_[a.key]};
goog.events.cleanUp_=function(a,b,c,d){if(!d.locked_&&d.needsCleanup_){for(var e=0,f=0;e<d.length;e++)d[e].removed?d[e].proxy.src=null:(e!=f&&(d[f]=d[e]),f++);d.length=f;d.needsCleanup_=!1;0==f&&(delete goog.events.listenerTree_[a][b][c],goog.events.listenerTree_[a][b].count_--,0==goog.events.listenerTree_[a][b].count_&&(delete goog.events.listenerTree_[a][b],goog.events.listenerTree_[a].count_--),0==goog.events.listenerTree_[a].count_&&delete goog.events.listenerTree_[a])}};
goog.events.removeAll=function(a,b){var c=0,d=null==b;if(null!=a){if(goog.events.Listenable.USE_LISTENABLE_INTERFACE&&a&&goog.events.Listenable.isImplementedBy(a))return a.removeAllListeners(b);var e=goog.getUid(a);if(goog.events.sources_[e])for(var e=goog.events.sources_[e],f=e.length-1;0<=f;f--){var g=e[f];if(d||b==g.type)goog.events.unlistenByKey(g.key),c++}}else goog.object.forEach(goog.events.listeners_,function(a,b){goog.events.unlistenByKey(b);c++});return c};
goog.events.removeAllNativeListeners=function(){var a=0;goog.object.forEach(goog.events.listeners_,function(b,c){var d=b.src;!goog.events.Listenable.isImplementedBy(d)&&!d[goog.events.CUSTOM_EVENT_ATTR]&&(goog.events.unlistenByKey(c),a++)});return a};goog.events.getListeners=function(a,b,c){return goog.events.Listenable.USE_LISTENABLE_INTERFACE&&goog.events.Listenable.isImplementedBy(a)?a.getListeners(b,c):goog.events.getListeners_(a,b,c)||[]};
goog.events.getListeners_=function(a,b,c){var d=goog.events.listenerTree_;return b in d&&(d=d[b],c in d&&(d=d[c],a=goog.getUid(a),d[a]))?d[a]:null};goog.events.getListener=function(a,b,c,d,e){d=!!d;if(goog.events.Listenable.USE_LISTENABLE_INTERFACE&&goog.events.Listenable.isImplementedBy(a))return a.getListener(b,goog.events.wrapListener_(c),d,e);if(a=goog.events.getListeners_(a,b,d))for(b=0;b<a.length;b++)if(!a[b].removed&&a[b].listener==c&&a[b].capture==d&&a[b].handler==e)return a[b];return null};
goog.events.hasListener=function(a,b,c){if(goog.events.Listenable.USE_LISTENABLE_INTERFACE&&goog.events.Listenable.isImplementedBy(a))return a.hasListener(b,c);a=goog.getUid(a);var d=goog.events.sources_[a];if(d){var e=goog.isDef(b),f=goog.isDef(c);return e&&f?(d=goog.events.listenerTree_[b],!!d&&!!d[c]&&a in d[c]):!e&&!f?!0:goog.array.some(d,function(a){return e&&a.type==b||f&&a.capture==c})}return!1};
goog.events.expose=function(a){var b=[],c;for(c in a)a[c]&&a[c].id?b.push(c+" = "+a[c]+" ("+a[c].id+")"):b.push(c+" = "+a[c]);return b.join("\n")};goog.events.getOnString_=function(a){return a in goog.events.onStringMap_?goog.events.onStringMap_[a]:goog.events.onStringMap_[a]=goog.events.onString_+a};
goog.events.fireListeners=function(a,b,c,d){if(goog.events.Listenable.USE_LISTENABLE_INTERFACE&&goog.events.Listenable.isImplementedBy(a))return a.fireListeners(b,c,d);var e=goog.events.listenerTree_;return b in e&&(e=e[b],c in e)?goog.events.fireListeners_(e[c],a,b,c,d):!0};
goog.events.fireListeners_=function(a,b,c,d,e){var f=1;b=goog.getUid(b);if(a[b]){var g=--a.remaining_,h=a[b];h.locked_?h.locked_++:h.locked_=1;try{for(var k=h.length,j=0;j<k;j++){var m=h[j];m&&!m.removed&&(f&=!1!==goog.events.fireListener(m,e))}}finally{a.remaining_=Math.max(g,a.remaining_),h.locked_--,goog.events.cleanUp_(c,d,b,h)}}return Boolean(f)};goog.events.fireListener=function(a,b){a.callOnce&&goog.events.unlistenByKey(a.key);return a.handleEvent(b)};goog.events.getTotalListenerCount=function(){return goog.object.getCount(goog.events.listeners_)};
goog.events.dispatchEvent=function(a,b){if(goog.events.Listenable.USE_LISTENABLE_INTERFACE)return goog.events.STRICT_EVENT_TARGET&&goog.asserts.assert(goog.events.Listenable.isImplementedBy(a),"Can not use goog.events.dispatchEvent with non-goog.events.Listenable instance."),a.dispatchEvent(b);goog.events.STRICT_EVENT_TARGET&&(goog.asserts.assert(goog.events.STRICT_EVENT_TARGET&&a[goog.events.CUSTOM_EVENT_ATTR],"Can not use goog.events.dispatchEvent with non-goog.events.EventTarget instance."),a.assertInitialized());
var c=b.type||b,d=goog.events.listenerTree_;if(!(c in d))return!0;if(goog.isString(b))b=new goog.events.Event(b,a);else if(b instanceof goog.events.Event)b.target=b.target||a;else{var e=b;b=new goog.events.Event(c,a);goog.object.extend(b,e)}var e=1,f,d=d[c],c=!0 in d,g;if(c){f=[];for(g=a;g;g=g.getParentEventTarget())f.push(g);g=d[!0];g.remaining_=g.count_;for(var h=f.length-1;!b.propagationStopped_&&0<=h&&g.remaining_;h--)b.currentTarget=f[h],e&=goog.events.fireListeners_(g,f[h],b.type,!0,b)&&!1!=
b.returnValue_}if(!1 in d)if(g=d[!1],g.remaining_=g.count_,c)for(h=0;!b.propagationStopped_&&h<f.length&&g.remaining_;h++)b.currentTarget=f[h],e&=goog.events.fireListeners_(g,f[h],b.type,!1,b)&&!1!=b.returnValue_;else for(d=a;!b.propagationStopped_&&d&&g.remaining_;d=d.getParentEventTarget())b.currentTarget=d,e&=goog.events.fireListeners_(g,d,b.type,!1,b)&&!1!=b.returnValue_;return Boolean(e)};goog.events.protectBrowserEventEntryPoint=function(a){goog.events.handleBrowserEvent_=a.protectEntryPoint(goog.events.handleBrowserEvent_)};
goog.events.handleBrowserEvent_=function(a,b){if(a.removed)return!0;var c=a.type,d=goog.events.listenerTree_;if(!(c in d))return!0;var d=d[c],e,f;if(!goog.events.BrowserFeature.HAS_W3C_EVENT_SUPPORT){e=b||goog.getObjectByName("window.event");var g=!0 in d,h=!1 in d;if(g){if(goog.events.isMarkedIeEvent_(e))return!0;goog.events.markIeEvent_(e)}var k=new goog.events.BrowserEvent;k.init(e,this);e=!0;try{if(g){for(var j=[],m=k.currentTarget;m;m=m.parentNode)j.push(m);f=d[!0];f.remaining_=f.count_;for(var l=
j.length-1;!k.propagationStopped_&&0<=l&&f.remaining_;l--)k.currentTarget=j[l],e&=goog.events.fireListeners_(f,j[l],c,!0,k);if(h){f=d[!1];f.remaining_=f.count_;for(l=0;!k.propagationStopped_&&l<j.length&&f.remaining_;l++)k.currentTarget=j[l],e&=goog.events.fireListeners_(f,j[l],c,!1,k)}}else e=goog.events.fireListener(a,k)}finally{j&&(j.length=0)}return e}c=new goog.events.BrowserEvent(b,this);return e=goog.events.fireListener(a,c)};
goog.events.markIeEvent_=function(a){var b=!1;if(0==a.keyCode)try{a.keyCode=-1;return}catch(c){b=!0}if(b||void 0==a.returnValue)a.returnValue=!0};goog.events.isMarkedIeEvent_=function(a){return 0>a.keyCode||void 0!=a.returnValue};goog.events.uniqueIdCounter_=0;goog.events.getUniqueId=function(a){return a+"_"+goog.events.uniqueIdCounter_++};goog.events.LISTENER_WRAPPER_PROP_="__closure_events_fn_"+(1E9*Math.random()>>>0);
goog.events.wrapListener_=function(a){return goog.isFunction(a)?a:a[goog.events.LISTENER_WRAPPER_PROP_]||(a[goog.events.LISTENER_WRAPPER_PROP_]=function(b){return a.handleEvent(b)})};goog.debug.entryPointRegistry.register(function(a){goog.events.handleBrowserEvent_=a(goog.events.handleBrowserEvent_)});goog.events.EventTarget=function(){goog.Disposable.call(this);this.eventTargetListeners_={};this.actualEventTarget_=this};goog.inherits(goog.events.EventTarget,goog.Disposable);goog.events.Listenable.USE_LISTENABLE_INTERFACE&&goog.events.Listenable.addImplementation(goog.events.EventTarget);goog.events.EventTarget.MAX_ANCESTORS_=1E3;goog.events.EventTarget.prototype[goog.events.CUSTOM_EVENT_ATTR]=!0;goog.events.EventTarget.prototype.parentEventTarget_=null;
goog.events.EventTarget.prototype.getParentEventTarget=function(){return this.parentEventTarget_};goog.events.EventTarget.prototype.setParentEventTarget=function(a){this.parentEventTarget_=a};goog.events.EventTarget.prototype.addEventListener=function(a,b,c,d){goog.events.listen(this,a,b,c,d)};goog.events.EventTarget.prototype.removeEventListener=function(a,b,c,d){goog.events.unlisten(this,a,b,c,d)};
goog.events.EventTarget.prototype.dispatchEvent=function(a){if(goog.events.Listenable.USE_LISTENABLE_INTERFACE){this.assertInitialized();var b,c=this.getParentEventTarget();if(c){b=[];for(var d=1;c;c=c.getParentEventTarget())b.push(c),goog.asserts.assert(++d<goog.events.EventTarget.MAX_ANCESTORS_,"infinite loop")}return goog.events.EventTarget.dispatchEventInternal_(this.actualEventTarget_,a,b)}return goog.events.dispatchEvent(this,a)};
goog.events.EventTarget.prototype.disposeInternal=function(){goog.events.EventTarget.superClass_.disposeInternal.call(this);goog.events.Listenable.USE_LISTENABLE_INTERFACE?this.removeAllListeners():goog.events.removeAll(this);this.parentEventTarget_=null};goog.events.EventTarget.prototype.assertInitialized=function(){goog.events.STRICT_EVENT_TARGET&&goog.asserts.assert(this.eventTargetListeners_,"Event target is not initialized. Did you call superclass (goog.events.EventTarget) constructor?")};
goog.events.Listenable.USE_LISTENABLE_INTERFACE&&(goog.events.EventTarget.prototype.listen=function(a,b,c,d){return this.listenInternal_(a,b,!1,c,d)},goog.events.EventTarget.prototype.listenOnce=function(a,b,c,d){return this.listenInternal_(a,b,!0,c,d)},goog.events.EventTarget.prototype.listenInternal_=function(a,b,c,d,e){this.assertInitialized();var f=this.eventTargetListeners_[a]||(this.eventTargetListeners_[a]=[]),g;g=goog.events.EventTarget.findListenerIndex_(f,b,d,e);if(-1<g)return g=f[g],c||
(g.callOnce=!1),g;g=new goog.events.Listener;g.init(b,null,this,a,!!d,e);g.callOnce=c;f.push(g);return g},goog.events.EventTarget.prototype.unlisten=function(a,b,c,d){if(!(a in this.eventTargetListeners_))return!1;a=this.eventTargetListeners_[a];b=goog.events.EventTarget.findListenerIndex_(a,b,c,d);return-1<b?(c=a[b],goog.events.cleanUp(c),c.removed=!0,goog.array.removeAt(a,b)):!1},goog.events.EventTarget.prototype.unlistenByKey=function(a){var b=a.type;if(!(b in this.eventTargetListeners_))return!1;
if(b=goog.array.remove(this.eventTargetListeners_[b],a))goog.events.cleanUp(a),a.removed=!0;return b},goog.events.EventTarget.prototype.removeAllListeners=function(a){var b=0,c;for(c in this.eventTargetListeners_)if(!a||c==a){for(var d=this.eventTargetListeners_[c],e=0;e<d.length;e++)++b,goog.events.cleanUp(d[e]),d[e].removed=!0;d.length=0}return b},goog.events.EventTarget.prototype.fireListeners=function(a,b,c){if(!(a in this.eventTargetListeners_))return!0;var d=!0;a=goog.array.clone(this.eventTargetListeners_[a]);
for(var e=0;e<a.length;++e){var f=a[e];f&&(!f.removed&&f.capture==b)&&(f.callOnce&&this.unlistenByKey(f),d=!1!==f.handleEvent(c)&&d)}return d&&!1!=c.returnValue_},goog.events.EventTarget.prototype.getListeners=function(a,b){var c=this.eventTargetListeners_[a],d=[];if(c)for(var e=0;e<c.length;++e){var f=c[e];f.capture==b&&d.push(f)}return d},goog.events.EventTarget.prototype.getListener=function(a,b,c,d){a=this.eventTargetListeners_[a];var e=-1;a&&(e=goog.events.EventTarget.findListenerIndex_(a,b,
c,d));return-1<e?a[e]:null},goog.events.EventTarget.prototype.hasListener=function(a,b){var c=goog.isDef(a),d=goog.isDef(b);return goog.object.some(this.eventTargetListeners_,function(e){for(var f=0;f<e.length;++f)if((!c||e[f].type==a)&&(!d||e[f].capture==b))return!0;return!1})},goog.events.EventTarget.prototype.setTargetForTesting=function(a){this.actualEventTarget_=a},goog.events.EventTarget.dispatchEventInternal_=function(a,b,c){var d=b.type||b;if(goog.isString(b))b=new goog.events.Event(b,a);
else if(b instanceof goog.events.Event)b.target=b.target||a;else{var e=b;b=new goog.events.Event(d,a);goog.object.extend(b,e)}var e=!0,f;if(c)for(var g=c.length-1;!b.propagationStopped_&&0<=g;g--)f=b.currentTarget=c[g],e=f.fireListeners(d,!0,b)&&e;b.propagationStopped_||(f=b.currentTarget=a,e=f.fireListeners(d,!0,b)&&e,b.propagationStopped_||(e=f.fireListeners(d,!1,b)&&e));if(c)for(g=0;!b.propagationStopped_&&g<c.length;g++)f=b.currentTarget=c[g],e=f.fireListeners(d,!1,b)&&e;return e},goog.events.EventTarget.findListenerIndex_=
function(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(f.listener==b&&f.capture==!!c&&f.handler==d)return e}return-1});X.base=function(){goog.events.EventTarget.call(this);this._classname="base";this._id=window["X.counter"].uniqueId();this._dirty=!1};goog.inherits(X.base,goog.events.EventTarget);X.base.prototype.__defineGetter__("classname",function(){return this._classname});X.base.prototype.__defineGetter__("id",function(){return this._id});goog.exportSymbol("X.base",X.base);var csgVertex=function(a,b){this.pos_=new csgVector(a);this.normal_=new csgVector(b)};csgVertex.prototype={clone:function(){return new csgVertex(this.pos_.clone(),this.normal_.clone())},flip:function(){this.normal_=this.normal_.negated()},interpolate:function(a,b){return new csgVertex(this.pos_.lerp(a.pos(),b),this.normal_.lerp(a.normal(),b))},pos:function(){return this.pos_},normal:function(){return this.normal_}};var csgPlane=function(a,b){this.normal_=a;this.w_=b};csgPlane.EPSILON=1E-5;csgPlane.fromPoints=function(a,b,c){b=b.minus(a).cross(c.minus(a)).unit();return new csgPlane(b,b.dot(a))};csgPlane.prototype={clone:function(){return new csgPlane(this.normal_.clone(),this.w_)},flip:function(){this.normal_=this.normal_.negated();this.w_=-this.w_},w:function(){return this.w_},normal:function(){return this.normal_}};var csgPolygon=function(a,b){this.vertices_=a;this.shared_=b;this.plane_=csgPlane.fromPoints(a[0].pos(),a[1].pos(),a[2].pos())};
csgPolygon.prototype={clone:function(){var a=this.vertices_.map(function(a){return a.clone()});return new csgPolygon(a,this.shared_)},flip:function(){this.vertices_.reverse().map(function(a){a.flip()});this.plane_.flip()},vertices:function(){return this.vertices_},shared:function(){return this.shared_},splitPolygon:function(a,b,c,d,e){for(var f=0,g=[],h=0;h<this.vertices_.length;h++){var k=a.normal().dot(this.vertices_[h].pos())-a.w(),k=k<-csgPlane.EPSILON?2:k>csgPlane.EPSILON?1:0,f=f|k;g.push(k)}switch(f){case 0:(0<
a.normal().dot(this.plane_.normal())?b:c).push(this);break;case 1:d.push(this);break;case 2:e.push(this);break;case 3:b=[];c=[];for(h=0;h<this.vertices().length;h++){var j=(h+1)%this.vertices().length,k=g[h],m=g[j],f=this.vertices()[h],j=this.vertices()[j];2!=k&&b.push(f);1!=k&&c.push(2!=k?f.clone():f);3==(k|m)&&(k=(a.w()-a.normal().dot(f.pos()))/a.normal().dot(j.pos().minus(f.pos())),k=f.interpolate(j,k),b.push(k),c.push(k.clone()))}3<=b.length&&d.push(new csgPolygon(b,this.shared()));3<=c.length&&
e.push(new csgPolygon(c,this.shared()))}}};var csgNode=function(a){this.back_=this.front_=this.plane_=null;this.polygons_=[];a&&this.build(a)};
csgNode.prototype={clone:function(){var a=new csgNode;a.setPlane(this.plane_&&this.plane_.clone());a.setFront(this.front_&&this.front_.clone());a.setBack(this.back_&&this.back_.clone());a.setPolygons(this.polygons_.map(function(a){return a.clone()}));return a},invert:function(){for(var a=0;a<this.polygons_.length;a++)this.polygons_[a].flip();this.plane_.flip();this.front_&&this.front_.invert();this.back_&&this.back_.invert();a=this.front_;this.front_=this.back_;this.back_=a},clipPolygons:function(a){if(!this.plane_)return a.slice();
for(var b=[],c=[],d=0;d<a.length;d++)a[d].splitPolygon(this.plane_,b,c,b,c);this.front_&&(b=this.front_.clipPolygons(b));c=this.back_?this.back_.clipPolygons(c):[];return b.concat(c)},clipTo:function(a){this.polygons_=a.clipPolygons(this.polygons_);this.front_&&this.front_.clipTo(a);this.back_&&this.back_.clipTo(a)},allPolygons:function(){var a=this.polygons_.slice();this.front_&&(a=a.concat(this.front_.allPolygons()));this.back_&&(a=a.concat(this.back_.allPolygons()));return a},build:function(a){if(a.length){this.plane_||
(this.plane_=a[0].plane_.clone());for(var b=[],c=[],d=0;d<a.length;d++)a[d].splitPolygon(this.plane_,this.polygons_,this.polygons_,b,c);b.length&&(this.front_||(this.front_=new csgNode),this.front_.build(b));c.length&&(this.back_||(this.back_=new csgNode),this.back_.build(c))}},plane:function(){return this.plane_},setPlane:function(a){this.plane_=a},front:function(){return this.front_},setFront:function(a){this.front_=a},back:function(){return this.back_},setBack:function(a){this.back_=a},polygons:function(){return this.polygons_},
setPolygons:function(a){this.polygons_=a}};var CSG=function(){this.polygons_=[]};CSG.fromPolygons=function(a){var b=new CSG;b.setPolygons(a);return b};
CSG.prototype={clone:function(){var a=new CSG;a.setPolygons(this.polygons_.map(function(a){return a.clone()}));return a},toPolygons:function(){return this.polygons_},union:function(a){var b=new csgNode(this.clone().polygons());a=new csgNode(a.clone().polygons());b.clipTo(a);a.clipTo(b);a.invert();a.clipTo(b);a.invert();b.build(a.allPolygons());return CSG.fromPolygons(b.allPolygons())},subtract:function(a){var b=new csgNode(this.clone().polygons());a=new csgNode(a.clone().polygons());b.invert();b.clipTo(a);
a.clipTo(b);a.invert();a.clipTo(b);a.invert();b.build(a.allPolygons());b.invert();return CSG.fromPolygons(b.allPolygons())},intersect:function(a){var b=new csgNode(this.clone().polygons());a=new csgNode(a.clone().polygons());b.invert();a.clipTo(b);a.invert();b.clipTo(a);a.clipTo(b);b.build(a.allPolygons());b.invert();return CSG.fromPolygons(b.allPolygons())},inverse:function(){var a=this.clone();a.polygons().map(function(a){a.flip()});return a},polygons:function(){return this.polygons_},setPolygons:function(a){this.polygons_=
a}};X.indexer=function(){X.base.call(this);this._classname="indexer";this._unique=[];this._indices=[];this._map={}};goog.inherits(X.indexer,X.base);X.indexer.prototype.add=function(a){if(!goog.isDefAndNotNull(a))throw Error("Invalid object.");var b=window.JSON.stringify(a);b in this._map||(this._map[b]=this._unique.length,this._unique.push(a));return this._map[b]};X.indexer.prototype.unique=function(){return this._unique};X.file=function(a){X.base.call(this);this._classname="file";this._path=a;this._dirty=!0};goog.inherits(X.file,X.base);X.loadable=function(){this._filedata=this._file=null};X.loadable.prototype.__defineSetter__("file",function(a){if(!goog.isDefAndNotNull(a)||goog.isArray(a)&&0==a.length)this._file=null;else{if(goog.isArray(a)){if(1==a.length){this._file=new X.file(a[0]);return}this._file=goog.array.map(a,function(a){var c=new X.volume;c._file=new X.file(a);return c})}else this._file=new X.file(a);this._filedata=null}});
X.loadable.prototype.__defineGetter__("file",function(){return!this._file?"":goog.isArray(this._file)?this._file.map(function(a){return a._file._path}):this._file._path});X.loadable.prototype.__defineGetter__("filedata",function(){return goog.isArray(this._file)?this._file.map(function(a){return a._filedata}):this._filedata});
X.loadable.prototype.__defineSetter__("filedata",function(a){if(!goog.isDefAndNotNull(a)||goog.isArray(a)&&0==a.length)this._filedata=null;if(goog.isArray(a))if(1==a.length)this._filedata=a[0];else{var b=this._file.length,c;for(c=0;c<b;c++)this._file[c]._filedata=a[c]}else this._filedata=a});goog.iter={};goog.iter.StopIteration="StopIteration"in goog.global?goog.global.StopIteration:Error("StopIteration");goog.iter.Iterator=function(){};goog.iter.Iterator.prototype.next=function(){throw goog.iter.StopIteration;};goog.iter.Iterator.prototype.__iterator__=function(){return this};
goog.iter.toIterator=function(a){if(a instanceof goog.iter.Iterator)return a;if("function"==typeof a.__iterator__)return a.__iterator__(!1);if(goog.isArrayLike(a)){var b=0,c=new goog.iter.Iterator;c.next=function(){for(;;){if(b>=a.length)throw goog.iter.StopIteration;if(b in a)return a[b++];b++}};return c}throw Error("Not implemented");};
goog.iter.forEach=function(a,b,c){if(goog.isArrayLike(a))try{goog.array.forEach(a,b,c)}catch(d){if(d!==goog.iter.StopIteration)throw d;}else{a=goog.iter.toIterator(a);try{for(;;)b.call(c,a.next(),void 0,a)}catch(e){if(e!==goog.iter.StopIteration)throw e;}}};goog.iter.filter=function(a,b,c){var d=goog.iter.toIterator(a);a=new goog.iter.Iterator;a.next=function(){for(;;){var a=d.next();if(b.call(c,a,void 0,d))return a}};return a};
goog.iter.range=function(a,b,c){var d=0,e=a,f=c||1;1<arguments.length&&(d=a,e=b);if(0==f)throw Error("Range step argument must not be zero");var g=new goog.iter.Iterator;g.next=function(){if(0<f&&d>=e||0>f&&d<=e)throw goog.iter.StopIteration;var a=d;d+=f;return a};return g};goog.iter.join=function(a,b){return goog.iter.toArray(a).join(b)};goog.iter.map=function(a,b,c){var d=goog.iter.toIterator(a);a=new goog.iter.Iterator;a.next=function(){for(;;){var a=d.next();return b.call(c,a,void 0,d)}};return a};
goog.iter.reduce=function(a,b,c,d){var e=c;goog.iter.forEach(a,function(a){e=b.call(d,e,a)});return e};goog.iter.some=function(a,b,c){a=goog.iter.toIterator(a);try{for(;;)if(b.call(c,a.next(),void 0,a))return!0}catch(d){if(d!==goog.iter.StopIteration)throw d;}return!1};goog.iter.every=function(a,b,c){a=goog.iter.toIterator(a);try{for(;;)if(!b.call(c,a.next(),void 0,a))return!1}catch(d){if(d!==goog.iter.StopIteration)throw d;}return!0};
goog.iter.chain=function(a){var b=arguments,c=b.length,d=0,e=new goog.iter.Iterator;e.next=function(){try{if(d>=c)throw goog.iter.StopIteration;return goog.iter.toIterator(b[d]).next()}catch(a){if(a!==goog.iter.StopIteration||d>=c)throw a;d++;return this.next()}};return e};goog.iter.dropWhile=function(a,b,c){var d=goog.iter.toIterator(a);a=new goog.iter.Iterator;var e=!0;a.next=function(){for(;;){var a=d.next();if(!e||!b.call(c,a,void 0,d))return e=!1,a}};return a};
goog.iter.takeWhile=function(a,b,c){var d=goog.iter.toIterator(a);a=new goog.iter.Iterator;var e=!0;a.next=function(){for(;;)if(e){var a=d.next();if(b.call(c,a,void 0,d))return a;e=!1}else throw goog.iter.StopIteration;};return a};goog.iter.toArray=function(a){if(goog.isArrayLike(a))return goog.array.toArray(a);a=goog.iter.toIterator(a);var b=[];goog.iter.forEach(a,function(a){b.push(a)});return b};
goog.iter.equals=function(a,b){a=goog.iter.toIterator(a);b=goog.iter.toIterator(b);var c,d;try{for(;;){c=d=!1;var e=a.next();c=!0;var f=b.next();d=!0;if(e!=f)break}}catch(g){if(g!==goog.iter.StopIteration)throw g;if(c&&!d)return!1;if(!d)try{b.next()}catch(h){if(h!==goog.iter.StopIteration)throw h;return!0}}return!1};goog.iter.nextOrValue=function(a,b){try{return goog.iter.toIterator(a).next()}catch(c){if(c!=goog.iter.StopIteration)throw c;return b}};
goog.iter.product=function(a){if(goog.array.some(arguments,function(a){return!a.length})||!arguments.length)return new goog.iter.Iterator;var b=new goog.iter.Iterator,c=arguments,d=goog.array.repeat(0,c.length);b.next=function(){if(d){for(var a=goog.array.map(d,function(a,b){return c[b][a]}),b=d.length-1;0<=b;b--){goog.asserts.assert(d);if(d[b]<c[b].length-1){d[b]++;break}if(0==b){d=null;break}d[b]=0}return a}throw goog.iter.StopIteration;};return b};
goog.iter.cycle=function(a){var b=goog.iter.toIterator(a),c=[],d=0;a=new goog.iter.Iterator;var e=!1;a.next=function(){var a=null;if(!e)try{return a=b.next(),c.push(a),a}catch(g){if(g!=goog.iter.StopIteration||goog.array.isEmpty(c))throw g;e=!0}a=c[d];d=(d+1)%c.length;return a};return a};goog.structs={};goog.structs.getCount=function(a){return"function"==typeof a.getCount?a.getCount():goog.isArrayLike(a)||goog.isString(a)?a.length:goog.object.getCount(a)};goog.structs.getValues=function(a){if("function"==typeof a.getValues)return a.getValues();if(goog.isString(a))return a.split("");if(goog.isArrayLike(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}return goog.object.getValues(a)};
goog.structs.getKeys=function(a){if("function"==typeof a.getKeys)return a.getKeys();if("function"!=typeof a.getValues){if(goog.isArrayLike(a)||goog.isString(a)){var b=[];a=a.length;for(var c=0;c<a;c++)b.push(c);return b}return goog.object.getKeys(a)}};goog.structs.contains=function(a,b){return"function"==typeof a.contains?a.contains(b):"function"==typeof a.containsValue?a.containsValue(b):goog.isArrayLike(a)||goog.isString(a)?goog.array.contains(a,b):goog.object.containsValue(a,b)};
goog.structs.isEmpty=function(a){return"function"==typeof a.isEmpty?a.isEmpty():goog.isArrayLike(a)||goog.isString(a)?goog.array.isEmpty(a):goog.object.isEmpty(a)};goog.structs.clear=function(a){"function"==typeof a.clear?a.clear():goog.isArrayLike(a)?goog.array.clear(a):goog.object.clear(a)};
goog.structs.forEach=function(a,b,c){if("function"==typeof a.forEach)a.forEach(b,c);else if(goog.isArrayLike(a)||goog.isString(a))goog.array.forEach(a,b,c);else for(var d=goog.structs.getKeys(a),e=goog.structs.getValues(a),f=e.length,g=0;g<f;g++)b.call(c,e[g],d&&d[g],a)};
goog.structs.filter=function(a,b,c){if("function"==typeof a.filter)return a.filter(b,c);if(goog.isArrayLike(a)||goog.isString(a))return goog.array.filter(a,b,c);var d,e=goog.structs.getKeys(a),f=goog.structs.getValues(a),g=f.length;if(e){d={};for(var h=0;h<g;h++)b.call(c,f[h],e[h],a)&&(d[e[h]]=f[h])}else{d=[];for(h=0;h<g;h++)b.call(c,f[h],void 0,a)&&d.push(f[h])}return d};
goog.structs.map=function(a,b,c){if("function"==typeof a.map)return a.map(b,c);if(goog.isArrayLike(a)||goog.isString(a))return goog.array.map(a,b,c);var d,e=goog.structs.getKeys(a),f=goog.structs.getValues(a),g=f.length;if(e){d={};for(var h=0;h<g;h++)d[e[h]]=b.call(c,f[h],e[h],a)}else{d=[];for(h=0;h<g;h++)d[h]=b.call(c,f[h],void 0,a)}return d};
goog.structs.some=function(a,b,c){if("function"==typeof a.some)return a.some(b,c);if(goog.isArrayLike(a)||goog.isString(a))return goog.array.some(a,b,c);for(var d=goog.structs.getKeys(a),e=goog.structs.getValues(a),f=e.length,g=0;g<f;g++)if(b.call(c,e[g],d&&d[g],a))return!0;return!1};
goog.structs.every=function(a,b,c){if("function"==typeof a.every)return a.every(b,c);if(goog.isArrayLike(a)||goog.isString(a))return goog.array.every(a,b,c);for(var d=goog.structs.getKeys(a),e=goog.structs.getValues(a),f=e.length,g=0;g<f;g++)if(!b.call(c,e[g],d&&d[g],a))return!1;return!0};goog.structs.Map=function(a,b){this.map_={};this.keys_=[];var c=arguments.length;if(1<c){if(c%2)throw Error("Uneven number of arguments");for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else a&&this.addAll(a)};goog.structs.Map.prototype.count_=0;goog.structs.Map.prototype.version_=0;goog.structs.Map.prototype.getCount=function(){return this.count_};
goog.structs.Map.prototype.getValues=function(){this.cleanupKeysArray_();for(var a=[],b=0;b<this.keys_.length;b++)a.push(this.map_[this.keys_[b]]);return a};goog.structs.Map.prototype.getKeys=function(){this.cleanupKeysArray_();return this.keys_.concat()};goog.structs.Map.prototype.containsKey=function(a){return goog.structs.Map.hasKey_(this.map_,a)};
goog.structs.Map.prototype.containsValue=function(a){for(var b=0;b<this.keys_.length;b++){var c=this.keys_[b];if(goog.structs.Map.hasKey_(this.map_,c)&&this.map_[c]==a)return!0}return!1};goog.structs.Map.prototype.equals=function(a,b){if(this===a)return!0;if(this.count_!=a.getCount())return!1;var c=b||goog.structs.Map.defaultEquals;this.cleanupKeysArray_();for(var d,e=0;d=this.keys_[e];e++)if(!c(this.get(d),a.get(d)))return!1;return!0};goog.structs.Map.defaultEquals=function(a,b){return a===b};
goog.structs.Map.prototype.isEmpty=function(){return 0==this.count_};goog.structs.Map.prototype.clear=function(){this.map_={};this.version_=this.count_=this.keys_.length=0};goog.structs.Map.prototype.remove=function(a){return goog.structs.Map.hasKey_(this.map_,a)?(delete this.map_[a],this.count_--,this.version_++,this.keys_.length>2*this.count_&&this.cleanupKeysArray_(),!0):!1};
goog.structs.Map.prototype.cleanupKeysArray_=function(){if(this.count_!=this.keys_.length){for(var a=0,b=0;a<this.keys_.length;){var c=this.keys_[a];goog.structs.Map.hasKey_(this.map_,c)&&(this.keys_[b++]=c);a++}this.keys_.length=b}if(this.count_!=this.keys_.length){for(var d={},b=a=0;a<this.keys_.length;)c=this.keys_[a],goog.structs.Map.hasKey_(d,c)||(this.keys_[b++]=c,d[c]=1),a++;this.keys_.length=b}};
goog.structs.Map.prototype.get=function(a,b){return goog.structs.Map.hasKey_(this.map_,a)?this.map_[a]:b};goog.structs.Map.prototype.set=function(a,b){goog.structs.Map.hasKey_(this.map_,a)||(this.count_++,this.keys_.push(a),this.version_++);this.map_[a]=b};goog.structs.Map.prototype.addAll=function(a){var b;a instanceof goog.structs.Map?(b=a.getKeys(),a=a.getValues()):(b=goog.object.getKeys(a),a=goog.object.getValues(a));for(var c=0;c<b.length;c++)this.set(b[c],a[c])};
goog.structs.Map.prototype.clone=function(){return new goog.structs.Map(this)};goog.structs.Map.prototype.transpose=function(){for(var a=new goog.structs.Map,b=0;b<this.keys_.length;b++){var c=this.keys_[b];a.set(this.map_[c],c)}return a};goog.structs.Map.prototype.toObject=function(){this.cleanupKeysArray_();for(var a={},b=0;b<this.keys_.length;b++){var c=this.keys_[b];a[c]=this.map_[c]}return a};goog.structs.Map.prototype.getKeyIterator=function(){return this.__iterator__(!0)};
goog.structs.Map.prototype.getValueIterator=function(){return this.__iterator__(!1)};goog.structs.Map.prototype.__iterator__=function(a){this.cleanupKeysArray_();var b=0,c=this.keys_,d=this.map_,e=this.version_,f=this,g=new goog.iter.Iterator;g.next=function(){for(;;){if(e!=f.version_)throw Error("The map has changed since the iterator was created");if(b>=c.length)throw goog.iter.StopIteration;var g=c[b++];return a?g:d[g]}};return g};
goog.structs.Map.hasKey_=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};X.colortable=function(){X.base.call(this);this._classname="colortable";this._map=new goog.structs.Map;inject(this,new X.loadable)};goog.inherits(X.colortable,X.base);X.colortable.prototype.add=function(a,b,c,d,e,f){if(!goog.isNumber(a)||!goog.isNumber(c)||!goog.isNumber(d)||!goog.isNumber(e)||!goog.isNumber(f))throw Error("Invalid color table entry.");this._map.set(a,[b,c,d,e,f]);this._dirty=!0};X.colortable.prototype.get=function(a){return this._map.get(a)};
goog.exportSymbol("X.colortable.prototype.get",X.colortable.prototype.get);goog.math={};goog.math.randomInt=function(a){return Math.floor(Math.random()*a)};goog.math.uniformRandom=function(a,b){return a+Math.random()*(b-a)};goog.math.clamp=function(a,b,c){return Math.min(Math.max(a,b),c)};goog.math.modulo=function(a,b){var c=a%b;return 0>c*b?c+b:c};goog.math.lerp=function(a,b,c){return a+c*(b-a)};goog.math.nearlyEquals=function(a,b,c){return Math.abs(a-b)<=(c||1E-6)};goog.math.standardAngle=function(a){return goog.math.modulo(a,360)};
goog.math.toRadians=function(a){return a*Math.PI/180};goog.math.toDegrees=function(a){return 180*a/Math.PI};goog.math.angleDx=function(a,b){return b*Math.cos(goog.math.toRadians(a))};goog.math.angleDy=function(a,b){return b*Math.sin(goog.math.toRadians(a))};goog.math.angle=function(a,b,c,d){return goog.math.standardAngle(goog.math.toDegrees(Math.atan2(d-b,c-a)))};goog.math.angleDifference=function(a,b){var c=goog.math.standardAngle(b)-goog.math.standardAngle(a);180<c?c-=360:-180>=c&&(c=360+c);return c};
goog.math.sign=function(a){return 0==a?0:0>a?-1:1};goog.math.longestCommonSubsequence=function(a,b,c,d){c=c||function(a,b){return a==b};d=d||function(b){return a[b]};for(var e=a.length,f=b.length,g=[],h=0;h<e+1;h++)g[h]=[],g[h][0]=0;for(var k=0;k<f+1;k++)g[0][k]=0;for(h=1;h<=e;h++)for(k=1;k<=e;k++)g[h][k]=c(a[h-1],b[k-1])?g[h-1][k-1]+1:Math.max(g[h-1][k],g[h][k-1]);for(var j=[],h=e,k=f;0<h&&0<k;)c(a[h-1],b[k-1])?(j.unshift(d(h-1,k-1)),h--,k--):g[h-1][k]>g[h][k-1]?h--:k--;return j};
goog.math.sum=function(a){return goog.array.reduce(arguments,function(a,c){return a+c},0)};goog.math.average=function(a){return goog.math.sum.apply(null,arguments)/arguments.length};goog.math.standardDeviation=function(a){var b=arguments.length;if(2>b)return 0;var c=goog.math.average.apply(null,arguments),b=goog.math.sum.apply(null,goog.array.map(arguments,function(a){return Math.pow(a-c,2)}))/(b-1);return Math.sqrt(b)};goog.math.isInt=function(a){return isFinite(a)&&0==a%1};
goog.math.isFiniteNumber=function(a){return isFinite(a)&&!isNaN(a)};goog.math.safeFloor=function(a,b){goog.asserts.assert(!goog.isDef(b)||0<b);return Math.floor(a+(b||2E-15))};goog.math.safeCeil=function(a,b){goog.asserts.assert(!goog.isDef(b)||0<b);return Math.ceil(a-(b||2E-15))};goog.math.Coordinate3=function(a,b,c){this.x=goog.isDef(a)?a:0;this.y=goog.isDef(b)?b:0;this.z=goog.isDef(c)?c:0};goog.math.Coordinate3.prototype.clone=function(){return new goog.math.Coordinate3(this.x,this.y,this.z)};goog.DEBUG&&(goog.math.Coordinate3.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"});goog.math.Coordinate3.equals=function(a,b){return a==b?!0:!a||!b?!1:a.x==b.x&&a.y==b.y&&a.z==b.z};
goog.math.Coordinate3.distance=function(a,b){var c=a.x-b.x,d=a.y-b.y,e=a.z-b.z;return Math.sqrt(c*c+d*d+e*e)};goog.math.Coordinate3.squaredDistance=function(a,b){var c=a.x-b.x,d=a.y-b.y,e=a.z-b.z;return c*c+d*d+e*e};goog.math.Coordinate3.difference=function(a,b){return new goog.math.Coordinate3(a.x-b.x,a.y-b.y,a.z-b.z)};goog.math.Coordinate3.prototype.toArray=function(){return[this.x,this.y,this.z]};
goog.math.Coordinate3.fromArray=function(a){if(3>=a.length)return new goog.math.Coordinate3(a[0],a[1],a[2]);throw Error("Conversion from an array requires an array of length 3");};goog.math.Vec3=function(a,b,c){this.x=a;this.y=b;this.z=c};goog.inherits(goog.math.Vec3,goog.math.Coordinate3);goog.math.Vec3.randomUnit=function(){var a=2*Math.random()*Math.PI,b=2*Math.random()*Math.PI,b=Math.cos(b),c=Math.sqrt(1-b*b)*Math.cos(a),a=Math.sqrt(1-b*b)*Math.sin(a);return new goog.math.Vec3(c,a,b)};goog.math.Vec3.random=function(){return goog.math.Vec3.randomUnit().scale(Math.random())};goog.math.Vec3.fromCoordinate3=function(a){return new goog.math.Vec3(a.x,a.y,a.z)};
goog.math.Vec3.prototype.clone=function(){return new goog.math.Vec3(this.x,this.y,this.z)};goog.math.Vec3.prototype.magnitude=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)};goog.math.Vec3.prototype.squaredMagnitude=function(){return this.x*this.x+this.y*this.y+this.z*this.z};goog.math.Vec3.prototype.scale=function(a){this.x*=a;this.y*=a;this.z*=a;return this};goog.math.Vec3.prototype.invert=function(){this.x=-this.x;this.y=-this.y;this.z=-this.z;return this};
goog.math.Vec3.prototype.normalize=function(){return this.scale(1/this.magnitude())};goog.math.Vec3.prototype.add=function(a){this.x+=a.x;this.y+=a.y;this.z+=a.z;return this};goog.math.Vec3.prototype.subtract=function(a){this.x-=a.x;this.y-=a.y;this.z-=a.z;return this};goog.math.Vec3.prototype.equals=function(a){return this==a||!!a&&this.x==a.x&&this.y==a.y&&this.z==a.z};goog.math.Vec3.distance=goog.math.Coordinate3.distance;goog.math.Vec3.squaredDistance=goog.math.Coordinate3.squaredDistance;
goog.math.Vec3.equals=goog.math.Coordinate3.equals;goog.math.Vec3.sum=function(a,b){return new goog.math.Vec3(a.x+b.x,a.y+b.y,a.z+b.z)};goog.math.Vec3.difference=function(a,b){return new goog.math.Vec3(a.x-b.x,a.y-b.y,a.z-b.z)};goog.math.Vec3.dot=function(a,b){return a.x*b.x+a.y*b.y+a.z*b.z};goog.math.Vec3.cross=function(a,b){return new goog.math.Vec3(a.y*b.z-a.z*b.y,a.z*b.x-a.x*b.z,a.x*b.y-a.y*b.x)};
goog.math.Vec3.lerp=function(a,b,c){return new goog.math.Vec3(goog.math.lerp(a.x,b.x,c),goog.math.lerp(a.y,b.y,c),goog.math.lerp(a.z,b.z,c))};X.vector=goog.math.Vec3;X.vector.prototype.clone=goog.math.Vec3.prototype.clone;X.vector.prototype.magnitude=goog.math.Vec3.prototype.magnitude;X.vector.prototype.scale=goog.math.Vec3.prototype.scale;X.vector.prototype.invert=goog.math.Vec3.prototype.invert;X.vector.prototype.add=goog.math.Vec3.prototype.add;X.vector.prototype.subtract=goog.math.Vec3.prototype.subtract;X.vector.prototype.normalize=function(){var a=this.magnitude();return 0==a?this.scale(0):this.scale(1/a)};X.vector.dot=goog.math.Vec3.dot;
X.vector.cross=goog.math.Vec3.cross;X.vector.distance=goog.math.Vec3.distance;X.vector.lerp=goog.math.Vec3.lerp;X.vector.prototype.__defineGetter__("xx",function(){return this.x});X.vector.prototype.__defineGetter__("yy",function(){return this.y});X.vector.prototype.__defineGetter__("zz",function(){return this.z});goog.exportSymbol("X.vector",X.vector);goog.exportSymbol("X.vector.prototype.clone",X.vector.prototype.clone);goog.exportSymbol("X.vector.prototype.magnitude",X.vector.prototype.magnitude);
goog.exportSymbol("X.vector.prototype.scale",X.vector.prototype.scale);goog.exportSymbol("X.vector.prototype.invert",X.vector.prototype.invert);goog.exportSymbol("X.vector.prototype.normalize",X.vector.prototype.normalize);goog.exportSymbol("X.vector.prototype.add",X.vector.prototype.add);goog.exportSymbol("X.vector.prototype.subtract",X.vector.prototype.subtract);goog.exportSymbol("X.vector.dot",X.vector.dot);goog.exportSymbol("X.vector.cross",X.vector.cross);
goog.exportSymbol("X.vector.distance",X.vector.distance);goog.exportSymbol("X.vector.lerp",X.vector.lerp);goog.vec={};goog.vec.Float64Array=function(a){this.length=a.length||a;for(var b=0;b<this.length;b++)this[b]=a[b]||0};goog.vec.Float64Array.BYTES_PER_ELEMENT=8;goog.vec.Float64Array.prototype.BYTES_PER_ELEMENT=8;goog.vec.Float64Array.prototype.set=function(a,b){b=b||0;for(var c=0;c<a.length&&b+c<this.length;c++)this[b+c]=a[c]};goog.vec.Float64Array.prototype.toString=Array.prototype.join;
if("undefined"==typeof Float64Array){try{goog.exportProperty(goog.vec.Float64Array,"BYTES_PER_ELEMENT",goog.vec.Float64Array.BYTES_PER_ELEMENT)}catch(float64ArrayError){}goog.exportProperty(goog.vec.Float64Array.prototype,"BYTES_PER_ELEMENT",goog.vec.Float64Array.prototype.BYTES_PER_ELEMENT);goog.exportProperty(goog.vec.Float64Array.prototype,"set",goog.vec.Float64Array.prototype.set);goog.exportProperty(goog.vec.Float64Array.prototype,"toString",goog.vec.Float64Array.prototype.toString);goog.exportSymbol("Float64Array",
goog.vec.Float64Array)};goog.vec.Float32Array=function(a){this.length=a.length||a;for(var b=0;b<this.length;b++)this[b]=a[b]||0};goog.vec.Float32Array.BYTES_PER_ELEMENT=4;goog.vec.Float32Array.prototype.BYTES_PER_ELEMENT=4;goog.vec.Float32Array.prototype.set=function(a,b){b=b||0;for(var c=0;c<a.length&&b+c<this.length;c++)this[b+c]=a[c]};goog.vec.Float32Array.prototype.toString=Array.prototype.join;
"undefined"==typeof Float32Array&&(goog.exportProperty(goog.vec.Float32Array,"BYTES_PER_ELEMENT",goog.vec.Float32Array.BYTES_PER_ELEMENT),goog.exportProperty(goog.vec.Float32Array.prototype,"BYTES_PER_ELEMENT",goog.vec.Float32Array.prototype.BYTES_PER_ELEMENT),goog.exportProperty(goog.vec.Float32Array.prototype,"set",goog.vec.Float32Array.prototype.set),goog.exportProperty(goog.vec.Float32Array.prototype,"toString",goog.vec.Float32Array.prototype.toString),goog.exportSymbol("Float32Array",goog.vec.Float32Array));goog.vec.EPSILON=1E-6;goog.vec.Vec3={};goog.vec.Vec3.createFloat32=function(){return new Float32Array(3)};goog.vec.Vec3.createFloat64=function(){return new Float64Array(3)};goog.vec.Vec3.createNumber=function(){var a=Array(3);goog.vec.Vec3.setFromValues(a,0,0,0);return a};goog.vec.Vec3.create=function(){return new Float32Array(3)};goog.vec.Vec3.createFloat32FromArray=function(a){var b=goog.vec.Vec3.createFloat32();goog.vec.Vec3.setFromArray(b,a);return b};
goog.vec.Vec3.createFloat32FromValues=function(a,b,c){var d=goog.vec.Vec3.createFloat32();goog.vec.Vec3.setFromValues(d,a,b,c);return d};goog.vec.Vec3.cloneFloat32=goog.vec.Vec3.createFloat32FromArray;goog.vec.Vec3.createFloat64FromArray=function(a){var b=goog.vec.Vec3.createFloat64();goog.vec.Vec3.setFromArray(b,a);return b};goog.vec.Vec3.createFloat64FromValues=function(a,b,c){var d=goog.vec.Vec3.createFloat64();goog.vec.Vec3.setFromValues(d,a,b,c);return d};goog.vec.Vec3.cloneFloat64=goog.vec.Vec3.createFloat64FromArray;
goog.vec.Vec3.createFromArray=function(a){var b=goog.vec.Vec3.create();goog.vec.Vec3.setFromArray(b,a);return b};goog.vec.Vec3.createFromValues=function(a,b,c){var d=goog.vec.Vec3.create();goog.vec.Vec3.setFromValues(d,a,b,c);return d};goog.vec.Vec3.clone=function(a){var b=goog.vec.Vec3.create();goog.vec.Vec3.setFromArray(b,a);return b};goog.vec.Vec3.setFromValues=function(a,b,c,d){a[0]=b;a[1]=c;a[2]=d;return a};goog.vec.Vec3.setFromArray=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];return a};
goog.vec.Vec3.add=function(a,b,c){c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];return c};goog.vec.Vec3.subtract=function(a,b,c){c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];return c};goog.vec.Vec3.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b};goog.vec.Vec3.scale=function(a,b,c){c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;return c};goog.vec.Vec3.magnitudeSquared=function(a){var b=a[0],c=a[1];a=a[2];return b*b+c*c+a*a};
goog.vec.Vec3.magnitude=function(a){var b=a[0],c=a[1];a=a[2];return Math.sqrt(b*b+c*c+a*a)};goog.vec.Vec3.normalize=function(a,b){var c=1/goog.vec.Vec3.magnitude(a);b[0]=a[0]*c;b[1]=a[1]*c;b[2]=a[2]*c;return b};goog.vec.Vec3.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};goog.vec.Vec3.cross=function(a,b,c){var d=a[0],e=a[1];a=a[2];var f=b[0],g=b[1];b=b[2];c[0]=e*b-a*g;c[1]=a*f-d*b;c[2]=d*g-e*f;return c};
goog.vec.Vec3.distanceSquared=function(a,b){var c=a[0]-b[0],d=a[1]-b[1],e=a[2]-b[2];return c*c+d*d+e*e};goog.vec.Vec3.distance=function(a,b){return Math.sqrt(goog.vec.Vec3.distanceSquared(a,b))};goog.vec.Vec3.direction=function(a,b,c){var d=b[0]-a[0],e=b[1]-a[1];a=b[2]-a[2];(b=Math.sqrt(d*d+e*e+a*a))?(b=1/b,c[0]=d*b,c[1]=e*b,c[2]=a*b):c[0]=c[1]=c[2]=0;return c};goog.vec.Vec3.lerp=function(a,b,c,d){var e=a[0],f=a[1];a=a[2];d[0]=(b[0]-e)*c+e;d[1]=(b[1]-f)*c+f;d[2]=(b[2]-a)*c+a;return d};
goog.vec.Vec3.equals=function(a,b){return a.length==b.length&&a[0]==b[0]&&a[1]==b[1]&&a[2]==b[2]};goog.vec.Vec4={};goog.vec.Vec4.createFloat32=function(){return new Float32Array(4)};goog.vec.Vec4.createFloat64=function(){return new Float64Array(4)};goog.vec.Vec4.createNumber=function(){var a=Array(4);goog.vec.Vec4.setFromValues(a,0,0,0,0);return a};goog.vec.Vec4.create=function(){return new Float32Array(4)};goog.vec.Vec4.createFromArray=function(a){var b=goog.vec.Vec4.create();goog.vec.Vec4.setFromArray(b,a);return b};
goog.vec.Vec4.createFloat32FromArray=function(a){var b=goog.vec.Vec4.createFloat32();goog.vec.Vec4.setFromArray(b,a);return b};goog.vec.Vec4.createFloat32FromValues=function(a,b,c,d){var e=goog.vec.Vec4.createFloat32();goog.vec.Vec4.setFromValues(e,a,b,c,d);return e};goog.vec.Vec4.cloneFloat32=goog.vec.Vec4.createFloat32FromArray;goog.vec.Vec4.createFloat64FromArray=function(a){var b=goog.vec.Vec4.createFloat64();goog.vec.Vec4.setFromArray(b,a);return b};
goog.vec.Vec4.createFloat64FromValues=function(a,b,c,d){var e=goog.vec.Vec4.createFloat64();goog.vec.Vec4.setFromValues(e,a,b,c,d);return e};goog.vec.Vec4.cloneFloat64=goog.vec.Vec4.createFloat64FromArray;goog.vec.Vec4.createFromValues=function(a,b,c,d){var e=goog.vec.Vec4.create();goog.vec.Vec4.setFromValues(e,a,b,c,d);return e};goog.vec.Vec4.clone=goog.vec.Vec4.createFromArray;goog.vec.Vec4.setFromValues=function(a,b,c,d,e){a[0]=b;a[1]=c;a[2]=d;a[3]=e;return a};
goog.vec.Vec4.setFromArray=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];return a};goog.vec.Vec4.add=function(a,b,c){c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];c[3]=a[3]+b[3];return c};goog.vec.Vec4.subtract=function(a,b,c){c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];c[3]=a[3]-b[3];return c};goog.vec.Vec4.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=-a[3];return b};goog.vec.Vec4.scale=function(a,b,c){c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;c[3]=a[3]*b;return c};
goog.vec.Vec4.magnitudeSquared=function(a){var b=a[0],c=a[1],d=a[2];a=a[3];return b*b+c*c+d*d+a*a};goog.vec.Vec4.magnitude=function(a){var b=a[0],c=a[1],d=a[2];a=a[3];return Math.sqrt(b*b+c*c+d*d+a*a)};goog.vec.Vec4.normalize=function(a,b){var c=1/goog.vec.Vec4.magnitude(a);b[0]=a[0]*c;b[1]=a[1]*c;b[2]=a[2]*c;b[3]=a[3]*c;return b};goog.vec.Vec4.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};
goog.vec.Vec4.lerp=function(a,b,c,d){var e=a[0],f=a[1],g=a[2];a=a[3];d[0]=(b[0]-e)*c+e;d[1]=(b[1]-f)*c+f;d[2]=(b[2]-g)*c+g;d[3]=(b[3]-a)*c+a;return d};goog.vec.Vec4.equals=function(a,b){return a.length==b.length&&a[0]==b[0]&&a[1]==b[1]&&a[2]==b[2]&&a[3]==b[3]};goog.vec.Mat4={};goog.vec.Mat4.createFloat32=function(){return new Float32Array(16)};goog.vec.Mat4.createFloat64=function(){return new Float64Array(16)};goog.vec.Mat4.createNumber=function(){var a=Array(16);goog.vec.Mat4.setFromValues(a,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);return a};goog.vec.Mat4.create=function(){return goog.vec.Mat4.createFloat32()};goog.vec.Mat4.createFloat32Identity=function(){var a=goog.vec.Mat4.createFloat32();a[0]=a[5]=a[10]=a[15]=1;return a};
goog.vec.Mat4.createFloat64Identity=function(){var a=goog.vec.Mat4.createFloat64();a[0]=a[5]=a[10]=a[15]=1;return a};goog.vec.Mat4.createNumberIdentity=function(){var a=Array(16);goog.vec.Mat4.setFromValues(a,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return a};goog.vec.Mat4.createIdentity=function(){return goog.vec.Mat4.createFloat32Identity()};goog.vec.Mat4.createFloat32FromArray=function(a){var b=goog.vec.Mat4.createFloat32();goog.vec.Mat4.setFromArray(b,a);return b};
goog.vec.Mat4.createFloat32FromValues=function(a,b,c,d,e,f,g,h,k,j,m,l,n,p,q,r){var s=goog.vec.Mat4.createFloat32();goog.vec.Mat4.setFromValues(s,a,b,c,d,e,f,g,h,k,j,m,l,n,p,q,r);return s};goog.vec.Mat4.cloneFloat32=goog.vec.Mat4.createFloat32FromArray;goog.vec.Mat4.createFloat64FromArray=function(a){var b=goog.vec.Mat4.createFloat64();goog.vec.Mat4.setFromArray(b,a);return b};
goog.vec.Mat4.createFloat64FromValues=function(a,b,c,d,e,f,g,h,k,j,m,l,n,p,q,r){var s=goog.vec.Mat4.createFloat64();goog.vec.Mat4.setFromValues(s,a,b,c,d,e,f,g,h,k,j,m,l,n,p,q,r);return s};goog.vec.Mat4.cloneFloat64=goog.vec.Mat4.createFloat64FromArray;goog.vec.Mat4.createFromArray=function(a){var b=goog.vec.Mat4.createFloat32();goog.vec.Mat4.setFromArray(b,a);return b};
goog.vec.Mat4.createFromValues=function(a,b,c,d,e,f,g,h,k,j,m,l,n,p,q,r){return goog.vec.Mat4.createFloat32FromValues(a,b,c,d,e,f,g,h,k,j,m,l,n,p,q,r)};goog.vec.Mat4.clone=goog.vec.Mat4.createFromArray;goog.vec.Mat4.getElement=function(a,b,c){return a[b+4*c]};goog.vec.Mat4.setElement=function(a,b,c,d){a[b+4*c]=d;return a};
goog.vec.Mat4.setFromValues=function(a,b,c,d,e,f,g,h,k,j,m,l,n,p,q,r,s){a[0]=b;a[1]=c;a[2]=d;a[3]=e;a[4]=f;a[5]=g;a[6]=h;a[7]=k;a[8]=j;a[9]=m;a[10]=l;a[11]=n;a[12]=p;a[13]=q;a[14]=r;a[15]=s;return a};goog.vec.Mat4.setFromArray=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];a[9]=b[9];a[10]=b[10];a[11]=b[11];a[12]=b[12];a[13]=b[13];a[14]=b[14];a[15]=b[15];return a};
goog.vec.Mat4.setFromRowMajorArray=function(a,b){a[0]=b[0];a[1]=b[4];a[2]=b[8];a[3]=b[12];a[4]=b[1];a[5]=b[5];a[6]=b[9];a[7]=b[13];a[8]=b[2];a[9]=b[6];a[10]=b[10];a[11]=b[14];a[12]=b[3];a[13]=b[7];a[14]=b[11];a[15]=b[15];return a};goog.vec.Mat4.setDiagonalValues=function(a,b,c,d,e){a[0]=b;a[5]=c;a[10]=d;a[15]=e;return a};goog.vec.Mat4.setDiagonal=function(a,b){a[0]=b[0];a[5]=b[1];a[10]=b[2];a[15]=b[3];return a};
goog.vec.Mat4.getDiagonal=function(a,b,c){if(c)for(var d=0<c?4*c:-c,e=0;e<4-Math.abs(c);e++)b[e]=a[d+5*e];else b[0]=a[0],b[1]=a[5],b[2]=a[10],b[3]=a[15];return b};goog.vec.Mat4.setColumnValues=function(a,b,c,d,e,f){b*=4;a[b]=c;a[b+1]=d;a[b+2]=e;a[b+3]=f;return a};goog.vec.Mat4.setColumn=function(a,b,c){b*=4;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3];return a};goog.vec.Mat4.getColumn=function(a,b,c){b*=4;c[0]=a[b];c[1]=a[b+1];c[2]=a[b+2];c[3]=a[b+3];return c};
goog.vec.Mat4.setColumns=function(a,b,c,d,e){goog.vec.Mat4.setColumn(a,0,b);goog.vec.Mat4.setColumn(a,1,c);goog.vec.Mat4.setColumn(a,2,d);goog.vec.Mat4.setColumn(a,3,e);return a};goog.vec.Mat4.getColumns=function(a,b,c,d,e){goog.vec.Mat4.getColumn(a,0,b);goog.vec.Mat4.getColumn(a,1,c);goog.vec.Mat4.getColumn(a,2,d);goog.vec.Mat4.getColumn(a,3,e)};goog.vec.Mat4.setRowValues=function(a,b,c,d,e,f){a[b]=c;a[b+4]=d;a[b+8]=e;a[b+12]=f;return a};
goog.vec.Mat4.setRow=function(a,b,c){a[b]=c[0];a[b+4]=c[1];a[b+8]=c[2];a[b+12]=c[3];return a};goog.vec.Mat4.getRow=function(a,b,c){c[0]=a[b];c[1]=a[b+4];c[2]=a[b+8];c[3]=a[b+12];return c};goog.vec.Mat4.setRows=function(a,b,c,d,e){goog.vec.Mat4.setRow(a,0,b);goog.vec.Mat4.setRow(a,1,c);goog.vec.Mat4.setRow(a,2,d);goog.vec.Mat4.setRow(a,3,e);return a};
goog.vec.Mat4.getRows=function(a,b,c,d,e){goog.vec.Mat4.getRow(a,0,b);goog.vec.Mat4.getRow(a,1,c);goog.vec.Mat4.getRow(a,2,d);goog.vec.Mat4.getRow(a,3,e)};goog.vec.Mat4.makeZero=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=0;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=0;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=0;return a};goog.vec.Mat4.makeIdentity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};
goog.vec.Mat4.addMat=function(a,b,c){c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];c[3]=a[3]+b[3];c[4]=a[4]+b[4];c[5]=a[5]+b[5];c[6]=a[6]+b[6];c[7]=a[7]+b[7];c[8]=a[8]+b[8];c[9]=a[9]+b[9];c[10]=a[10]+b[10];c[11]=a[11]+b[11];c[12]=a[12]+b[12];c[13]=a[13]+b[13];c[14]=a[14]+b[14];c[15]=a[15]+b[15];return c};
goog.vec.Mat4.subMat=function(a,b,c){c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];c[3]=a[3]-b[3];c[4]=a[4]-b[4];c[5]=a[5]-b[5];c[6]=a[6]-b[6];c[7]=a[7]-b[7];c[8]=a[8]-b[8];c[9]=a[9]-b[9];c[10]=a[10]-b[10];c[11]=a[11]-b[11];c[12]=a[12]-b[12];c[13]=a[13]-b[13];c[14]=a[14]-b[14];c[15]=a[15]-b[15];return c};
goog.vec.Mat4.multScalar=function(a,b,c){c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;c[3]=a[3]*b;c[4]=a[4]*b;c[5]=a[5]*b;c[6]=a[6]*b;c[7]=a[7]*b;c[8]=a[8]*b;c[9]=a[9]*b;c[10]=a[10]*b;c[11]=a[11]*b;c[12]=a[12]*b;c[13]=a[13]*b;c[14]=a[14]*b;c[15]=a[15]*b;return c};
goog.vec.Mat4.multMat=function(a,b,c){var d=a[0],e=a[1],f=a[2],g=a[3],h=a[4],k=a[5],j=a[6],m=a[7],l=a[8],n=a[9],p=a[10],q=a[11],r=a[12],s=a[13],z=a[14];a=a[15];var x=b[0],t=b[1],u=b[2],v=b[3],y=b[4],B=b[5],A=b[6],D=b[7],G=b[8],w=b[9],C=b[10],H=b[11],E=b[12],F=b[13],L=b[14];b=b[15];c[0]=d*x+h*t+l*u+r*v;c[1]=e*x+k*t+n*u+s*v;c[2]=f*x+j*t+p*u+z*v;c[3]=g*x+m*t+q*u+a*v;c[4]=d*y+h*B+l*A+r*D;c[5]=e*y+k*B+n*A+s*D;c[6]=f*y+j*B+p*A+z*D;c[7]=g*y+m*B+q*A+a*D;c[8]=d*G+h*w+l*C+r*H;c[9]=e*G+k*w+n*C+s*H;c[10]=f*G+
j*w+p*C+z*H;c[11]=g*G+m*w+q*C+a*H;c[12]=d*E+h*F+l*L+r*b;c[13]=e*E+k*F+n*L+s*b;c[14]=f*E+j*F+p*L+z*b;c[15]=g*E+m*F+q*L+a*b;return c};
goog.vec.Mat4.transpose=function(a,b){if(b==a){var c=a[1],d=a[2],e=a[3],f=a[6],g=a[7],h=a[11];b[1]=a[4];b[2]=a[8];b[3]=a[12];b[4]=c;b[6]=a[9];b[7]=a[13];b[8]=d;b[9]=f;b[11]=a[14];b[12]=e;b[13]=g;b[14]=h}else b[0]=a[0],b[1]=a[4],b[2]=a[8],b[3]=a[12],b[4]=a[1],b[5]=a[5],b[6]=a[9],b[7]=a[13],b[8]=a[2],b[9]=a[6],b[10]=a[10],b[11]=a[14],b[12]=a[3],b[13]=a[7],b[14]=a[11],b[15]=a[15];return b};
goog.vec.Mat4.determinant=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],k=a[7],j=a[8],m=a[9],l=a[10],n=a[11],p=a[12],q=a[13],r=a[14];a=a[15];return(b*g-c*f)*(l*a-n*r)-(b*h-d*f)*(m*a-n*q)+(b*k-e*f)*(m*r-l*q)+(c*h-d*g)*(j*a-n*p)-(c*k-e*g)*(j*r-l*p)+(d*k-e*h)*(j*q-m*p)};
goog.vec.Mat4.invert=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],k=a[6],j=a[7],m=a[8],l=a[9],n=a[10],p=a[11],q=a[12],r=a[13],s=a[14],z=a[15],x=c*h-d*g,t=c*k-e*g,u=c*j-f*g,v=d*k-e*h,y=d*j-f*h,B=e*j-f*k,A=m*r-l*q,D=m*s-n*q,G=m*z-p*q,w=l*s-n*r,C=l*z-p*r,H=n*z-p*s,E=x*H-t*C+u*w+v*G-y*D+B*A;if(0==E)return!1;E=1/E;b[0]=(h*H-k*C+j*w)*E;b[1]=(-d*H+e*C-f*w)*E;b[2]=(r*B-s*y+z*v)*E;b[3]=(-l*B+n*y-p*v)*E;b[4]=(-g*H+k*G-j*D)*E;b[5]=(c*H-e*G+f*D)*E;b[6]=(-q*B+s*u-z*t)*E;b[7]=(m*B-n*u+p*t)*E;b[8]=
(g*C-h*G+j*A)*E;b[9]=(-c*C+d*G-f*A)*E;b[10]=(q*y-r*u+z*x)*E;b[11]=(-m*y+l*u-p*x)*E;b[12]=(-g*w+h*D-k*A)*E;b[13]=(c*w-d*D+e*A)*E;b[14]=(-q*v+r*t-s*x)*E;b[15]=(m*v-l*t+n*x)*E;return!0};goog.vec.Mat4.equals=function(a,b){return a.length==b.length&&a[0]==b[0]&&a[1]==b[1]&&a[2]==b[2]&&a[3]==b[3]&&a[4]==b[4]&&a[5]==b[5]&&a[6]==b[6]&&a[7]==b[7]&&a[8]==b[8]&&a[9]==b[9]&&a[10]==b[10]&&a[11]==b[11]&&a[12]==b[12]&&a[13]==b[13]&&a[14]==b[14]&&a[15]==b[15]};
goog.vec.Mat4.multVec3=function(a,b,c){var d=b[0],e=b[1];b=b[2];c[0]=d*a[0]+e*a[4]+b*a[8]+a[12];c[1]=d*a[1]+e*a[5]+b*a[9]+a[13];c[2]=d*a[2]+e*a[6]+b*a[10]+a[14];return c};goog.vec.Mat4.multVec3NoTranslate=function(a,b,c){var d=b[0],e=b[1];b=b[2];c[0]=d*a[0]+e*a[4]+b*a[8];c[1]=d*a[1]+e*a[5]+b*a[9];c[2]=d*a[2]+e*a[6]+b*a[10];return c};
goog.vec.Mat4.multVec3Projective=function(a,b,c){var d=b[0],e=b[1];b=b[2];var f=1/(d*a[3]+e*a[7]+b*a[11]+a[15]);c[0]=(d*a[0]+e*a[4]+b*a[8]+a[12])*f;c[1]=(d*a[1]+e*a[5]+b*a[9]+a[13])*f;c[2]=(d*a[2]+e*a[6]+b*a[10]+a[14])*f;return c};goog.vec.Mat4.multVec4=function(a,b,c){var d=b[0],e=b[1],f=b[2];b=b[3];c[0]=d*a[0]+e*a[4]+f*a[8]+b*a[12];c[1]=d*a[1]+e*a[5]+f*a[9]+b*a[13];c[2]=d*a[2]+e*a[6]+f*a[10]+b*a[14];c[3]=d*a[3]+e*a[7]+f*a[11]+b*a[15];return c};
goog.vec.Mat4.makeTranslate=function(a,b,c,d){goog.vec.Mat4.makeIdentity(a);return goog.vec.Mat4.setColumnValues(a,3,b,c,d,1)};goog.vec.Mat4.makeScale=function(a,b,c,d){goog.vec.Mat4.makeIdentity(a);return goog.vec.Mat4.setDiagonalValues(a,b,c,d,1)};goog.vec.Mat4.makeRotate=function(a,b,c,d,e){var f=Math.cos(b),g=1-f;b=Math.sin(b);return goog.vec.Mat4.setFromValues(a,c*c*g+f,c*d*g+e*b,c*e*g-d*b,0,c*d*g-e*b,d*d*g+f,d*e*g+c*b,0,c*e*g+d*b,d*e*g-c*b,e*e*g+f,0,0,0,0,1)};
goog.vec.Mat4.makeRotateX=function(a,b){var c=Math.cos(b),d=Math.sin(b);return goog.vec.Mat4.setFromValues(a,1,0,0,0,0,c,d,0,0,-d,c,0,0,0,0,1)};goog.vec.Mat4.makeRotateY=function(a,b){var c=Math.cos(b),d=Math.sin(b);return goog.vec.Mat4.setFromValues(a,c,0,-d,0,0,1,0,0,d,0,c,0,0,0,0,1)};goog.vec.Mat4.makeRotateZ=function(a,b){var c=Math.cos(b),d=Math.sin(b);return goog.vec.Mat4.setFromValues(a,c,d,0,0,-d,c,0,0,0,0,1,0,0,0,0,1)};
goog.vec.Mat4.makeFrustum=function(a,b,c,d,e,f,g){return goog.vec.Mat4.setFromValues(a,2*f/(c-b),0,0,0,0,2*f/(e-d),0,0,(c+b)/(c-b),(e+d)/(e-d),-(g+f)/(g-f),-1,0,0,-(2*g*f)/(g-f),0)};goog.vec.Mat4.makePerspective=function(a,b,c,d,e){var f=b/2;b=e-d;var g=Math.sin(f);if(0==b||0==g||0==c)return a;f=Math.cos(f)/g;return goog.vec.Mat4.setFromValues(a,f/c,0,0,0,0,f,0,0,0,0,-(e+d)/b,-1,0,0,-(2*d*e)/b,0)};
goog.vec.Mat4.makeOrtho=function(a,b,c,d,e,f,g){return goog.vec.Mat4.setFromValues(a,2/(c-b),0,0,0,0,2/(e-d),0,0,0,0,-2/(g-f),0,-(c+b)/(c-b),-(e+d)/(e-d),-(g+f)/(g-f),1)};
goog.vec.Mat4.makeLookAt=function(a,b,c,d){var e=goog.vec.Mat4.tmpVec4_[0];goog.vec.Vec3.subtract(c,b,e);goog.vec.Vec3.normalize(e,e);e[3]=0;c=goog.vec.Mat4.tmpVec4_[1];goog.vec.Vec3.cross(e,d,c);goog.vec.Vec3.normalize(c,c);c[3]=0;d=goog.vec.Mat4.tmpVec4_[2];goog.vec.Vec3.cross(c,e,d);goog.vec.Vec3.normalize(d,d);d[3]=0;goog.vec.Vec3.negate(e,e);goog.vec.Mat4.setRow(a,0,c);goog.vec.Mat4.setRow(a,1,d);goog.vec.Mat4.setRow(a,2,e);goog.vec.Mat4.setRowValues(a,3,0,0,0,1);goog.vec.Mat4.translate(a,-b[0],
-b[1],-b[2]);return a};goog.vec.Mat4.toLookAt=function(a,b,c,d){var e=goog.vec.Mat4.tmpMat4_[0];if(!goog.vec.Mat4.invert(a,e))return!1;b&&(b[0]=e[12],b[1]=e[13],b[2]=e[14]);if(c||d)c||(c=goog.vec.Mat4.tmpVec3_[0]),c[0]=-a[2],c[1]=-a[6],c[2]=-a[10],goog.vec.Vec3.normalize(c,c);d&&(b=goog.vec.Mat4.tmpVec3_[1],b[0]=a[0],b[1]=a[4],b[2]=a[8],goog.vec.Vec3.cross(b,c,d),goog.vec.Vec3.normalize(d,d));return!0};
goog.vec.Mat4.makeEulerZXZ=function(a,b,c,d){var e=Math.cos(b);b=Math.sin(b);var f=Math.cos(c);c=Math.sin(c);var g=Math.cos(d);d=Math.sin(d);a[0]=e*g-f*b*d;a[1]=f*e*d+g*b;a[2]=d*c;a[3]=0;a[4]=-e*d-g*f*b;a[5]=e*f*g-b*d;a[6]=g*c;a[7]=0;a[8]=c*b;a[9]=-e*c;a[10]=f;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};
goog.vec.Mat4.toEulerZXZ=function(a,b,c){var d=Math.sqrt(a[2]*a[2]+a[6]*a[6]);c=c?-1:1;d>goog.vec.EPSILON?(b[2]=Math.atan2(a[2]*c,a[6]*c),b[1]=Math.atan2(d*c,a[10]),b[0]=Math.atan2(a[8]*c,-a[9]*c)):(b[0]=0,b[1]=Math.atan2(d*c,a[10]),b[2]=Math.atan2(a[1],a[0]));b[0]=(b[0]+2*Math.PI)%(2*Math.PI);b[2]=(b[2]+2*Math.PI)%(2*Math.PI);b[1]=(b[1]*c+2*Math.PI)%(2*Math.PI)*c;return b};
goog.vec.Mat4.translate=function(a,b,c,d){return goog.vec.Mat4.setColumnValues(a,3,a[0]*b+a[4]*c+a[8]*d+a[12],a[1]*b+a[5]*c+a[9]*d+a[13],a[2]*b+a[6]*c+a[10]*d+a[14],a[3]*b+a[7]*c+a[11]*d+a[15])};goog.vec.Mat4.scale=function(a,b,c,d){return goog.vec.Mat4.setFromValues(a,a[0]*b,a[1]*b,a[2]*b,a[3]*b,a[4]*c,a[5]*c,a[6]*c,a[7]*c,a[8]*d,a[9]*d,a[10]*d,a[11]*d,a[12],a[13],a[14],a[15])};
goog.vec.Mat4.rotate=function(a,b,c,d,e){var f=a[0],g=a[1],h=a[2],k=a[3],j=a[4],m=a[5],l=a[6],n=a[7],p=a[8],q=a[9],r=a[10],s=a[11],z=a[12],x=a[13],t=a[14],u=a[15],v=Math.cos(b),y=Math.sin(b),B=1-v;b=c*c*B+v;var A=c*d*B+e*y,D=c*e*B-d*y,G=c*d*B-e*y,w=d*d*B+v,C=d*e*B+c*y,H=c*e*B+d*y;c=d*e*B-c*y;e=e*e*B+v;return goog.vec.Mat4.setFromValues(a,f*b+j*A+p*D,g*b+m*A+q*D,h*b+l*A+r*D,k*b+n*A+s*D,f*G+j*w+p*C,g*G+m*w+q*C,h*G+l*w+r*C,k*G+n*w+s*C,f*H+j*c+p*e,g*H+m*c+q*e,h*H+l*c+r*e,k*H+n*c+s*e,z,x,t,u)};
goog.vec.Mat4.rotateX=function(a,b){var c=a[4],d=a[5],e=a[6],f=a[7],g=a[8],h=a[9],k=a[10],j=a[11],m=Math.cos(b),l=Math.sin(b);a[4]=c*m+g*l;a[5]=d*m+h*l;a[6]=e*m+k*l;a[7]=f*m+j*l;a[8]=c*-l+g*m;a[9]=d*-l+h*m;a[10]=e*-l+k*m;a[11]=f*-l+j*m;return a};goog.vec.Mat4.rotateY=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[8],h=a[9],k=a[10],j=a[11],m=Math.cos(b),l=Math.sin(b);a[0]=c*m+g*-l;a[1]=d*m+h*-l;a[2]=e*m+k*-l;a[3]=f*m+j*-l;a[8]=c*l+g*m;a[9]=d*l+h*m;a[10]=e*l+k*m;a[11]=f*l+j*m;return a};
goog.vec.Mat4.rotateZ=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],k=a[6],j=a[7],m=Math.cos(b),l=Math.sin(b);a[0]=c*m+g*l;a[1]=d*m+h*l;a[2]=e*m+k*l;a[3]=f*m+j*l;a[4]=c*-l+g*m;a[5]=d*-l+h*m;a[6]=e*-l+k*m;a[7]=f*-l+j*m;return a};goog.vec.Mat4.getTranslation=function(a,b){b[0]=a[12];b[1]=a[13];b[2]=a[14];return b};goog.vec.Mat4.tmpVec3_=[goog.vec.Vec3.createFloat64(),goog.vec.Vec3.createFloat64()];goog.vec.Mat4.tmpVec4_=[goog.vec.Vec4.createFloat64(),goog.vec.Vec4.createFloat64(),goog.vec.Vec4.createFloat64()];
goog.vec.Mat4.tmpMat4_=[goog.vec.Mat4.createFloat64()];X.matrix={};X.matrix.makeLookAt=function(a,b,c,d){c=c.subtract(b);c.normalize();d=X.vector.cross(c,d);d.normalize();var e=X.vector.cross(d,c);e.normalize();c.invert();goog.vec.Mat4.setRowValues(a,0,d.x,d.y,d.z,0);goog.vec.Mat4.setRowValues(a,1,e.x,e.y,e.z,0);goog.vec.Mat4.setRowValues(a,2,c.x,c.y,c.z,0);goog.vec.Mat4.translate(a,-b.x,-b.y,-b.z);return a};
X.matrix.multiplyByVector=function(a,b,c,d){var e=1/(b*a[3]+c*a[7]+d*a[11]+a[15]);return new X.vector((b*a[0]+c*a[4]+d*a[8]+a[12])*e,(b*a[1]+c*a[5]+d*a[9]+a[13])*e,(b*a[2]+c*a[6]+d*a[10]+a[14])*e)};X.matrix.swapRows=function(a,b,c){var d=new Float32Array(4),e=new Float32Array(4);goog.vec.Mat4.getRow(a,b,d);goog.vec.Mat4.getRow(a,c,e);goog.vec.Mat4.setRow(a,b,e);goog.vec.Mat4.setRow(a,c,d);return a};
X.matrix.swapCols=function(a,b,c){var d=new Float32Array(4),e=new Float32Array(4);goog.vec.Mat4.getColumn(a,b,d);goog.vec.Mat4.getColumn(a,c,e);goog.vec.Mat4.setColumn(a,b,e);goog.vec.Mat4.setColumn(a,c,d);return a};X.matrix.identity=goog.vec.Mat4.createFloat32Identity;X.matrix.clone=goog.vec.Mat4.cloneFloat32;X.matrix.transpose=goog.vec.Mat4.transpose;X.matrix.determinant=goog.vec.Mat4.determinant;X.matrix.invert=goog.vec.Mat4.invert;X.matrix.makePerspective=goog.vec.Mat4.makePerspective;
X.matrix.makeFrustum=goog.vec.Mat4.makeFrustum;X.matrix.makeOrtho=goog.vec.Mat4.makeOrtho;X.matrix.multiply=goog.vec.Mat4.multMat;X.matrix.multiplyByVec4=goog.vec.Mat4.multVec4;X.matrix.translate=goog.vec.Mat4.translate;X.matrix.scale=goog.vec.Mat4.scale;X.matrix.rotate=goog.vec.Mat4.rotate;X.matrix.rotateX=goog.vec.Mat4.rotateX;X.matrix.rotateY=goog.vec.Mat4.rotateY;X.matrix.rotateZ=goog.vec.Mat4.rotateZ;goog.exportSymbol("X.matrix.identity",X.matrix.identity);
goog.exportSymbol("X.matrix.clone",X.matrix.clone);goog.exportSymbol("X.matrix.transpose",X.matrix.transpose);goog.exportSymbol("X.matrix.determinant",X.matrix.determinant);goog.exportSymbol("X.matrix.invert",X.matrix.invert);goog.exportSymbol("X.matrix.multiply",X.matrix.multiply);goog.exportSymbol("X.matrix.multiplyByVector",X.matrix.multiplyByVector);goog.exportSymbol("X.matrix.multiplyByVec4",X.matrix.multiplyByVec4);goog.exportSymbol("X.matrix.makePerspective",X.matrix.makePerspective);
goog.exportSymbol("X.matrix.makeFrustum",X.matrix.makeFrustum);goog.exportSymbol("X.matrix.makeOrtho",X.matrix.makeOrtho);goog.exportSymbol("X.matrix.makeLookAt",X.matrix.makeLookAt);goog.exportSymbol("X.matrix.translate",X.matrix.translate);goog.exportSymbol("X.matrix.scale",X.matrix.scale);goog.exportSymbol("X.matrix.rotate",X.matrix.rotate);goog.exportSymbol("X.matrix.rotateX",X.matrix.rotateX);goog.exportSymbol("X.matrix.rotateY",X.matrix.rotateY);goog.exportSymbol("X.matrix.rotateZ",X.matrix.rotateZ);
goog.exportSymbol("X.matrix.swapRows",X.matrix.swapRows);goog.exportSymbol("X.matrix.swapCols",X.matrix.swapCols);X.transform=function(){X.base.call(this);this._classname="transform";this._matrix=X.matrix.identity()};goog.inherits(X.transform,X.base);X.transform.prototype.__defineGetter__("matrix",function(){return this._matrix});X.transform.prototype.__defineSetter__("matrix",function(a){if(!goog.isDefAndNotNull(a)||!(a instanceof Float32Array))throw Error("Invalid matrix.");this._matrix=a;this.modified()});
X.transform.prototype.rotateX=function(a){if(!goog.isNumber(a)||-360>a||360<a)throw Error("Invalid angle.");X.matrix.rotateX(this._matrix,a*Math.PI/180);this.modified()};X.transform.prototype.rotateY=function(a){if(!goog.isNumber(a)||-360>a||360<a)throw Error("Invalid angle.");X.matrix.rotateY(this._matrix,a*Math.PI/180);this.modified()};X.transform.prototype.rotateZ=function(a){if(!goog.isNumber(a)||-360>a||360<a)throw Error("Invalid angle.");X.matrix.rotateZ(this._matrix,a*Math.PI/180);this.modified()};
X.transform.prototype.translateX=function(a){if(!goog.isNumber(a))throw Error("Invalid distance.");X.matrix.translate(this._matrix,a,0,0);this.modified()};X.transform.prototype.translateY=function(a){if(!goog.isNumber(a))throw Error("Invalid distance.");X.matrix.translate(this._matrix,0,a,0);this.modified()};X.transform.prototype.translateZ=function(a){if(!goog.isNumber(a))throw Error("Invalid distance.");X.matrix.translate(this._matrix,0,0,a);this.modified()};
X.transform.prototype.flip_=function(a,b){this._matrix[a+4*b]*=-1;this.modified()};X.transform.prototype.flipX=function(){this.flip_(0,0)};X.transform.prototype.flipY=function(){this.flip_(1,1)};X.transform.prototype.flipZ=function(){this.flip_(2,2)};X.transform.prototype.modified=function(){this._dirty=!0};goog.exportSymbol("X.transform",X.transform);goog.exportSymbol("X.transform.prototype.rotateX",X.transform.prototype.rotateX);goog.exportSymbol("X.transform.prototype.rotateY",X.transform.prototype.rotateY);
goog.exportSymbol("X.transform.prototype.rotateZ",X.transform.prototype.rotateZ);goog.exportSymbol("X.transform.prototype.translateX",X.transform.prototype.translateX);goog.exportSymbol("X.transform.prototype.translateY",X.transform.prototype.translateY);goog.exportSymbol("X.transform.prototype.translateZ",X.transform.prototype.translateZ);goog.exportSymbol("X.transform.prototype.flipX",X.transform.prototype.flipX);goog.exportSymbol("X.transform.prototype.flipY",X.transform.prototype.flipY);
goog.exportSymbol("X.transform.prototype.flipZ",X.transform.prototype.flipZ);goog.exportSymbol("X.transform.prototype.modified",X.transform.prototype.modified);X.texture=function(){X.base.call(this);this._classname="texture";this._rawData=this._image=this._file=null;this._rawDataHeight=this._rawDataWidth=0;this._grayscale=!1;inject(this,new X.loadable)};goog.inherits(X.texture,X.base);X.texture.prototype.__defineSetter__("rawData",function(a){this._rawData=a;this._dirty=!0});X.texture.prototype.__defineSetter__("rawDataHeight",function(a){this._rawDataHeight=a;this._dirty=!0});
X.texture.prototype.__defineSetter__("rawDataWidth",function(a){this._rawDataWidth=a;this._dirty=!0});X.texture.prototype.__defineSetter__("grayscale",function(a){this._grayscale=a;this._dirty=!0});goog.exportSymbol("X.texture",X.texture);X.triplets=function(a,b){X.base.call(this);this._classname="triplets";this._minA=Infinity;this._maxA=-Infinity;this._minB=Infinity;this._maxB=-Infinity;this._minC=Infinity;this._maxC=-Infinity;this._centroid=[0,0,0];this._fresh=!0;this._dataPointer=0;this._triplets=new Float32Array(a);goog.isDefAndNotNull(b)&&(this._triplets=b._triplets.subarray(0,b._triplets.length),this._dataPointer=this._triplets.length,this._minA=b._minA,this._maxA=b._maxA,this._minB=b._minB,this._maxB=b._maxB,this._minC=b._minC,
this._maxC=b._maxC,this._centroid=b._centroid.slice(),this._fresh=!1)};goog.inherits(X.triplets,X.base);
X.triplets.prototype.add=function(a,b,c){this._minA=Math.min(this._minA,a);this._maxA=Math.max(this._maxA,a);this._minB=Math.min(this._minB,b);this._maxB=Math.max(this._maxB,b);this._minC=Math.min(this._minC,c);this._maxC=Math.max(this._maxC,c);this._centroid=[(this._minA+this._maxA)/2,(this._minB+this._maxB)/2,(this._minC+this._maxC)/2];this._fresh=!1;this._dirty=!0;this._triplets[this._dataPointer++]=a;this._triplets[this._dataPointer++]=b;this._triplets[this._dataPointer++]=c;return this._dataPointer/
3};X.triplets.prototype.resize=function(){if(this._dataPointer!=this._triplets.length){var a=new Float32Array(this._dataPointer);a.set(this._triplets.subarray(0,this._dataPointer));this._triplets=a}};X.triplets.prototype.get=function(a){a*=3;return[this._triplets[a],this._triplets[a+1],this._triplets[a+2]]};X.triplets.prototype.remove=function(){throw Error("Not implemented.");};X.triplets.prototype.clear=function(){this._triplets=new Float32Array(this._triplets.length);this._dirty=!0};
X.triplets.prototype.__defineGetter__("count",function(){this.resize();return this._triplets.length/3});X.triplets.prototype.__defineGetter__("length",function(){this.resize();return this._triplets.length});goog.exportSymbol("X.triplets",X.triplets);goog.exportSymbol("X.triplets.prototype.add",X.triplets.prototype.add);goog.exportSymbol("X.triplets.prototype.resize",X.triplets.prototype.resize);goog.exportSymbol("X.triplets.prototype.get",X.triplets.prototype.get);
goog.exportSymbol("X.triplets.prototype.remove",X.triplets.prototype.remove);goog.exportSymbol("X.triplets.prototype.clear",X.triplets.prototype.clear);X.displayable=function(){this._type=X.displayable.types.TRIANGLES;this._transform=new X.transform;this._color=[1,1,1];this._textureCoordinateMap=this._texture=this._colors=this._normals=this._points=null;this._pointIndices=[];this._visible=!0;this._linewidth=this._pointsize=1;this._caption=null;this._magicmode=!1;this._opacity=1;this._distance=0;this._pickable=!0};X.displayable.types={TRIANGLES:"TRIANGLES",TRIANGLE_STRIPS:"TRIANGLE_STRIPS",LINES:"LINES",POINTS:"POINTS",POLYGONS:"POLYGONS"};
X.displayable.prototype.__defineSetter__("type",function(a){return this._type=a});X.displayable.prototype.__defineGetter__("type",function(){return this._type});X.displayable.prototype.__defineGetter__("texture",function(){this._texture||(this._texture=new X.texture);return this._texture});X.displayable.prototype.__defineGetter__("transform",function(){return this._transform});X.displayable.prototype.__defineGetter__("points",function(){return this._points});
X.displayable.prototype.__defineSetter__("points",function(a){this._points=a});X.displayable.prototype.__defineGetter__("normals",function(){return this._normals});X.displayable.prototype.__defineSetter__("normals",function(a){this._normals=a});X.displayable.prototype.__defineGetter__("colors",function(){return this._colors});X.displayable.prototype.__defineSetter__("colors",function(a){this._colors=a});X.displayable.prototype.__defineGetter__("color",function(){return this._color});
X.displayable.prototype.__defineSetter__("color",function(a){if(!goog.isDefAndNotNull(a)||!goog.isArray(a)||3!=a.length)throw Error("Invalid color.");for(var b=this._children,c=b.length,d=0,d=0;d<c;d++)b[d].color=a;this._color=a;this._dirty=!0});X.displayable.prototype.__defineGetter__("opacity",function(){return this._opacity});
X.displayable.prototype.__defineSetter__("opacity",function(a){if(!goog.isNumber(a)||1<a||0>a)throw Error("Invalid opacity.");for(var b=this._children,c=b.length,d=0,d=0;d<c;d++)goog.isDefAndNotNull(b[d])&&(b[d].opacity=a);this._opacity=a;this._dirty=!0});X.displayable.prototype.__defineGetter__("caption",function(){return this._caption});X.displayable.prototype.__defineSetter__("caption",function(a){this._caption=a;this._dirty=!0});X.displayable.prototype.__defineGetter__("visible",function(){return this._visible});
X.displayable.prototype.__defineSetter__("visible",function(a){for(var b=this._children,c=b.length,d=0,d=0;d<c;d++)goog.isDefAndNotNull(b[d])&&(b[d].visible=a);this._visible=a;this._dirty=!0});X.displayable.prototype.__defineGetter__("pointsize",function(){return this._pointsize});X.displayable.prototype.__defineSetter__("pointsize",function(a){if(!goog.isNumber(a))throw Error("Invalid point size.");this._pointsize=a;this._dirty=!0});X.displayable.prototype.__defineGetter__("magicmode",function(){return this._magicmode});
X.displayable.prototype.__defineSetter__("magicmode",function(a){if(!goog.isBoolean(a))throw Error("Invalid magic mode setting.");this._magicmode=a;this._dirty=!0});X.displayable.prototype.__defineGetter__("linewidth",function(){return this._linewidth});X.displayable.prototype.__defineSetter__("linewidth",function(a){if(!goog.isNumber(a))throw Error("Invalid line width.");this._linewidth=a;this._dirty=!0});X.displayable.prototype.__defineGetter__("pickable",function(){return this._pickable});
X.displayable.prototype.__defineSetter__("pickable",function(a){if(!goog.isBoolean(a))throw Error("Invalid pickable setting.");this._pickable=a;this._dirty=!0});X.displayable.prototype.__defineGetter__("textureCoordinateMap",function(){return this._textureCoordinateMap});X.displayable.prototype.__defineSetter__("textureCoordinateMap",function(a){this._textureCoordinate=a});X.thresholdable=function(){this._min=Infinity;this._lowerThreshold=this._max=-Infinity;this._upperThreshold=Infinity;this._minColor=[0,0,0];this._maxColor=[1,1,1]};X.thresholdable.prototype.__defineGetter__("lowerThreshold",function(){return this._lowerThreshold});X.thresholdable.prototype.__defineSetter__("lowerThreshold",function(a){this._lowerThreshold=a});X.thresholdable.prototype.__defineGetter__("upperThreshold",function(){return this._upperThreshold});
X.thresholdable.prototype.__defineSetter__("upperThreshold",function(a){this._upperThreshold=a});X.thresholdable.prototype.__defineGetter__("min",function(){return this._min});X.thresholdable.prototype.__defineGetter__("max",function(){return this._max});X.thresholdable.prototype.__defineGetter__("minColor",function(){return this._minColor});
X.thresholdable.prototype.__defineSetter__("minColor",function(a){if(!goog.isDefAndNotNull(a)||!goog.isArray(a)||3!=a.length)throw Error("Invalid min. color.");this._minColor=a});X.thresholdable.prototype.__defineGetter__("maxColor",function(){return this._maxColor});X.thresholdable.prototype.__defineSetter__("maxColor",function(a){if(!goog.isDefAndNotNull(a)||!goog.isArray(a)||3!=a.length)throw Error("Invalid max. color.");this._maxColor=a});X.scalars=function(){X.base.call(this);this._classname="scalars";this._glArray=this._array=null;this._replaceMode=!0;this._interpolation=0;inject(this,new X.loadable);inject(this,new X.thresholdable);this._minColor=[0,1,0];this._maxColor=[1,0,0]};goog.inherits(X.scalars,X.base);X.scalars.prototype.__defineGetter__("array",function(){return this._array});X.scalars.prototype.__defineSetter__("array",function(a){this._glArray=this._array=a;this._dirty=!0});
X.scalars.prototype.__defineGetter__("interpolation",function(){return this._interpolation});X.scalars.prototype.__defineSetter__("interpolation",function(a){this._interpolation=a});goog.exportSymbol("X.scalars",X.scalars);X.object=function(a){X.base.call(this);this._classname="object";this._children=[];this._scalars=this._colortable=null;inject(this,new X.displayable);goog.isDefAndNotNull(a)&&this.copy_(a)};goog.inherits(X.object,X.base);
X.object.prototype.copy_=function(a){this._type=a._type;this._transform=new X.transform;this._transform._matrix=new Float32Array(a._transform._matrix);this._color=a._color.slice();a._points&&(this._points=new X.triplets(a._points.length,a._points));a._normals&&(this._normals=new X.triplets(a._normals.length,a._normals));a._colors&&(this._colors=new X.triplets(a._colors.length,a._colors));this._texture=a._texture;this._textureCoordinateMap=a._textureCoordinateMap;a._file&&(this._file=new X.file((new String(a._file._path)).toString()));
this._opacity=a._opacity;this._children.length=0;var b=a._children;if(b)for(var c=b.length,d=0,d=0;d<c;d++)this._children.push(new X[b[d]._classname](b[d]));this._visible=a._visible;this._pointsize=a._pointsize;this._linewidth=a._linewidth;a._caption&&(this._caption=(new String(a._caption)).toString());this._magicmode=a._magicmode;this._pickable=a._pickable;this._pointIndices=a._pointIndices.slice();this._dirty=!0};
X.object.prototype.__defineGetter__("colortable",function(){this._colortable||(this._colortable=new X.colortable);return this._colortable});X.object.prototype.__defineGetter__("scalars",function(){this._scalars||(this._scalars=new X.scalars);return this._scalars});X.object.prototype.__defineGetter__("children",function(){return this._children});X.object.prototype.modified=function(){var a=new X.event.ModifiedEvent;a._object=this;this.dispatchEvent(a)};
X.object.prototype.remove=function(){var a=new X.event.RemoveEvent;a._object=this;this.dispatchEvent(a)};X.object.prototype.destroy=function(){goog.events.removeAll(this);if(0<this._children.length)for(var a=this._children,b=a.length,c=0,c=0;c<b;c++)"undefined"!=typeof a[c]&&this._children[c].destroy();this._children.length=0;this._scalars=this._colortable=null};
X.object.OPACITY_COMPARATOR=function(a,b){if(!goog.isDefAndNotNull(a)||!goog.isDefAndNotNull(b)||!(a instanceof X.object)||!(b instanceof X.object))throw Error("Fatal: Two valid X.objects are required for comparison.");return 1==a._opacity?-1:1==b._opacity?1:goog.isDefAndNotNull(a._distance)&&goog.isDefAndNotNull(b._distance)&&a._distance>b._distance?-1:1};goog.exportSymbol("X.object",X.object);goog.exportSymbol("X.object.prototype.modified",X.object.prototype.modified);
goog.exportSymbol("X.object.prototype.remove",X.object.prototype.remove);goog.exportSymbol("X.object.prototype.destroy",X.object.prototype.destroy);X.constructable=function(){};X.constructable.prototype.toCSG=function(){for(var a=this._points.count,b=[],c=0,c=0;c<a;c+=3){var d=this._points.get(c),e=this._points.get(c+1),f=this._points.get(c+2),g=this._normals.get(c),h=this._normals.get(c+1),k=this._normals.get(c+2),j=this._color;this._colors&&0<this._colors.length&&(j=this._colors.get(c));var m=[];m.push(new csgVertex(d,g));m.push(new csgVertex(e,h));m.push(new csgVertex(f,k));b.push(new csgPolygon(m,j))}return CSG.fromPolygons(b)};
X.constructable.prototype.fromCSG=function(a){if(!goog.isDefAndNotNull(a)||!(a instanceof CSG))throw Error("Invalid CSG object.");var b=new X.indexer,c=[];a=a.toPolygons();goog.array.map(a,function(a){var e=[],e=a.vertices(),f=a.shared(),e=goog.array.map(e,function(a){a.color=f;return b.add(a)});for(a=a=2;a<e.length;a++)c.push([e[0],e[a-1],e[a]])}.bind(this));this.__vertices=goog.array.map(b.unique(),function(a){return[a.pos().x(),a.pos().y(),a.pos().z()]});this.__normals=goog.array.map(b.unique(),
function(a){return[a.normal().x(),a.normal().y(),a.normal().z()]});this.__colors=goog.array.map(b.unique(),function(a){return!a.color?null:[a.color[0],a.color[1],a.color[2]]});this._points=new X.triplets(9*c.length);this._normals=new X.triplets(9*c.length);this._colors=new X.triplets(9*c.length);goog.array.map(c,function(a){var b=a[0],c=a[1];a=a[2];var g=this.__vertices,h=this.__normals,k=this.__colors;this._points.add(g[b][0],g[b][1],g[b][2]);this._points.add(g[c][0],g[c][1],g[c][2]);this._points.add(g[a][0],
g[a][1],g[a][2]);this._normals.add(h[b][0],h[b][1],h[b][2]);this._normals.add(h[c][0],h[c][1],h[c][2]);this._normals.add(h[a][0],h[a][1],h[a][2]);k[b]&&this._colors.add(k[b][0],k[b][1],k[b][2]);k[c]&&this._colors.add(k[c][0],k[c][1],k[c][2]);k[a]&&this._colors.add(k[a][0],k[a][1],k[a][2])}.bind(this));0==this._colors._dataPointer&&(this._colors=null);this._type=X.displayable.types.TRIANGLES};
X.constructable.prototype.union=function(a){if(!goog.isDefAndNotNull(a)||!(a instanceof CSG)&&!(a instanceof X.object))throw Error("Invalid object.");var b=a;a instanceof X.object&&(b=b.toCSG());a=new X.object;inject(a,new X.constructable);a.fromCSG(this.toCSG().union(b));return a};
X.constructable.prototype.subtract=function(a){if(!goog.isDefAndNotNull(a)||!(a instanceof CSG)&&!(a instanceof X.object))throw Error("Invalid object.");var b=a;a instanceof X.object&&(b=b.toCSG());a=new X.object;inject(a,new X.constructable);a.fromCSG(this.toCSG().subtract(b));return a};
X.constructable.prototype.intersect=function(a){if(!goog.isDefAndNotNull(a)||!(a instanceof CSG)&&!(a instanceof X.object))throw Error("Invalid object.");var b=a;a instanceof X.object&&(b=b.toCSG());a=new X.object;inject(a,new X.constructable);a.fromCSG(this.toCSG().intersect(b));return a};X.constructable.prototype.inverse=function(){var a=new X.object;inject(a,new X.constructable);a.fromCSG(this.toCSG().inverse());return a};goog.exportSymbol("X.constructable",X.constructable);
goog.exportSymbol("X.constructable.prototype.intersect",X.constructable.prototype.intersect);goog.exportSymbol("X.constructable.prototype.inverse",X.constructable.prototype.inverse);goog.exportSymbol("X.constructable.prototype.subtract",X.constructable.prototype.subtract);goog.exportSymbol("X.constructable.prototype.union",X.constructable.prototype.union);X.event=function(a){goog.events.Event.call(this,a);this._classname="event"};goog.inherits(X.event,goog.events.Event);X.event.uniqueId=function(a){return goog.events.getUniqueId(a)};
X.event.events={PAN:X.event.uniqueId("pan"),ROTATE:X.event.uniqueId("rotate"),ZOOM:X.event.uniqueId("zoom"),SCROLL:X.event.uniqueId("scroll"),RENDER:X.event.uniqueId("render"),RESETVIEW:X.event.uniqueId("resetview"),WINDOWLEVEL:X.event.uniqueId("windowlevel"),MODIFIED:X.event.uniqueId("modified"),REMOVE:X.event.uniqueId("remove"),PROGRESS:X.event.uniqueId("progress"),HOVER:X.event.uniqueId("hover"),HOVER_END:X.event.uniqueId("hover_end"),COMPUTING:X.event.uniqueId("computing"),COMPUTING_END:X.event.uniqueId("computing_end"),
COMPUTING_PROGRESS:X.event.uniqueId("computing_progress")};X.event.WindowLevelEvent=function(){X.event.call(this,X.event.events.WINDOWLEVEL);this._level=this._window=0};goog.inherits(X.event.WindowLevelEvent,X.event);X.event.PanEvent=function(){X.event.call(this,X.event.events.PAN);this._distance=new X.vector(0,0,0)};goog.inherits(X.event.PanEvent,X.event);X.event.RotateEvent=function(){X.event.call(this,X.event.events.ROTATE);this._distance=new X.vector(0,0,0)};
goog.inherits(X.event.RotateEvent,X.event);X.event.ZoomEvent=function(){X.event.call(this,X.event.events.ZOOM);this._fast=this._in=!1};goog.inherits(X.event.ZoomEvent,X.event);X.event.ScrollEvent=function(){X.event.call(this,X.event.events.SCROLL);this._up=!1};goog.inherits(X.event.ScrollEvent,X.event);X.event.RenderEvent=function(){X.event.call(this,X.event.events.RENDER)};goog.inherits(X.event.RenderEvent,X.event);
X.event.HoverEvent=function(){X.event.call(this,X.event.events.HOVER);this._y=this._x=0};goog.inherits(X.event.HoverEvent,X.event);X.event.HoverEndEvent=function(){X.event.call(this,X.event.events.HOVER_END)};goog.inherits(X.event.HoverEndEvent,X.event);X.event.ResetViewEvent=function(){X.event.call(this,X.event.events.RESETVIEW)};goog.inherits(X.event.ResetViewEvent,X.event);X.event.ModifiedEvent=function(){X.event.call(this,X.event.events.MODIFIED);this._container=this._object=null};
goog.inherits(X.event.ModifiedEvent,X.event);X.event.RemoveEvent=function(){X.event.call(this,X.event.events.REMOVE);this._container=this._object=null};goog.inherits(X.event.RemoveEvent,X.event);X.event.ProgressEvent=function(){X.event.call(this,X.event.events.PROGRESS);this._value=0};goog.inherits(X.event.ProgressEvent,X.event);X.event.ComputingEvent=function(){X.event.call(this,X.event.events.COMPUTING);this._object=null};goog.inherits(X.event.ComputingEvent,X.event);
X.event.ComputingProgressEvent=function(){X.event.call(this,X.event.events.COMPUTING_PROGRESS);this._value=0};goog.inherits(X.event.ComputingProgressEvent,X.event);X.event.ComputingEndEvent=function(){X.event.call(this,X.event.events.COMPUTING_END);this._object=null};goog.inherits(X.event.ComputingEndEvent,X.event);goog.exportSymbol("X.event.events.PAN",X.event.events.PAN);goog.exportSymbol("X.event.events.ROTATE",X.event.events.ROTATE);goog.exportSymbol("X.event.events.ZOOM",X.event.events.ZOOM);
goog.exportSymbol("X.event.events.SCROLL",X.event.events.SCROLL);X.buffer=function(a,b,c){if(!goog.isDefAndNotNull(a))throw Error("Invalid GL Buffer.");if(!goog.isDefAndNotNull(b))throw Error("Invalid number of items.");if(!goog.isDefAndNotNull(c))throw Error("Invalid item size.");X.base.call(this);this._classname="buffer";this._glBuffer=a;this._itemCount=b;this._itemSize=c};goog.inherits(X.buffer,X.base);goog.dom={};goog.dom.classes={};goog.dom.classes.set=function(a,b){a.className=b};goog.dom.classes.get=function(a){a=a.className;return goog.isString(a)&&a.match(/\S+/g)||[]};goog.dom.classes.add=function(a,b){var c=goog.dom.classes.get(a),d=goog.array.slice(arguments,1),e=c.length+d.length;goog.dom.classes.add_(c,d);goog.dom.classes.set(a,c.join(" "));return c.length==e};
goog.dom.classes.remove=function(a,b){var c=goog.dom.classes.get(a),d=goog.array.slice(arguments,1),e=goog.dom.classes.getDifference_(c,d);goog.dom.classes.set(a,e.join(" "));return e.length==c.length-d.length};goog.dom.classes.add_=function(a,b){for(var c=0;c<b.length;c++)goog.array.contains(a,b[c])||a.push(b[c])};goog.dom.classes.getDifference_=function(a,b){return goog.array.filter(a,function(a){return!goog.array.contains(b,a)})};
goog.dom.classes.swap=function(a,b,c){for(var d=goog.dom.classes.get(a),e=!1,f=0;f<d.length;f++)d[f]==b&&(goog.array.splice(d,f--,1),e=!0);e&&(d.push(c),goog.dom.classes.set(a,d.join(" ")));return e};goog.dom.classes.addRemove=function(a,b,c){var d=goog.dom.classes.get(a);goog.isString(b)?goog.array.remove(d,b):goog.isArray(b)&&(d=goog.dom.classes.getDifference_(d,b));goog.isString(c)&&!goog.array.contains(d,c)?d.push(c):goog.isArray(c)&&goog.dom.classes.add_(d,c);goog.dom.classes.set(a,d.join(" "))};
goog.dom.classes.has=function(a,b){return goog.array.contains(goog.dom.classes.get(a),b)};goog.dom.classes.enable=function(a,b,c){c?goog.dom.classes.add(a,b):goog.dom.classes.remove(a,b)};goog.dom.classes.toggle=function(a,b){var c=!goog.dom.classes.has(a,b);goog.dom.classes.enable(a,b,c);return c};goog.dom.TagName={A:"A",ABBR:"ABBR",ACRONYM:"ACRONYM",ADDRESS:"ADDRESS",APPLET:"APPLET",AREA:"AREA",ARTICLE:"ARTICLE",ASIDE:"ASIDE",AUDIO:"AUDIO",B:"B",BASE:"BASE",BASEFONT:"BASEFONT",BDI:"BDI",BDO:"BDO",BIG:"BIG",BLOCKQUOTE:"BLOCKQUOTE",BODY:"BODY",BR:"BR",BUTTON:"BUTTON",CANVAS:"CANVAS",CAPTION:"CAPTION",CENTER:"CENTER",CITE:"CITE",CODE:"CODE",COL:"COL",COLGROUP:"COLGROUP",COMMAND:"COMMAND",DATA:"DATA",DATALIST:"DATALIST",DD:"DD",DEL:"DEL",DETAILS:"DETAILS",DFN:"DFN",DIALOG:"DIALOG",DIR:"DIR",DIV:"DIV",
DL:"DL",DT:"DT",EM:"EM",EMBED:"EMBED",FIELDSET:"FIELDSET",FIGCAPTION:"FIGCAPTION",FIGURE:"FIGURE",FONT:"FONT",FOOTER:"FOOTER",FORM:"FORM",FRAME:"FRAME",FRAMESET:"FRAMESET",H1:"H1",H2:"H2",H3:"H3",H4:"H4",H5:"H5",H6:"H6",HEAD:"HEAD",HEADER:"HEADER",HGROUP:"HGROUP",HR:"HR",HTML:"HTML",I:"I",IFRAME:"IFRAME",IMG:"IMG",INPUT:"INPUT",INS:"INS",ISINDEX:"ISINDEX",KBD:"KBD",KEYGEN:"KEYGEN",LABEL:"LABEL",LEGEND:"LEGEND",LI:"LI",LINK:"LINK",MAP:"MAP",MARK:"MARK",MATH:"MATH",MENU:"MENU",META:"META",METER:"METER",
NAV:"NAV",NOFRAMES:"NOFRAMES",NOSCRIPT:"NOSCRIPT",OBJECT:"OBJECT",OL:"OL",OPTGROUP:"OPTGROUP",OPTION:"OPTION",OUTPUT:"OUTPUT",P:"P",PARAM:"PARAM",PRE:"PRE",PROGRESS:"PROGRESS",Q:"Q",RP:"RP",RT:"RT",RUBY:"RUBY",S:"S",SAMP:"SAMP",SCRIPT:"SCRIPT",SECTION:"SECTION",SELECT:"SELECT",SMALL:"SMALL",SOURCE:"SOURCE",SPAN:"SPAN",STRIKE:"STRIKE",STRONG:"STRONG",STYLE:"STYLE",SUB:"SUB",SUMMARY:"SUMMARY",SUP:"SUP",SVG:"SVG",TABLE:"TABLE",TBODY:"TBODY",TD:"TD",TEXTAREA:"TEXTAREA",TFOOT:"TFOOT",TH:"TH",THEAD:"THEAD",
TIME:"TIME",TITLE:"TITLE",TR:"TR",TRACK:"TRACK",TT:"TT",U:"U",UL:"UL",VAR:"VAR",VIDEO:"VIDEO",WBR:"WBR"};goog.math.Size=function(a,b){this.width=a;this.height=b};goog.math.Size.equals=function(a,b){return a==b?!0:!a||!b?!1:a.width==b.width&&a.height==b.height};goog.math.Size.prototype.clone=function(){return new goog.math.Size(this.width,this.height)};goog.DEBUG&&(goog.math.Size.prototype.toString=function(){return"("+this.width+" x "+this.height+")"});goog.math.Size.prototype.getLongest=function(){return Math.max(this.width,this.height)};
goog.math.Size.prototype.getShortest=function(){return Math.min(this.width,this.height)};goog.math.Size.prototype.area=function(){return this.width*this.height};goog.math.Size.prototype.perimeter=function(){return 2*(this.width+this.height)};goog.math.Size.prototype.aspectRatio=function(){return this.width/this.height};goog.math.Size.prototype.isEmpty=function(){return!this.area()};goog.math.Size.prototype.ceil=function(){this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};
goog.math.Size.prototype.fitsInside=function(a){return this.width<=a.width&&this.height<=a.height};goog.math.Size.prototype.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};goog.math.Size.prototype.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};goog.math.Size.prototype.scale=function(a,b){var c=goog.isNumber(b)?b:a;this.width*=a;this.height*=c;return this};
goog.math.Size.prototype.scaleToFit=function(a){a=this.aspectRatio()>a.aspectRatio()?a.width/this.width:a.height/this.height;return this.scale(a)};goog.dom.BrowserFeature={CAN_ADD_NAME_OR_TYPE_ATTRIBUTES:!goog.userAgent.IE||goog.userAgent.isDocumentMode(9),CAN_USE_CHILDREN_ATTRIBUTE:!goog.userAgent.GECKO&&!goog.userAgent.IE||goog.userAgent.IE&&goog.userAgent.isDocumentMode(9)||goog.userAgent.GECKO&&goog.userAgent.isVersionOrHigher("1.9.1"),CAN_USE_INNER_TEXT:goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("9"),CAN_USE_PARENT_ELEMENT_PROPERTY:goog.userAgent.IE||goog.userAgent.OPERA||goog.userAgent.WEBKIT,INNER_HTML_NEEDS_SCOPED_ELEMENT:goog.userAgent.IE};goog.math.Coordinate=function(a,b){this.x=goog.isDef(a)?a:0;this.y=goog.isDef(b)?b:0};goog.math.Coordinate.prototype.clone=function(){return new goog.math.Coordinate(this.x,this.y)};goog.DEBUG&&(goog.math.Coordinate.prototype.toString=function(){return"("+this.x+", "+this.y+")"});goog.math.Coordinate.equals=function(a,b){return a==b?!0:!a||!b?!1:a.x==b.x&&a.y==b.y};goog.math.Coordinate.distance=function(a,b){var c=a.x-b.x,d=a.y-b.y;return Math.sqrt(c*c+d*d)};
goog.math.Coordinate.magnitude=function(a){return Math.sqrt(a.x*a.x+a.y*a.y)};goog.math.Coordinate.azimuth=function(a){return goog.math.angle(0,0,a.x,a.y)};goog.math.Coordinate.squaredDistance=function(a,b){var c=a.x-b.x,d=a.y-b.y;return c*c+d*d};goog.math.Coordinate.difference=function(a,b){return new goog.math.Coordinate(a.x-b.x,a.y-b.y)};goog.math.Coordinate.sum=function(a,b){return new goog.math.Coordinate(a.x+b.x,a.y+b.y)};
goog.math.Coordinate.prototype.ceil=function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this};goog.math.Coordinate.prototype.floor=function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this};goog.math.Coordinate.prototype.round=function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this};goog.math.Coordinate.prototype.translate=function(a,b){a instanceof goog.math.Coordinate?(this.x+=a.x,this.y+=a.y):(this.x+=a,goog.isNumber(b)&&(this.y+=b));return this};
goog.math.Coordinate.prototype.scale=function(a,b){var c=goog.isNumber(b)?b:a;this.x*=a;this.y*=c;return this};goog.dom.ASSUME_QUIRKS_MODE=!1;goog.dom.ASSUME_STANDARDS_MODE=!1;goog.dom.COMPAT_MODE_KNOWN_=goog.dom.ASSUME_QUIRKS_MODE||goog.dom.ASSUME_STANDARDS_MODE;goog.dom.NodeType={ELEMENT:1,ATTRIBUTE:2,TEXT:3,CDATA_SECTION:4,ENTITY_REFERENCE:5,ENTITY:6,PROCESSING_INSTRUCTION:7,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,NOTATION:12};goog.dom.getDomHelper=function(a){return a?new goog.dom.DomHelper(goog.dom.getOwnerDocument(a)):goog.dom.defaultDomHelper_||(goog.dom.defaultDomHelper_=new goog.dom.DomHelper)};
goog.dom.getDocument=function(){return document};goog.dom.getElement=function(a){return goog.isString(a)?document.getElementById(a):a};goog.dom.$=goog.dom.getElement;goog.dom.getElementsByTagNameAndClass=function(a,b,c){return goog.dom.getElementsByTagNameAndClass_(document,a,b,c)};
goog.dom.getElementsByClass=function(a,b){var c=b||document;return goog.dom.canUseQuerySelector_(c)?c.querySelectorAll("."+a):c.getElementsByClassName?c.getElementsByClassName(a):goog.dom.getElementsByTagNameAndClass_(document,"*",a,b)};goog.dom.getElementByClass=function(a,b){var c=b||document,d=null;return(d=goog.dom.canUseQuerySelector_(c)?c.querySelector("."+a):goog.dom.getElementsByClass(a,b)[0])||null};goog.dom.canUseQuerySelector_=function(a){return!(!a.querySelectorAll||!a.querySelector)};
goog.dom.getElementsByTagNameAndClass_=function(a,b,c,d){a=d||a;b=b&&"*"!=b?b.toUpperCase():"";if(goog.dom.canUseQuerySelector_(a)&&(b||c))return a.querySelectorAll(b+(c?"."+c:""));if(c&&a.getElementsByClassName){a=a.getElementsByClassName(c);if(b){d={};for(var e=0,f=0,g;g=a[f];f++)b==g.nodeName&&(d[e++]=g);d.length=e;return d}return a}a=a.getElementsByTagName(b||"*");if(c){d={};for(f=e=0;g=a[f];f++)b=g.className,"function"==typeof b.split&&goog.array.contains(b.split(/\s+/),c)&&(d[e++]=g);d.length=
e;return d}return a};goog.dom.$$=goog.dom.getElementsByTagNameAndClass;goog.dom.setProperties=function(a,b){goog.object.forEach(b,function(b,d){"style"==d?a.style.cssText=b:"class"==d?a.className=b:"for"==d?a.htmlFor=b:d in goog.dom.DIRECT_ATTRIBUTE_MAP_?a.setAttribute(goog.dom.DIRECT_ATTRIBUTE_MAP_[d],b):goog.string.startsWith(d,"aria-")||goog.string.startsWith(d,"data-")?a.setAttribute(d,b):a[d]=b})};
goog.dom.DIRECT_ATTRIBUTE_MAP_={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};goog.dom.getViewportSize=function(a){return goog.dom.getViewportSize_(a||window)};goog.dom.getViewportSize_=function(a){a=a.document;a=goog.dom.isCss1CompatMode_(a)?a.documentElement:a.body;return new goog.math.Size(a.clientWidth,a.clientHeight)};
goog.dom.getDocumentHeight=function(){return goog.dom.getDocumentHeight_(window)};goog.dom.getDocumentHeight_=function(a){var b=a.document,c=0;if(b){a=goog.dom.getViewportSize_(a).height;var c=b.body,d=b.documentElement;if(goog.dom.isCss1CompatMode_(b)&&d.scrollHeight)c=d.scrollHeight!=a?d.scrollHeight:d.offsetHeight;else{var b=d.scrollHeight,e=d.offsetHeight;d.clientHeight!=e&&(b=c.scrollHeight,e=c.offsetHeight);c=b>a?b>e?b:e:b<e?b:e}}return c};
goog.dom.getPageScroll=function(a){return goog.dom.getDomHelper((a||goog.global||window).document).getDocumentScroll()};goog.dom.getDocumentScroll=function(){return goog.dom.getDocumentScroll_(document)};
goog.dom.getDocumentScroll_=function(a){var b=goog.dom.getDocumentScrollElement_(a);a=goog.dom.getWindow_(a);return goog.userAgent.IE&&goog.userAgent.isVersionOrHigher("10")&&a.pageYOffset!=b.scrollTop?new goog.math.Coordinate(b.scrollLeft,b.scrollTop):new goog.math.Coordinate(a.pageXOffset||b.scrollLeft,a.pageYOffset||b.scrollTop)};goog.dom.getDocumentScrollElement=function(){return goog.dom.getDocumentScrollElement_(document)};
goog.dom.getDocumentScrollElement_=function(a){return!goog.userAgent.WEBKIT&&goog.dom.isCss1CompatMode_(a)?a.documentElement:a.body};goog.dom.getWindow=function(a){return a?goog.dom.getWindow_(a):window};goog.dom.getWindow_=function(a){return a.parentWindow||a.defaultView};goog.dom.createDom=function(a,b,c){return goog.dom.createDom_(document,arguments)};
goog.dom.createDom_=function(a,b){var c=b[0],d=b[1];if(!goog.dom.BrowserFeature.CAN_ADD_NAME_OR_TYPE_ATTRIBUTES&&d&&(d.name||d.type)){c=["<",c];d.name&&c.push(' name="',goog.string.htmlEscape(d.name),'"');if(d.type){c.push(' type="',goog.string.htmlEscape(d.type),'"');var e={};goog.object.extend(e,d);delete e.type;d=e}c.push(">");c=c.join("")}c=a.createElement(c);d&&(goog.isString(d)?c.className=d:goog.isArray(d)?goog.dom.classes.add.apply(null,[c].concat(d)):goog.dom.setProperties(c,d));2<b.length&&
goog.dom.append_(a,c,b,2);return c};goog.dom.append_=function(a,b,c,d){function e(c){c&&b.appendChild(goog.isString(c)?a.createTextNode(c):c)}for(;d<c.length;d++){var f=c[d];goog.isArrayLike(f)&&!goog.dom.isNodeLike(f)?goog.array.forEach(goog.dom.isNodeList(f)?goog.array.toArray(f):f,e):e(f)}};goog.dom.$dom=goog.dom.createDom;goog.dom.createElement=function(a){return document.createElement(a)};goog.dom.createTextNode=function(a){return document.createTextNode(String(a))};
goog.dom.createTable=function(a,b,c){return goog.dom.createTable_(document,a,b,!!c)};goog.dom.createTable_=function(a,b,c,d){for(var e=["<tr>"],f=0;f<c;f++)e.push(d?"<td>&nbsp;</td>":"<td></td>");e.push("</tr>");e=e.join("");c=["<table>"];for(f=0;f<b;f++)c.push(e);c.push("</table>");a=a.createElement(goog.dom.TagName.DIV);a.innerHTML=c.join("");return a.removeChild(a.firstChild)};goog.dom.htmlToDocumentFragment=function(a){return goog.dom.htmlToDocumentFragment_(document,a)};
goog.dom.htmlToDocumentFragment_=function(a,b){var c=a.createElement("div");goog.dom.BrowserFeature.INNER_HTML_NEEDS_SCOPED_ELEMENT?(c.innerHTML="<br>"+b,c.removeChild(c.firstChild)):c.innerHTML=b;if(1==c.childNodes.length)return c.removeChild(c.firstChild);for(var d=a.createDocumentFragment();c.firstChild;)d.appendChild(c.firstChild);return d};goog.dom.getCompatMode=function(){return goog.dom.isCss1CompatMode()?"CSS1Compat":"BackCompat"};goog.dom.isCss1CompatMode=function(){return goog.dom.isCss1CompatMode_(document)};
goog.dom.isCss1CompatMode_=function(a){return goog.dom.COMPAT_MODE_KNOWN_?goog.dom.ASSUME_STANDARDS_MODE:"CSS1Compat"==a.compatMode};goog.dom.canHaveChildren=function(a){if(a.nodeType!=goog.dom.NodeType.ELEMENT)return!1;switch(a.tagName){case goog.dom.TagName.APPLET:case goog.dom.TagName.AREA:case goog.dom.TagName.BASE:case goog.dom.TagName.BR:case goog.dom.TagName.COL:case goog.dom.TagName.COMMAND:case goog.dom.TagName.EMBED:case goog.dom.TagName.FRAME:case goog.dom.TagName.HR:case goog.dom.TagName.IMG:case goog.dom.TagName.INPUT:case goog.dom.TagName.IFRAME:case goog.dom.TagName.ISINDEX:case goog.dom.TagName.KEYGEN:case goog.dom.TagName.LINK:case goog.dom.TagName.NOFRAMES:case goog.dom.TagName.NOSCRIPT:case goog.dom.TagName.META:case goog.dom.TagName.OBJECT:case goog.dom.TagName.PARAM:case goog.dom.TagName.SCRIPT:case goog.dom.TagName.SOURCE:case goog.dom.TagName.STYLE:case goog.dom.TagName.TRACK:case goog.dom.TagName.WBR:return!1}return!0};
goog.dom.appendChild=function(a,b){a.appendChild(b)};goog.dom.append=function(a,b){goog.dom.append_(goog.dom.getOwnerDocument(a),a,arguments,1)};goog.dom.removeChildren=function(a){for(var b;b=a.firstChild;)a.removeChild(b)};goog.dom.insertSiblingBefore=function(a,b){b.parentNode&&b.parentNode.insertBefore(a,b)};goog.dom.insertSiblingAfter=function(a,b){b.parentNode&&b.parentNode.insertBefore(a,b.nextSibling)};goog.dom.insertChildAt=function(a,b,c){a.insertBefore(b,a.childNodes[c]||null)};
goog.dom.removeNode=function(a){return a&&a.parentNode?a.parentNode.removeChild(a):null};goog.dom.replaceNode=function(a,b){var c=b.parentNode;c&&c.replaceChild(a,b)};goog.dom.flattenElement=function(a){var b,c=a.parentNode;if(c&&c.nodeType!=goog.dom.NodeType.DOCUMENT_FRAGMENT){if(a.removeNode)return a.removeNode(!1);for(;b=a.firstChild;)c.insertBefore(b,a);return goog.dom.removeNode(a)}};
goog.dom.getChildren=function(a){return goog.dom.BrowserFeature.CAN_USE_CHILDREN_ATTRIBUTE&&void 0!=a.children?a.children:goog.array.filter(a.childNodes,function(a){return a.nodeType==goog.dom.NodeType.ELEMENT})};goog.dom.getFirstElementChild=function(a){return void 0!=a.firstElementChild?a.firstElementChild:goog.dom.getNextElementNode_(a.firstChild,!0)};goog.dom.getLastElementChild=function(a){return void 0!=a.lastElementChild?a.lastElementChild:goog.dom.getNextElementNode_(a.lastChild,!1)};
goog.dom.getNextElementSibling=function(a){return void 0!=a.nextElementSibling?a.nextElementSibling:goog.dom.getNextElementNode_(a.nextSibling,!0)};goog.dom.getPreviousElementSibling=function(a){return void 0!=a.previousElementSibling?a.previousElementSibling:goog.dom.getNextElementNode_(a.previousSibling,!1)};goog.dom.getNextElementNode_=function(a,b){for(;a&&a.nodeType!=goog.dom.NodeType.ELEMENT;)a=b?a.nextSibling:a.previousSibling;return a};
goog.dom.getNextNode=function(a){if(!a)return null;if(a.firstChild)return a.firstChild;for(;a&&!a.nextSibling;)a=a.parentNode;return a?a.nextSibling:null};goog.dom.getPreviousNode=function(a){if(!a)return null;if(!a.previousSibling)return a.parentNode;for(a=a.previousSibling;a&&a.lastChild;)a=a.lastChild;return a};goog.dom.isNodeLike=function(a){return goog.isObject(a)&&0<a.nodeType};goog.dom.isElement=function(a){return goog.isObject(a)&&a.nodeType==goog.dom.NodeType.ELEMENT};
goog.dom.isWindow=function(a){return goog.isObject(a)&&a.window==a};goog.dom.getParentElement=function(a){if(goog.dom.BrowserFeature.CAN_USE_PARENT_ELEMENT_PROPERTY)return a.parentElement;a=a.parentNode;return goog.dom.isElement(a)?a:null};goog.dom.contains=function(a,b){if(a.contains&&b.nodeType==goog.dom.NodeType.ELEMENT)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a};
goog.dom.compareNodeOrder=function(a,b){if(a==b)return 0;if(a.compareDocumentPosition)return a.compareDocumentPosition(b)&2?1:-1;if(goog.userAgent.IE&&!goog.userAgent.isDocumentMode(9)){if(a.nodeType==goog.dom.NodeType.DOCUMENT)return-1;if(b.nodeType==goog.dom.NodeType.DOCUMENT)return 1}if("sourceIndex"in a||a.parentNode&&"sourceIndex"in a.parentNode){var c=a.nodeType==goog.dom.NodeType.ELEMENT,d=b.nodeType==goog.dom.NodeType.ELEMENT;if(c&&d)return a.sourceIndex-b.sourceIndex;var e=a.parentNode,f=
b.parentNode;return e==f?goog.dom.compareSiblingOrder_(a,b):!c&&goog.dom.contains(e,b)?-1*goog.dom.compareParentsDescendantNodeIe_(a,b):!d&&goog.dom.contains(f,a)?goog.dom.compareParentsDescendantNodeIe_(b,a):(c?a.sourceIndex:e.sourceIndex)-(d?b.sourceIndex:f.sourceIndex)}d=goog.dom.getOwnerDocument(a);c=d.createRange();c.selectNode(a);c.collapse(!0);d=d.createRange();d.selectNode(b);d.collapse(!0);return c.compareBoundaryPoints(goog.global.Range.START_TO_END,d)};
goog.dom.compareParentsDescendantNodeIe_=function(a,b){var c=a.parentNode;if(c==b)return-1;for(var d=b;d.parentNode!=c;)d=d.parentNode;return goog.dom.compareSiblingOrder_(d,a)};goog.dom.compareSiblingOrder_=function(a,b){for(var c=b;c=c.previousSibling;)if(c==a)return-1;return 1};
goog.dom.findCommonAncestor=function(a){var b,c=arguments.length;if(c){if(1==c)return arguments[0]}else return null;var d=[],e=Infinity;for(b=0;b<c;b++){for(var f=[],g=arguments[b];g;)f.unshift(g),g=g.parentNode;d.push(f);e=Math.min(e,f.length)}f=null;for(b=0;b<e;b++){for(var g=d[0][b],h=1;h<c;h++)if(g!=d[h][b])return f;f=g}return f};goog.dom.getOwnerDocument=function(a){return a.nodeType==goog.dom.NodeType.DOCUMENT?a:a.ownerDocument||a.document};
goog.dom.getFrameContentDocument=function(a){return a.contentDocument||a.contentWindow.document};goog.dom.getFrameContentWindow=function(a){return a.contentWindow||goog.dom.getWindow_(goog.dom.getFrameContentDocument(a))};
goog.dom.setTextContent=function(a,b){if("textContent"in a)a.textContent=b;else if(a.firstChild&&a.firstChild.nodeType==goog.dom.NodeType.TEXT){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=b}else{goog.dom.removeChildren(a);var c=goog.dom.getOwnerDocument(a);a.appendChild(c.createTextNode(String(b)))}};goog.dom.getOuterHtml=function(a){if("outerHTML"in a)return a.outerHTML;var b=goog.dom.getOwnerDocument(a).createElement("div");b.appendChild(a.cloneNode(!0));return b.innerHTML};
goog.dom.findNode=function(a,b){var c=[];return goog.dom.findNodes_(a,b,c,!0)?c[0]:void 0};goog.dom.findNodes=function(a,b){var c=[];goog.dom.findNodes_(a,b,c,!1);return c};goog.dom.findNodes_=function(a,b,c,d){if(null!=a)for(a=a.firstChild;a;){if(b(a)&&(c.push(a),d)||goog.dom.findNodes_(a,b,c,d))return!0;a=a.nextSibling}return!1};goog.dom.TAGS_TO_IGNORE_={SCRIPT:1,STYLE:1,HEAD:1,IFRAME:1,OBJECT:1};goog.dom.PREDEFINED_TAG_VALUES_={IMG:" ",BR:"\n"};
goog.dom.isFocusableTabIndex=function(a){var b=a.getAttributeNode("tabindex");return b&&b.specified?(a=a.tabIndex,goog.isNumber(a)&&0<=a&&32768>a):!1};goog.dom.setFocusableTabIndex=function(a,b){b?a.tabIndex=0:(a.tabIndex=-1,a.removeAttribute("tabIndex"))};
goog.dom.getTextContent=function(a){if(goog.dom.BrowserFeature.CAN_USE_INNER_TEXT&&"innerText"in a)a=goog.string.canonicalizeNewlines(a.innerText);else{var b=[];goog.dom.getTextContent_(a,b,!0);a=b.join("")}a=a.replace(/ \xAD /g," ").replace(/\xAD/g,"");a=a.replace(/\u200B/g,"");goog.dom.BrowserFeature.CAN_USE_INNER_TEXT||(a=a.replace(/ +/g," "));" "!=a&&(a=a.replace(/^\s*/,""));return a};goog.dom.getRawTextContent=function(a){var b=[];goog.dom.getTextContent_(a,b,!1);return b.join("")};
goog.dom.getTextContent_=function(a,b,c){if(!(a.nodeName in goog.dom.TAGS_TO_IGNORE_))if(a.nodeType==goog.dom.NodeType.TEXT)c?b.push(String(a.nodeValue).replace(/(\r\n|\r|\n)/g,"")):b.push(a.nodeValue);else if(a.nodeName in goog.dom.PREDEFINED_TAG_VALUES_)b.push(goog.dom.PREDEFINED_TAG_VALUES_[a.nodeName]);else for(a=a.firstChild;a;)goog.dom.getTextContent_(a,b,c),a=a.nextSibling};goog.dom.getNodeTextLength=function(a){return goog.dom.getTextContent(a).length};
goog.dom.getNodeTextOffset=function(a,b){for(var c=b||goog.dom.getOwnerDocument(a).body,d=[];a&&a!=c;){for(var e=a;e=e.previousSibling;)d.unshift(goog.dom.getTextContent(e));a=a.parentNode}return goog.string.trimLeft(d.join("")).replace(/ +/g," ").length};
goog.dom.getNodeAtOffset=function(a,b,c){a=[a];for(var d=0,e=null;0<a.length&&d<b;)if(e=a.pop(),!(e.nodeName in goog.dom.TAGS_TO_IGNORE_))if(e.nodeType==goog.dom.NodeType.TEXT)var f=e.nodeValue.replace(/(\r\n|\r|\n)/g,"").replace(/ +/g," "),d=d+f.length;else if(e.nodeName in goog.dom.PREDEFINED_TAG_VALUES_)d+=goog.dom.PREDEFINED_TAG_VALUES_[e.nodeName].length;else for(f=e.childNodes.length-1;0<=f;f--)a.push(e.childNodes[f]);goog.isObject(c)&&(c.remainder=e?e.nodeValue.length+b-d-1:0,c.node=e);return e};
goog.dom.isNodeList=function(a){if(a&&"number"==typeof a.length){if(goog.isObject(a))return"function"==typeof a.item||"string"==typeof a.item;if(goog.isFunction(a))return"function"==typeof a.item}return!1};goog.dom.getAncestorByTagNameAndClass=function(a,b,c){if(!b&&!c)return null;var d=b?b.toUpperCase():null;return goog.dom.getAncestor(a,function(a){return(!d||a.nodeName==d)&&(!c||goog.dom.classes.has(a,c))},!0)};
goog.dom.getAncestorByClass=function(a,b){return goog.dom.getAncestorByTagNameAndClass(a,null,b)};goog.dom.getAncestor=function(a,b,c,d){c||(a=a.parentNode);c=null==d;for(var e=0;a&&(c||e<=d);){if(b(a))return a;a=a.parentNode;e++}return null};goog.dom.getActiveElement=function(a){try{return a&&a.activeElement}catch(b){}return null};goog.dom.DomHelper=function(a){this.document_=a||goog.global.document||document};goog.dom.DomHelper.prototype.getDomHelper=goog.dom.getDomHelper;
goog.dom.DomHelper.prototype.setDocument=function(a){this.document_=a};goog.dom.DomHelper.prototype.getDocument=function(){return this.document_};goog.dom.DomHelper.prototype.getElement=function(a){return goog.isString(a)?this.document_.getElementById(a):a};goog.dom.DomHelper.prototype.$=goog.dom.DomHelper.prototype.getElement;goog.dom.DomHelper.prototype.getElementsByTagNameAndClass=function(a,b,c){return goog.dom.getElementsByTagNameAndClass_(this.document_,a,b,c)};
goog.dom.DomHelper.prototype.getElementsByClass=function(a,b){return goog.dom.getElementsByClass(a,b||this.document_)};goog.dom.DomHelper.prototype.getElementByClass=function(a,b){return goog.dom.getElementByClass(a,b||this.document_)};goog.dom.DomHelper.prototype.$$=goog.dom.DomHelper.prototype.getElementsByTagNameAndClass;goog.dom.DomHelper.prototype.setProperties=goog.dom.setProperties;goog.dom.DomHelper.prototype.getViewportSize=function(a){return goog.dom.getViewportSize(a||this.getWindow())};
goog.dom.DomHelper.prototype.getDocumentHeight=function(){return goog.dom.getDocumentHeight_(this.getWindow())};goog.dom.DomHelper.prototype.createDom=function(a,b,c){return goog.dom.createDom_(this.document_,arguments)};goog.dom.DomHelper.prototype.$dom=goog.dom.DomHelper.prototype.createDom;goog.dom.DomHelper.prototype.createElement=function(a){return this.document_.createElement(a)};goog.dom.DomHelper.prototype.createTextNode=function(a){return this.document_.createTextNode(String(a))};
goog.dom.DomHelper.prototype.createTable=function(a,b,c){return goog.dom.createTable_(this.document_,a,b,!!c)};goog.dom.DomHelper.prototype.htmlToDocumentFragment=function(a){return goog.dom.htmlToDocumentFragment_(this.document_,a)};goog.dom.DomHelper.prototype.getCompatMode=function(){return this.isCss1CompatMode()?"CSS1Compat":"BackCompat"};goog.dom.DomHelper.prototype.isCss1CompatMode=function(){return goog.dom.isCss1CompatMode_(this.document_)};goog.dom.DomHelper.prototype.getWindow=function(){return goog.dom.getWindow_(this.document_)};
goog.dom.DomHelper.prototype.getDocumentScrollElement=function(){return goog.dom.getDocumentScrollElement_(this.document_)};goog.dom.DomHelper.prototype.getDocumentScroll=function(){return goog.dom.getDocumentScroll_(this.document_)};goog.dom.DomHelper.prototype.getActiveElement=function(a){return goog.dom.getActiveElement(a||this.document_)};goog.dom.DomHelper.prototype.appendChild=goog.dom.appendChild;goog.dom.DomHelper.prototype.append=goog.dom.append;
goog.dom.DomHelper.prototype.canHaveChildren=goog.dom.canHaveChildren;goog.dom.DomHelper.prototype.removeChildren=goog.dom.removeChildren;goog.dom.DomHelper.prototype.insertSiblingBefore=goog.dom.insertSiblingBefore;goog.dom.DomHelper.prototype.insertSiblingAfter=goog.dom.insertSiblingAfter;goog.dom.DomHelper.prototype.insertChildAt=goog.dom.insertChildAt;goog.dom.DomHelper.prototype.removeNode=goog.dom.removeNode;goog.dom.DomHelper.prototype.replaceNode=goog.dom.replaceNode;
goog.dom.DomHelper.prototype.flattenElement=goog.dom.flattenElement;goog.dom.DomHelper.prototype.getChildren=goog.dom.getChildren;goog.dom.DomHelper.prototype.getFirstElementChild=goog.dom.getFirstElementChild;goog.dom.DomHelper.prototype.getLastElementChild=goog.dom.getLastElementChild;goog.dom.DomHelper.prototype.getNextElementSibling=goog.dom.getNextElementSibling;goog.dom.DomHelper.prototype.getPreviousElementSibling=goog.dom.getPreviousElementSibling;
goog.dom.DomHelper.prototype.getNextNode=goog.dom.getNextNode;goog.dom.DomHelper.prototype.getPreviousNode=goog.dom.getPreviousNode;goog.dom.DomHelper.prototype.isNodeLike=goog.dom.isNodeLike;goog.dom.DomHelper.prototype.isElement=goog.dom.isElement;goog.dom.DomHelper.prototype.isWindow=goog.dom.isWindow;goog.dom.DomHelper.prototype.getParentElement=goog.dom.getParentElement;goog.dom.DomHelper.prototype.contains=goog.dom.contains;goog.dom.DomHelper.prototype.compareNodeOrder=goog.dom.compareNodeOrder;
goog.dom.DomHelper.prototype.findCommonAncestor=goog.dom.findCommonAncestor;goog.dom.DomHelper.prototype.getOwnerDocument=goog.dom.getOwnerDocument;goog.dom.DomHelper.prototype.getFrameContentDocument=goog.dom.getFrameContentDocument;goog.dom.DomHelper.prototype.getFrameContentWindow=goog.dom.getFrameContentWindow;goog.dom.DomHelper.prototype.setTextContent=goog.dom.setTextContent;goog.dom.DomHelper.prototype.getOuterHtml=goog.dom.getOuterHtml;goog.dom.DomHelper.prototype.findNode=goog.dom.findNode;
goog.dom.DomHelper.prototype.findNodes=goog.dom.findNodes;goog.dom.DomHelper.prototype.isFocusableTabIndex=goog.dom.isFocusableTabIndex;goog.dom.DomHelper.prototype.setFocusableTabIndex=goog.dom.setFocusableTabIndex;goog.dom.DomHelper.prototype.getTextContent=goog.dom.getTextContent;goog.dom.DomHelper.prototype.getNodeTextLength=goog.dom.getNodeTextLength;goog.dom.DomHelper.prototype.getNodeTextOffset=goog.dom.getNodeTextOffset;goog.dom.DomHelper.prototype.getNodeAtOffset=goog.dom.getNodeAtOffset;
goog.dom.DomHelper.prototype.isNodeList=goog.dom.isNodeList;goog.dom.DomHelper.prototype.getAncestorByTagNameAndClass=goog.dom.getAncestorByTagNameAndClass;goog.dom.DomHelper.prototype.getAncestorByClass=goog.dom.getAncestorByClass;goog.dom.DomHelper.prototype.getAncestor=goog.dom.getAncestor;goog.math.Box=function(a,b,c,d){this.top=a;this.right=b;this.bottom=c;this.left=d};goog.math.Box.boundingBox=function(a){for(var b=new goog.math.Box(arguments[0].y,arguments[0].x,arguments[0].y,arguments[0].x),c=1;c<arguments.length;c++){var d=arguments[c];b.top=Math.min(b.top,d.y);b.right=Math.max(b.right,d.x);b.bottom=Math.max(b.bottom,d.y);b.left=Math.min(b.left,d.x)}return b};goog.math.Box.prototype.clone=function(){return new goog.math.Box(this.top,this.right,this.bottom,this.left)};
goog.DEBUG&&(goog.math.Box.prototype.toString=function(){return"("+this.top+"t, "+this.right+"r, "+this.bottom+"b, "+this.left+"l)"});goog.math.Box.prototype.contains=function(a){return goog.math.Box.contains(this,a)};goog.math.Box.prototype.expand=function(a,b,c,d){goog.isObject(a)?(this.top-=a.top,this.right+=a.right,this.bottom+=a.bottom,this.left-=a.left):(this.top-=a,this.right+=b,this.bottom+=c,this.left-=d);return this};
goog.math.Box.prototype.expandToInclude=function(a){this.left=Math.min(this.left,a.left);this.top=Math.min(this.top,a.top);this.right=Math.max(this.right,a.right);this.bottom=Math.max(this.bottom,a.bottom)};goog.math.Box.equals=function(a,b){return a==b?!0:!a||!b?!1:a.top==b.top&&a.right==b.right&&a.bottom==b.bottom&&a.left==b.left};
goog.math.Box.contains=function(a,b){return!a||!b?!1:b instanceof goog.math.Box?b.left>=a.left&&b.right<=a.right&&b.top>=a.top&&b.bottom<=a.bottom:b.x>=a.left&&b.x<=a.right&&b.y>=a.top&&b.y<=a.bottom};goog.math.Box.relativePositionX=function(a,b){return b.x<a.left?b.x-a.left:b.x>a.right?b.x-a.right:0};goog.math.Box.relativePositionY=function(a,b){return b.y<a.top?b.y-a.top:b.y>a.bottom?b.y-a.bottom:0};
goog.math.Box.distance=function(a,b){var c=goog.math.Box.relativePositionX(a,b),d=goog.math.Box.relativePositionY(a,b);return Math.sqrt(c*c+d*d)};goog.math.Box.intersects=function(a,b){return a.left<=b.right&&b.left<=a.right&&a.top<=b.bottom&&b.top<=a.bottom};goog.math.Box.intersectsWithPadding=function(a,b,c){return a.left<=b.right+c&&b.left<=a.right+c&&a.top<=b.bottom+c&&b.top<=a.bottom+c};
goog.math.Box.prototype.ceil=function(){this.top=Math.ceil(this.top);this.right=Math.ceil(this.right);this.bottom=Math.ceil(this.bottom);this.left=Math.ceil(this.left);return this};goog.math.Box.prototype.floor=function(){this.top=Math.floor(this.top);this.right=Math.floor(this.right);this.bottom=Math.floor(this.bottom);this.left=Math.floor(this.left);return this};
goog.math.Box.prototype.round=function(){this.top=Math.round(this.top);this.right=Math.round(this.right);this.bottom=Math.round(this.bottom);this.left=Math.round(this.left);return this};goog.math.Box.prototype.translate=function(a,b){a instanceof goog.math.Coordinate?(this.left+=a.x,this.right+=a.x,this.top+=a.y,this.bottom+=a.y):(this.left+=a,this.right+=a,goog.isNumber(b)&&(this.top+=b,this.bottom+=b));return this};
goog.math.Box.prototype.scale=function(a,b){var c=goog.isNumber(b)?b:a;this.left*=a;this.right*=a;this.top*=c;this.bottom*=c;return this};goog.math.Rect=function(a,b,c,d){this.left=a;this.top=b;this.width=c;this.height=d};goog.math.Rect.prototype.clone=function(){return new goog.math.Rect(this.left,this.top,this.width,this.height)};goog.math.Rect.prototype.toBox=function(){return new goog.math.Box(this.top,this.left+this.width,this.top+this.height,this.left)};goog.math.Rect.createFromBox=function(a){return new goog.math.Rect(a.left,a.top,a.right-a.left,a.bottom-a.top)};
goog.DEBUG&&(goog.math.Rect.prototype.toString=function(){return"("+this.left+", "+this.top+" - "+this.width+"w x "+this.height+"h)"});goog.math.Rect.equals=function(a,b){return a==b?!0:!a||!b?!1:a.left==b.left&&a.width==b.width&&a.top==b.top&&a.height==b.height};
goog.math.Rect.prototype.intersection=function(a){var b=Math.max(this.left,a.left),c=Math.min(this.left+this.width,a.left+a.width);if(b<=c){var d=Math.max(this.top,a.top);a=Math.min(this.top+this.height,a.top+a.height);if(d<=a)return this.left=b,this.top=d,this.width=c-b,this.height=a-d,!0}return!1};
goog.math.Rect.intersection=function(a,b){var c=Math.max(a.left,b.left),d=Math.min(a.left+a.width,b.left+b.width);if(c<=d){var e=Math.max(a.top,b.top),f=Math.min(a.top+a.height,b.top+b.height);if(e<=f)return new goog.math.Rect(c,e,d-c,f-e)}return null};goog.math.Rect.intersects=function(a,b){return a.left<=b.left+b.width&&b.left<=a.left+a.width&&a.top<=b.top+b.height&&b.top<=a.top+a.height};goog.math.Rect.prototype.intersects=function(a){return goog.math.Rect.intersects(this,a)};
goog.math.Rect.difference=function(a,b){var c=goog.math.Rect.intersection(a,b);if(!c||!c.height||!c.width)return[a.clone()];var c=[],d=a.top,e=a.height,f=a.left+a.width,g=a.top+a.height,h=b.left+b.width,k=b.top+b.height;b.top>a.top&&(c.push(new goog.math.Rect(a.left,a.top,a.width,b.top-a.top)),d=b.top,e-=b.top-a.top);k<g&&(c.push(new goog.math.Rect(a.left,k,a.width,g-k)),e=k-d);b.left>a.left&&c.push(new goog.math.Rect(a.left,d,b.left-a.left,e));h<f&&c.push(new goog.math.Rect(h,d,f-h,e));return c};
goog.math.Rect.prototype.difference=function(a){return goog.math.Rect.difference(this,a)};goog.math.Rect.prototype.boundingRect=function(a){var b=Math.max(this.left+this.width,a.left+a.width),c=Math.max(this.top+this.height,a.top+a.height);this.left=Math.min(this.left,a.left);this.top=Math.min(this.top,a.top);this.width=b-this.left;this.height=c-this.top};goog.math.Rect.boundingRect=function(a,b){if(!a||!b)return null;var c=a.clone();c.boundingRect(b);return c};
goog.math.Rect.prototype.contains=function(a){return a instanceof goog.math.Rect?this.left<=a.left&&this.left+this.width>=a.left+a.width&&this.top<=a.top&&this.top+this.height>=a.top+a.height:a.x>=this.left&&a.x<=this.left+this.width&&a.y>=this.top&&a.y<=this.top+this.height};goog.math.Rect.prototype.squaredDistance=function(a){var b=a.x<this.left?this.left-a.x:Math.max(a.x-(this.left+this.width),0);a=a.y<this.top?this.top-a.y:Math.max(a.y-(this.top+this.height),0);return b*b+a*a};
goog.math.Rect.prototype.distance=function(a){return Math.sqrt(this.squaredDistance(a))};goog.math.Rect.prototype.getSize=function(){return new goog.math.Size(this.width,this.height)};goog.math.Rect.prototype.getTopLeft=function(){return new goog.math.Coordinate(this.left,this.top)};goog.math.Rect.prototype.getCenter=function(){return new goog.math.Coordinate(this.left+this.width/2,this.top+this.height/2)};
goog.math.Rect.prototype.getBottomRight=function(){return new goog.math.Coordinate(this.left+this.width,this.top+this.height)};goog.math.Rect.prototype.ceil=function(){this.left=Math.ceil(this.left);this.top=Math.ceil(this.top);this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};goog.math.Rect.prototype.floor=function(){this.left=Math.floor(this.left);this.top=Math.floor(this.top);this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};
goog.math.Rect.prototype.round=function(){this.left=Math.round(this.left);this.top=Math.round(this.top);this.width=Math.round(this.width);this.height=Math.round(this.height);return this};goog.math.Rect.prototype.translate=function(a,b){a instanceof goog.math.Coordinate?(this.left+=a.x,this.top+=a.y):(this.left+=a,goog.isNumber(b)&&(this.top+=b));return this};goog.math.Rect.prototype.scale=function(a,b){var c=goog.isNumber(b)?b:a;this.left*=a;this.width*=a;this.top*=c;this.height*=c;return this};goog.dom.vendor={};goog.dom.vendor.getVendorJsPrefix=function(){return goog.userAgent.WEBKIT?"Webkit":goog.userAgent.GECKO?"Moz":goog.userAgent.IE?"ms":goog.userAgent.OPERA?"O":null};goog.dom.vendor.getVendorPrefix=function(){return goog.userAgent.WEBKIT?"-webkit":goog.userAgent.GECKO?"-moz":goog.userAgent.IE?"-ms":goog.userAgent.OPERA?"-o":null};goog.style={};goog.style.setStyle=function(a,b,c){goog.isString(b)?goog.style.setStyle_(a,c,b):goog.object.forEach(b,goog.partial(goog.style.setStyle_,a))};goog.style.setStyle_=function(a,b,c){(c=goog.style.getVendorJsStyleName_(a,c))&&(a.style[c]=b)};goog.style.getVendorJsStyleName_=function(a,b){var c=goog.string.toCamelCase(b);if(void 0===a.style[c]){var d=goog.dom.vendor.getVendorJsPrefix()+goog.string.toTitleCase(b);if(void 0!==a.style[d])return d}return c};
goog.style.getVendorStyleName_=function(a,b){var c=goog.string.toCamelCase(b);return void 0===a.style[c]&&(c=goog.dom.vendor.getVendorJsPrefix()+goog.string.toTitleCase(b),void 0!==a.style[c])?goog.dom.vendor.getVendorPrefix()+"-"+b:b};goog.style.getStyle=function(a,b){var c=a.style[goog.string.toCamelCase(b)];return"undefined"!==typeof c?c:a.style[goog.style.getVendorJsStyleName_(a,b)]||""};
goog.style.getComputedStyle=function(a,b){var c=goog.dom.getOwnerDocument(a);return c.defaultView&&c.defaultView.getComputedStyle&&(c=c.defaultView.getComputedStyle(a,null))?c[b]||c.getPropertyValue(b)||"":""};goog.style.getCascadedStyle=function(a,b){return a.currentStyle?a.currentStyle[b]:null};goog.style.getStyle_=function(a,b){return goog.style.getComputedStyle(a,b)||goog.style.getCascadedStyle(a,b)||a.style&&a.style[b]};
goog.style.getComputedPosition=function(a){return goog.style.getStyle_(a,"position")};goog.style.getBackgroundColor=function(a){return goog.style.getStyle_(a,"backgroundColor")};goog.style.getComputedOverflowX=function(a){return goog.style.getStyle_(a,"overflowX")};goog.style.getComputedOverflowY=function(a){return goog.style.getStyle_(a,"overflowY")};goog.style.getComputedZIndex=function(a){return goog.style.getStyle_(a,"zIndex")};
goog.style.getComputedTextAlign=function(a){return goog.style.getStyle_(a,"textAlign")};goog.style.getComputedCursor=function(a){return goog.style.getStyle_(a,"cursor")};goog.style.setPosition=function(a,b,c){var d,e=goog.userAgent.GECKO&&(goog.userAgent.MAC||goog.userAgent.X11)&&goog.userAgent.isVersionOrHigher("1.9");b instanceof goog.math.Coordinate?(d=b.x,b=b.y):(d=b,b=c);a.style.left=goog.style.getPixelStyleValue_(d,e);a.style.top=goog.style.getPixelStyleValue_(b,e)};
goog.style.getPosition=function(a){return new goog.math.Coordinate(a.offsetLeft,a.offsetTop)};goog.style.getClientViewportElement=function(a){a=a?goog.dom.getOwnerDocument(a):goog.dom.getDocument();return goog.userAgent.IE&&!goog.userAgent.isDocumentMode(9)&&!goog.dom.getDomHelper(a).isCss1CompatMode()?a.body:a.documentElement};goog.style.getViewportPageOffset=function(a){var b=a.body;a=a.documentElement;return new goog.math.Coordinate(b.scrollLeft||a.scrollLeft,b.scrollTop||a.scrollTop)};
goog.style.getBoundingClientRect_=function(a){var b=a.getBoundingClientRect();goog.userAgent.IE&&(a=a.ownerDocument,b.left-=a.documentElement.clientLeft+a.body.clientLeft,b.top-=a.documentElement.clientTop+a.body.clientTop);return b};
goog.style.getOffsetParent=function(a){if(goog.userAgent.IE&&!goog.userAgent.isDocumentMode(8))return a.offsetParent;var b=goog.dom.getOwnerDocument(a),c=goog.style.getStyle_(a,"position"),d="fixed"==c||"absolute"==c;for(a=a.parentNode;a&&a!=b;a=a.parentNode)if(c=goog.style.getStyle_(a,"position"),d=d&&"static"==c&&a!=b.documentElement&&a!=b.body,!d&&(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight||"fixed"==c||"absolute"==c||"relative"==c))return a;return null};
goog.style.getVisibleRectForElement=function(a){for(var b=new goog.math.Box(0,Infinity,Infinity,0),c=goog.dom.getDomHelper(a),d=c.getDocument().body,e=c.getDocument().documentElement,f=c.getDocumentScrollElement();a=goog.style.getOffsetParent(a);)if((!goog.userAgent.IE||0!=a.clientWidth)&&(!goog.userAgent.WEBKIT||0!=a.clientHeight||a!=d)&&a!=d&&a!=e&&"visible"!=goog.style.getStyle_(a,"overflow")){var g=goog.style.getPageOffset(a),h=goog.style.getClientLeftTop(a);g.x+=h.x;g.y+=h.y;b.top=Math.max(b.top,
g.y);b.right=Math.min(b.right,g.x+a.clientWidth);b.bottom=Math.min(b.bottom,g.y+a.clientHeight);b.left=Math.max(b.left,g.x)}d=f.scrollLeft;f=f.scrollTop;b.left=Math.max(b.left,d);b.top=Math.max(b.top,f);c=c.getViewportSize();b.right=Math.min(b.right,d+c.width);b.bottom=Math.min(b.bottom,f+c.height);return 0<=b.top&&0<=b.left&&b.bottom>b.top&&b.right>b.left?b:null};
goog.style.getContainerOffsetToScrollInto=function(a,b,c){var d=goog.style.getPageOffset(a),e=goog.style.getPageOffset(b),f=goog.style.getBorderBox(b),g=d.x-e.x-f.left,d=d.y-e.y-f.top,e=b.clientWidth-a.offsetWidth;a=b.clientHeight-a.offsetHeight;f=b.scrollLeft;b=b.scrollTop;c?(f+=g-e/2,b+=d-a/2):(f+=Math.min(g,Math.max(g-e,0)),b+=Math.min(d,Math.max(d-a,0)));return new goog.math.Coordinate(f,b)};
goog.style.scrollIntoContainerView=function(a,b,c){a=goog.style.getContainerOffsetToScrollInto(a,b,c);b.scrollLeft=a.x;b.scrollTop=a.y};
goog.style.getClientLeftTop=function(a){if(goog.userAgent.GECKO&&!goog.userAgent.isVersionOrHigher("1.9")){var b=parseFloat(goog.style.getComputedStyle(a,"borderLeftWidth"));if(goog.style.isRightToLeft(a))var c=a.offsetWidth-a.clientWidth-b-parseFloat(goog.style.getComputedStyle(a,"borderRightWidth")),b=b+c;return new goog.math.Coordinate(b,parseFloat(goog.style.getComputedStyle(a,"borderTopWidth")))}return new goog.math.Coordinate(a.clientLeft,a.clientTop)};
goog.style.getPageOffset=function(a){var b,c=goog.dom.getOwnerDocument(a),d=goog.style.getStyle_(a,"position");goog.asserts.assertObject(a,"Parameter is required");var e=goog.userAgent.GECKO&&c.getBoxObjectFor&&!a.getBoundingClientRect&&"absolute"==d&&(b=c.getBoxObjectFor(a))&&(0>b.screenX||0>b.screenY),f=new goog.math.Coordinate(0,0),g=goog.style.getClientViewportElement(c);if(a==g)return f;if(a.getBoundingClientRect)b=goog.style.getBoundingClientRect_(a),a=goog.dom.getDomHelper(c).getDocumentScroll(),
f.x=b.left+a.x,f.y=b.top+a.y;else if(c.getBoxObjectFor&&!e)b=c.getBoxObjectFor(a),a=c.getBoxObjectFor(g),f.x=b.screenX-a.screenX,f.y=b.screenY-a.screenY;else{b=a;do{f.x+=b.offsetLeft;f.y+=b.offsetTop;b!=a&&(f.x+=b.clientLeft||0,f.y+=b.clientTop||0);if(goog.userAgent.WEBKIT&&"fixed"==goog.style.getComputedPosition(b)){f.x+=c.body.scrollLeft;f.y+=c.body.scrollTop;break}b=b.offsetParent}while(b&&b!=a);if(goog.userAgent.OPERA||goog.userAgent.WEBKIT&&"absolute"==d)f.y-=c.body.offsetTop;for(b=a;(b=goog.style.getOffsetParent(b))&&
b!=c.body&&b!=g;)if(f.x-=b.scrollLeft,!goog.userAgent.OPERA||"TR"!=b.tagName)f.y-=b.scrollTop}return f};goog.style.getPageOffsetLeft=function(a){return goog.style.getPageOffset(a).x};goog.style.getPageOffsetTop=function(a){return goog.style.getPageOffset(a).y};
goog.style.getFramedPageOffset=function(a,b){var c=new goog.math.Coordinate(0,0),d=goog.dom.getWindow(goog.dom.getOwnerDocument(a)),e=a;do{var f=d==b?goog.style.getPageOffset(e):goog.style.getClientPosition(e);c.x+=f.x;c.y+=f.y}while(d&&d!=b&&(e=d.frameElement)&&(d=d.parent));return c};
goog.style.translateRectForAnotherFrame=function(a,b,c){if(b.getDocument()!=c.getDocument()){var d=b.getDocument().body;c=goog.style.getFramedPageOffset(d,c.getWindow());c=goog.math.Coordinate.difference(c,goog.style.getPageOffset(d));goog.userAgent.IE&&!b.isCss1CompatMode()&&(c=goog.math.Coordinate.difference(c,b.getDocumentScroll()));a.left+=c.x;a.top+=c.y}};
goog.style.getRelativePosition=function(a,b){var c=goog.style.getClientPosition(a),d=goog.style.getClientPosition(b);return new goog.math.Coordinate(c.x-d.x,c.y-d.y)};
goog.style.getClientPosition=function(a){var b=new goog.math.Coordinate;if(a.nodeType==goog.dom.NodeType.ELEMENT){if(a.getBoundingClientRect){var c=goog.style.getBoundingClientRect_(a);b.x=c.left;b.y=c.top}else{var c=goog.dom.getDomHelper(a).getDocumentScroll(),d=goog.style.getPageOffset(a);b.x=d.x-c.x;b.y=d.y-c.y}goog.userAgent.GECKO&&!goog.userAgent.isVersionOrHigher(12)&&(b=goog.math.Coordinate.sum(b,goog.style.getCssTranslation(a)))}else c=goog.isFunction(a.getBrowserEvent),d=a,a.targetTouches?
d=a.targetTouches[0]:c&&a.getBrowserEvent().targetTouches&&(d=a.getBrowserEvent().targetTouches[0]),b.x=d.clientX,b.y=d.clientY;return b};goog.style.setPageOffset=function(a,b,c){var d=goog.style.getPageOffset(a);b instanceof goog.math.Coordinate&&(c=b.y,b=b.x);goog.style.setPosition(a,a.offsetLeft+(b-d.x),a.offsetTop+(c-d.y))};
goog.style.setSize=function(a,b,c){if(b instanceof goog.math.Size)c=b.height,b=b.width;else if(void 0==c)throw Error("missing height argument");goog.style.setWidth(a,b);goog.style.setHeight(a,c)};goog.style.getPixelStyleValue_=function(a,b){"number"==typeof a&&(a=(b?Math.round(a):a)+"px");return a};goog.style.setHeight=function(a,b){a.style.height=goog.style.getPixelStyleValue_(b,!0)};goog.style.setWidth=function(a,b){a.style.width=goog.style.getPixelStyleValue_(b,!0)};
goog.style.getSize=function(a){if("none"!=goog.style.getStyle_(a,"display"))return goog.style.getSizeWithDisplay_(a);var b=a.style,c=b.display,d=b.visibility,e=b.position;b.visibility="hidden";b.position="absolute";b.display="inline";a=goog.style.getSizeWithDisplay_(a);b.display=c;b.position=e;b.visibility=d;return a};
goog.style.getSizeWithDisplay_=function(a){var b=a.offsetWidth,c=a.offsetHeight,d=goog.userAgent.WEBKIT&&!b&&!c;return(!goog.isDef(b)||d)&&a.getBoundingClientRect?(a=goog.style.getBoundingClientRect_(a),new goog.math.Size(a.right-a.left,a.bottom-a.top)):new goog.math.Size(b,c)};goog.style.getBounds=function(a){var b=goog.style.getPageOffset(a);a=goog.style.getSize(a);return new goog.math.Rect(b.x,b.y,a.width,a.height)};goog.style.toCamelCase=function(a){return goog.string.toCamelCase(String(a))};
goog.style.toSelectorCase=function(a){return goog.string.toSelectorCase(a)};goog.style.getOpacity=function(a){var b=a.style;a="";"opacity"in b?a=b.opacity:"MozOpacity"in b?a=b.MozOpacity:"filter"in b&&(b=b.filter.match(/alpha\(opacity=([\d.]+)\)/))&&(a=String(b[1]/100));return""==a?a:Number(a)};goog.style.setOpacity=function(a,b){var c=a.style;"opacity"in c?c.opacity=b:"MozOpacity"in c?c.MozOpacity=b:"filter"in c&&(c.filter=""===b?"":"alpha(opacity="+100*b+")")};
goog.style.setTransparentBackgroundImage=function(a,b){var c=a.style;goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("8")?c.filter='progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+b+'", sizingMethod="crop")':(c.backgroundImage="url("+b+")",c.backgroundPosition="top left",c.backgroundRepeat="no-repeat")};goog.style.clearTransparentBackgroundImage=function(a){a=a.style;"filter"in a?a.filter="":a.backgroundImage="none"};
goog.style.showElement=function(a,b){goog.style.setElementShown(a,b)};goog.style.setElementShown=function(a,b){a.style.display=b?"":"none"};goog.style.isElementShown=function(a){return"none"!=a.style.display};
goog.style.installStyles=function(a,b){var c=goog.dom.getDomHelper(b),d=null;if(goog.userAgent.IE)d=c.getDocument().createStyleSheet(),goog.style.setStyles(d,a);else{var e=c.getElementsByTagNameAndClass("head")[0];e||(d=c.getElementsByTagNameAndClass("body")[0],e=c.createDom("head"),d.parentNode.insertBefore(e,d));d=c.createDom("style");goog.style.setStyles(d,a);c.appendChild(e,d)}return d};goog.style.uninstallStyles=function(a){goog.dom.removeNode(a.ownerNode||a.owningElement||a)};
goog.style.setStyles=function(a,b){goog.userAgent.IE?a.cssText=b:a.innerHTML=b};goog.style.setPreWrap=function(a){a=a.style;goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("8")?(a.whiteSpace="pre",a.wordWrap="break-word"):a.whiteSpace=goog.userAgent.GECKO?"-moz-pre-wrap":"pre-wrap"};
goog.style.setInlineBlock=function(a){a=a.style;a.position="relative";goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("8")?(a.zoom="1",a.display="inline"):a.display=goog.userAgent.GECKO?goog.userAgent.isVersionOrHigher("1.9a")?"inline-block":"-moz-inline-box":"inline-block"};goog.style.isRightToLeft=function(a){return"rtl"==goog.style.getStyle_(a,"direction")};goog.style.unselectableStyle_=goog.userAgent.GECKO?"MozUserSelect":goog.userAgent.WEBKIT?"WebkitUserSelect":null;
goog.style.isUnselectable=function(a){return goog.style.unselectableStyle_?"none"==a.style[goog.style.unselectableStyle_].toLowerCase():goog.userAgent.IE||goog.userAgent.OPERA?"on"==a.getAttribute("unselectable"):!1};
goog.style.setUnselectable=function(a,b,c){c=!c?a.getElementsByTagName("*"):null;var d=goog.style.unselectableStyle_;if(d){if(b=b?"none":"",a.style[d]=b,c){a=0;for(var e;e=c[a];a++)e.style[d]=b}}else if(goog.userAgent.IE||goog.userAgent.OPERA)if(b=b?"on":"",a.setAttribute("unselectable",b),c)for(a=0;e=c[a];a++)e.setAttribute("unselectable",b)};goog.style.getBorderBoxSize=function(a){return new goog.math.Size(a.offsetWidth,a.offsetHeight)};
goog.style.setBorderBoxSize=function(a,b){var c=goog.dom.getOwnerDocument(a),d=goog.dom.getDomHelper(c).isCss1CompatMode();if(goog.userAgent.IE&&(!d||!goog.userAgent.isVersionOrHigher("8")))if(c=a.style,d){var d=goog.style.getPaddingBox(a),e=goog.style.getBorderBox(a);c.pixelWidth=b.width-e.left-d.left-d.right-e.right;c.pixelHeight=b.height-e.top-d.top-d.bottom-e.bottom}else c.pixelWidth=b.width,c.pixelHeight=b.height;else goog.style.setBoxSizingSize_(a,b,"border-box")};
goog.style.getContentBoxSize=function(a){var b=goog.dom.getOwnerDocument(a),c=goog.userAgent.IE&&a.currentStyle;if(c&&goog.dom.getDomHelper(b).isCss1CompatMode()&&"auto"!=c.width&&"auto"!=c.height&&!c.boxSizing)return b=goog.style.getIePixelValue_(a,c.width,"width","pixelWidth"),a=goog.style.getIePixelValue_(a,c.height,"height","pixelHeight"),new goog.math.Size(b,a);c=goog.style.getBorderBoxSize(a);b=goog.style.getPaddingBox(a);a=goog.style.getBorderBox(a);return new goog.math.Size(c.width-a.left-
b.left-b.right-a.right,c.height-a.top-b.top-b.bottom-a.bottom)};
goog.style.setContentBoxSize=function(a,b){var c=goog.dom.getOwnerDocument(a),d=goog.dom.getDomHelper(c).isCss1CompatMode();if(goog.userAgent.IE&&(!d||!goog.userAgent.isVersionOrHigher("8")))if(c=a.style,d)c.pixelWidth=b.width,c.pixelHeight=b.height;else{var d=goog.style.getPaddingBox(a),e=goog.style.getBorderBox(a);c.pixelWidth=b.width+e.left+d.left+d.right+e.right;c.pixelHeight=b.height+e.top+d.top+d.bottom+e.bottom}else goog.style.setBoxSizingSize_(a,b,"content-box")};
goog.style.setBoxSizingSize_=function(a,b,c){a=a.style;goog.userAgent.GECKO?a.MozBoxSizing=c:goog.userAgent.WEBKIT?a.WebkitBoxSizing=c:a.boxSizing=c;a.width=Math.max(b.width,0)+"px";a.height=Math.max(b.height,0)+"px"};goog.style.getIePixelValue_=function(a,b,c,d){if(/^\d+px?$/.test(b))return parseInt(b,10);var e=a.style[c],f=a.runtimeStyle[c];a.runtimeStyle[c]=a.currentStyle[c];a.style[c]=b;b=a.style[d];a.style[c]=e;a.runtimeStyle[c]=f;return b};
goog.style.getIePixelDistance_=function(a,b){var c=goog.style.getCascadedStyle(a,b);return c?goog.style.getIePixelValue_(a,c,"left","pixelLeft"):0};
goog.style.getBox_=function(a,b){if(goog.userAgent.IE){var c=goog.style.getIePixelDistance_(a,b+"Left"),d=goog.style.getIePixelDistance_(a,b+"Right"),e=goog.style.getIePixelDistance_(a,b+"Top"),f=goog.style.getIePixelDistance_(a,b+"Bottom");return new goog.math.Box(e,d,f,c)}c=goog.style.getComputedStyle(a,b+"Left");d=goog.style.getComputedStyle(a,b+"Right");e=goog.style.getComputedStyle(a,b+"Top");f=goog.style.getComputedStyle(a,b+"Bottom");return new goog.math.Box(parseFloat(e),parseFloat(d),parseFloat(f),
parseFloat(c))};goog.style.getPaddingBox=function(a){return goog.style.getBox_(a,"padding")};goog.style.getMarginBox=function(a){return goog.style.getBox_(a,"margin")};goog.style.ieBorderWidthKeywords_={thin:2,medium:4,thick:6};
goog.style.getIePixelBorder_=function(a,b){if("none"==goog.style.getCascadedStyle(a,b+"Style"))return 0;var c=goog.style.getCascadedStyle(a,b+"Width");return c in goog.style.ieBorderWidthKeywords_?goog.style.ieBorderWidthKeywords_[c]:goog.style.getIePixelValue_(a,c,"left","pixelLeft")};
goog.style.getBorderBox=function(a){if(goog.userAgent.IE){var b=goog.style.getIePixelBorder_(a,"borderLeft"),c=goog.style.getIePixelBorder_(a,"borderRight"),d=goog.style.getIePixelBorder_(a,"borderTop");a=goog.style.getIePixelBorder_(a,"borderBottom");return new goog.math.Box(d,c,a,b)}b=goog.style.getComputedStyle(a,"borderLeftWidth");c=goog.style.getComputedStyle(a,"borderRightWidth");d=goog.style.getComputedStyle(a,"borderTopWidth");a=goog.style.getComputedStyle(a,"borderBottomWidth");return new goog.math.Box(parseFloat(d),
parseFloat(c),parseFloat(a),parseFloat(b))};goog.style.getFontFamily=function(a){var b=goog.dom.getOwnerDocument(a),c="";if(b.body.createTextRange){b=b.body.createTextRange();b.moveToElementText(a);try{c=b.queryCommandValue("FontName")}catch(d){c=""}}c||(c=goog.style.getStyle_(a,"fontFamily"));a=c.split(",");1<a.length&&(c=a[0]);return goog.string.stripQuotes(c,"\"'")};goog.style.lengthUnitRegex_=/[^\d]+$/;
goog.style.getLengthUnits=function(a){return(a=a.match(goog.style.lengthUnitRegex_))&&a[0]||null};goog.style.ABSOLUTE_CSS_LENGTH_UNITS_={cm:1,"in":1,mm:1,pc:1,pt:1};goog.style.CONVERTIBLE_RELATIVE_CSS_UNITS_={em:1,ex:1};
goog.style.getFontSize=function(a){var b=goog.style.getStyle_(a,"fontSize"),c=goog.style.getLengthUnits(b);if(b&&"px"==c)return parseInt(b,10);if(goog.userAgent.IE){if(c in goog.style.ABSOLUTE_CSS_LENGTH_UNITS_)return goog.style.getIePixelValue_(a,b,"left","pixelLeft");if(a.parentNode&&a.parentNode.nodeType==goog.dom.NodeType.ELEMENT&&c in goog.style.CONVERTIBLE_RELATIVE_CSS_UNITS_)return a=a.parentNode,c=goog.style.getStyle_(a,"fontSize"),goog.style.getIePixelValue_(a,b==c?"1em":b,"left","pixelLeft")}c=
goog.dom.createDom("span",{style:"visibility:hidden;position:absolute;line-height:0;padding:0;margin:0;border:0;height:1em;"});goog.dom.appendChild(a,c);b=c.offsetHeight;goog.dom.removeNode(c);return b};goog.style.parseStyleAttribute=function(a){var b={};goog.array.forEach(a.split(/\s*;\s*/),function(a){a=a.split(/\s*:\s*/);2==a.length&&(b[goog.string.toCamelCase(a[0].toLowerCase())]=a[1])});return b};
goog.style.toStyleAttribute=function(a){var b=[];goog.object.forEach(a,function(a,d){b.push(goog.string.toSelectorCase(d),":",a,";")});return b.join("")};goog.style.setFloat=function(a,b){a.style[goog.userAgent.IE?"styleFloat":"cssFloat"]=b};goog.style.getFloat=function(a){return a.style[goog.userAgent.IE?"styleFloat":"cssFloat"]||""};
goog.style.getScrollbarWidth=function(a){var b=goog.dom.createElement("div");a&&(b.className=a);b.style.cssText="overflow:auto;position:absolute;top:0;width:100px;height:100px";a=goog.dom.createElement("div");goog.style.setSize(a,"200px","200px");b.appendChild(a);goog.dom.appendChild(goog.dom.getDocument().body,b);a=b.offsetWidth-b.clientWidth;goog.dom.removeNode(b);return a};goog.style.MATRIX_TRANSLATION_REGEX_=/matrix\([0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, ([0-9\.\-]+)p?x?, ([0-9\.\-]+)p?x?\)/;
goog.style.getCssTranslation=function(a){var b;goog.userAgent.IE?b="-ms-transform":goog.userAgent.WEBKIT?b="-webkit-transform":goog.userAgent.OPERA?b="-o-transform":goog.userAgent.GECKO&&(b="-moz-transform");var c;b&&(c=goog.style.getStyle_(a,b));c||(c=goog.style.getStyle_(a,"transform"));if(!c)return new goog.math.Coordinate(0,0);a=c.match(goog.style.MATRIX_TRANSLATION_REGEX_);return!a?new goog.math.Coordinate(0,0):new goog.math.Coordinate(parseFloat(a[1]),parseFloat(a[2]))};goog.events.MouseWheelHandler=function(a,b){goog.events.EventTarget.call(this);this.element_=a;var c=goog.dom.isElement(this.element_)?this.element_:this.element_?this.element_.body:null;this.isRtl_=!!c&&goog.style.isRightToLeft(c);this.listenKey_=goog.events.listen(this.element_,goog.userAgent.GECKO?"DOMMouseScroll":"mousewheel",this,b)};goog.inherits(goog.events.MouseWheelHandler,goog.events.EventTarget);goog.events.MouseWheelHandler.EventType={MOUSEWHEEL:"mousewheel"};
goog.events.MouseWheelHandler.prototype.setMaxDeltaX=function(a){this.maxDeltaX_=a};goog.events.MouseWheelHandler.prototype.setMaxDeltaY=function(a){this.maxDeltaY_=a};
goog.events.MouseWheelHandler.prototype.handleEvent=function(a){var b=0,c=0,d=0;a=a.getBrowserEvent();if("mousewheel"==a.type){c=1;if(goog.userAgent.IE||goog.userAgent.WEBKIT&&(goog.userAgent.WINDOWS||goog.userAgent.isVersionOrHigher("532.0")))c=40;d=goog.events.MouseWheelHandler.smartScale_(-a.wheelDelta,c);goog.isDef(a.wheelDeltaX)?(b=goog.events.MouseWheelHandler.smartScale_(-a.wheelDeltaX,c),c=goog.events.MouseWheelHandler.smartScale_(-a.wheelDeltaY,c)):c=d}else d=a.detail,100<d?d=3:-100>d&&(d=
-3),goog.isDef(a.axis)&&a.axis===a.HORIZONTAL_AXIS?b=d:c=d;goog.isNumber(this.maxDeltaX_)&&(b=goog.math.clamp(b,-this.maxDeltaX_,this.maxDeltaX_));goog.isNumber(this.maxDeltaY_)&&(c=goog.math.clamp(c,-this.maxDeltaY_,this.maxDeltaY_));this.isRtl_&&(b=-b);b=new goog.events.MouseWheelEvent(d,a,b,c);this.dispatchEvent(b)};goog.events.MouseWheelHandler.smartScale_=function(a,b){return goog.userAgent.WEBKIT&&(goog.userAgent.MAC||goog.userAgent.LINUX)&&0!=a%b?a:a/b};
goog.events.MouseWheelHandler.prototype.disposeInternal=function(){goog.events.MouseWheelHandler.superClass_.disposeInternal.call(this);goog.events.unlistenByKey(this.listenKey_);this.listenKey_=null};goog.events.MouseWheelEvent=function(a,b,c,d){goog.events.BrowserEvent.call(this,b);this.type=goog.events.MouseWheelHandler.EventType.MOUSEWHEEL;this.detail=a;this.deltaX=c;this.deltaY=d};goog.inherits(goog.events.MouseWheelEvent,goog.events.BrowserEvent);goog.events.KeyCodes={WIN_KEY_FF_LINUX:0,MAC_ENTER:3,BACKSPACE:8,TAB:9,NUM_CENTER:12,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PRINT_SCREEN:44,INSERT:45,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,FF_SEMICOLON:59,FF_EQUALS:61,QUESTION_MARK:63,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,
X:88,Y:89,Z:90,META:91,WIN_KEY_RIGHT:92,CONTEXT_MENU:93,NUM_ZERO:96,NUM_ONE:97,NUM_TWO:98,NUM_THREE:99,NUM_FOUR:100,NUM_FIVE:101,NUM_SIX:102,NUM_SEVEN:103,NUM_EIGHT:104,NUM_NINE:105,NUM_MULTIPLY:106,NUM_PLUS:107,NUM_MINUS:109,NUM_PERIOD:110,NUM_DIVISION:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUMLOCK:144,SCROLL_LOCK:145,FIRST_MEDIA_KEY:166,LAST_MEDIA_KEY:183,SEMICOLON:186,DASH:189,EQUALS:187,COMMA:188,PERIOD:190,SLASH:191,APOSTROPHE:192,TILDE:192,
SINGLE_QUOTE:222,OPEN_SQUARE_BRACKET:219,BACKSLASH:220,CLOSE_SQUARE_BRACKET:221,WIN_KEY:224,MAC_FF_META:224,WIN_IME:229,PHANTOM:255};
goog.events.KeyCodes.isTextModifyingKeyEvent=function(a){if(a.altKey&&!a.ctrlKey||a.metaKey||a.keyCode>=goog.events.KeyCodes.F1&&a.keyCode<=goog.events.KeyCodes.F12)return!1;switch(a.keyCode){case goog.events.KeyCodes.ALT:case goog.events.KeyCodes.CAPS_LOCK:case goog.events.KeyCodes.CONTEXT_MENU:case goog.events.KeyCodes.CTRL:case goog.events.KeyCodes.DOWN:case goog.events.KeyCodes.END:case goog.events.KeyCodes.ESC:case goog.events.KeyCodes.HOME:case goog.events.KeyCodes.INSERT:case goog.events.KeyCodes.LEFT:case goog.events.KeyCodes.MAC_FF_META:case goog.events.KeyCodes.META:case goog.events.KeyCodes.NUMLOCK:case goog.events.KeyCodes.NUM_CENTER:case goog.events.KeyCodes.PAGE_DOWN:case goog.events.KeyCodes.PAGE_UP:case goog.events.KeyCodes.PAUSE:case goog.events.KeyCodes.PHANTOM:case goog.events.KeyCodes.PRINT_SCREEN:case goog.events.KeyCodes.RIGHT:case goog.events.KeyCodes.SCROLL_LOCK:case goog.events.KeyCodes.SHIFT:case goog.events.KeyCodes.UP:case goog.events.KeyCodes.WIN_KEY:case goog.events.KeyCodes.WIN_KEY_RIGHT:return!1;case goog.events.KeyCodes.WIN_KEY_FF_LINUX:return!goog.userAgent.GECKO;
default:return a.keyCode<goog.events.KeyCodes.FIRST_MEDIA_KEY||a.keyCode>goog.events.KeyCodes.LAST_MEDIA_KEY}};
goog.events.KeyCodes.firesKeyPressEvent=function(a,b,c,d,e){if(!goog.userAgent.IE&&(!goog.userAgent.WEBKIT||!goog.userAgent.isVersionOrHigher("525")))return!0;if(goog.userAgent.MAC&&e)return goog.events.KeyCodes.isCharacterKey(a);if(e&&!d||!c&&(b==goog.events.KeyCodes.CTRL||b==goog.events.KeyCodes.ALT||goog.userAgent.MAC&&b==goog.events.KeyCodes.META))return!1;if(goog.userAgent.WEBKIT&&d&&c)switch(a){case goog.events.KeyCodes.BACKSLASH:case goog.events.KeyCodes.OPEN_SQUARE_BRACKET:case goog.events.KeyCodes.CLOSE_SQUARE_BRACKET:case goog.events.KeyCodes.TILDE:case goog.events.KeyCodes.SEMICOLON:case goog.events.KeyCodes.DASH:case goog.events.KeyCodes.EQUALS:case goog.events.KeyCodes.COMMA:case goog.events.KeyCodes.PERIOD:case goog.events.KeyCodes.SLASH:case goog.events.KeyCodes.APOSTROPHE:case goog.events.KeyCodes.SINGLE_QUOTE:return!1}if(goog.userAgent.IE&&
d&&b==a)return!1;switch(a){case goog.events.KeyCodes.ENTER:return!(goog.userAgent.IE&&goog.userAgent.isDocumentMode(9));case goog.events.KeyCodes.ESC:return!goog.userAgent.WEBKIT}return goog.events.KeyCodes.isCharacterKey(a)};
goog.events.KeyCodes.isCharacterKey=function(a){if(a>=goog.events.KeyCodes.ZERO&&a<=goog.events.KeyCodes.NINE||a>=goog.events.KeyCodes.NUM_ZERO&&a<=goog.events.KeyCodes.NUM_MULTIPLY||a>=goog.events.KeyCodes.A&&a<=goog.events.KeyCodes.Z||goog.userAgent.WEBKIT&&0==a)return!0;switch(a){case goog.events.KeyCodes.SPACE:case goog.events.KeyCodes.QUESTION_MARK:case goog.events.KeyCodes.NUM_PLUS:case goog.events.KeyCodes.NUM_MINUS:case goog.events.KeyCodes.NUM_PERIOD:case goog.events.KeyCodes.NUM_DIVISION:case goog.events.KeyCodes.SEMICOLON:case goog.events.KeyCodes.FF_SEMICOLON:case goog.events.KeyCodes.DASH:case goog.events.KeyCodes.EQUALS:case goog.events.KeyCodes.FF_EQUALS:case goog.events.KeyCodes.COMMA:case goog.events.KeyCodes.PERIOD:case goog.events.KeyCodes.SLASH:case goog.events.KeyCodes.APOSTROPHE:case goog.events.KeyCodes.SINGLE_QUOTE:case goog.events.KeyCodes.OPEN_SQUARE_BRACKET:case goog.events.KeyCodes.BACKSLASH:case goog.events.KeyCodes.CLOSE_SQUARE_BRACKET:return!0;default:return!1}};
goog.events.KeyCodes.normalizeGeckoKeyCode=function(a){switch(a){case goog.events.KeyCodes.FF_EQUALS:return goog.events.KeyCodes.EQUALS;case goog.events.KeyCodes.FF_SEMICOLON:return goog.events.KeyCodes.SEMICOLON;case goog.events.KeyCodes.MAC_FF_META:return goog.events.KeyCodes.META;case goog.events.KeyCodes.WIN_KEY_FF_LINUX:return goog.events.KeyCodes.WIN_KEY;default:return a}};goog.events.KeyHandler=function(a,b){goog.events.EventTarget.call(this);a&&this.attach(a,b)};goog.inherits(goog.events.KeyHandler,goog.events.EventTarget);goog.events.KeyHandler.prototype.element_=null;goog.events.KeyHandler.prototype.keyPressKey_=null;goog.events.KeyHandler.prototype.keyDownKey_=null;goog.events.KeyHandler.prototype.keyUpKey_=null;goog.events.KeyHandler.prototype.lastKey_=-1;goog.events.KeyHandler.prototype.keyCode_=-1;goog.events.KeyHandler.prototype.altKey_=!1;
goog.events.KeyHandler.EventType={KEY:"key"};
goog.events.KeyHandler.safariKey_={3:goog.events.KeyCodes.ENTER,12:goog.events.KeyCodes.NUMLOCK,63232:goog.events.KeyCodes.UP,63233:goog.events.KeyCodes.DOWN,63234:goog.events.KeyCodes.LEFT,63235:goog.events.KeyCodes.RIGHT,63236:goog.events.KeyCodes.F1,63237:goog.events.KeyCodes.F2,63238:goog.events.KeyCodes.F3,63239:goog.events.KeyCodes.F4,63240:goog.events.KeyCodes.F5,63241:goog.events.KeyCodes.F6,63242:goog.events.KeyCodes.F7,63243:goog.events.KeyCodes.F8,63244:goog.events.KeyCodes.F9,63245:goog.events.KeyCodes.F10,
63246:goog.events.KeyCodes.F11,63247:goog.events.KeyCodes.F12,63248:goog.events.KeyCodes.PRINT_SCREEN,63272:goog.events.KeyCodes.DELETE,63273:goog.events.KeyCodes.HOME,63275:goog.events.KeyCodes.END,63276:goog.events.KeyCodes.PAGE_UP,63277:goog.events.KeyCodes.PAGE_DOWN,63289:goog.events.KeyCodes.NUMLOCK,63302:goog.events.KeyCodes.INSERT};
goog.events.KeyHandler.keyIdentifier_={Up:goog.events.KeyCodes.UP,Down:goog.events.KeyCodes.DOWN,Left:goog.events.KeyCodes.LEFT,Right:goog.events.KeyCodes.RIGHT,Enter:goog.events.KeyCodes.ENTER,F1:goog.events.KeyCodes.F1,F2:goog.events.KeyCodes.F2,F3:goog.events.KeyCodes.F3,F4:goog.events.KeyCodes.F4,F5:goog.events.KeyCodes.F5,F6:goog.events.KeyCodes.F6,F7:goog.events.KeyCodes.F7,F8:goog.events.KeyCodes.F8,F9:goog.events.KeyCodes.F9,F10:goog.events.KeyCodes.F10,F11:goog.events.KeyCodes.F11,F12:goog.events.KeyCodes.F12,
"U+007F":goog.events.KeyCodes.DELETE,Home:goog.events.KeyCodes.HOME,End:goog.events.KeyCodes.END,PageUp:goog.events.KeyCodes.PAGE_UP,PageDown:goog.events.KeyCodes.PAGE_DOWN,Insert:goog.events.KeyCodes.INSERT};goog.events.KeyHandler.USES_KEYDOWN_=goog.userAgent.IE||goog.userAgent.WEBKIT&&goog.userAgent.isVersionOrHigher("525");goog.events.KeyHandler.SAVE_ALT_FOR_KEYPRESS_=goog.userAgent.MAC&&goog.userAgent.GECKO;
goog.events.KeyHandler.prototype.handleKeyDown_=function(a){if(goog.userAgent.WEBKIT&&(this.lastKey_==goog.events.KeyCodes.CTRL&&!a.ctrlKey||this.lastKey_==goog.events.KeyCodes.ALT&&!a.altKey||goog.userAgent.MAC&&this.lastKey_==goog.events.KeyCodes.META&&!a.metaKey))this.keyCode_=this.lastKey_=-1;-1==this.lastKey_&&(a.ctrlKey&&a.keyCode!=goog.events.KeyCodes.CTRL?this.lastKey_=goog.events.KeyCodes.CTRL:a.altKey&&a.keyCode!=goog.events.KeyCodes.ALT?this.lastKey_=goog.events.KeyCodes.ALT:a.metaKey&&
a.keyCode!=goog.events.KeyCodes.META&&(this.lastKey_=goog.events.KeyCodes.META));goog.events.KeyHandler.USES_KEYDOWN_&&!goog.events.KeyCodes.firesKeyPressEvent(a.keyCode,this.lastKey_,a.shiftKey,a.ctrlKey,a.altKey)?this.handleEvent(a):(this.keyCode_=goog.userAgent.GECKO?goog.events.KeyCodes.normalizeGeckoKeyCode(a.keyCode):a.keyCode,goog.events.KeyHandler.SAVE_ALT_FOR_KEYPRESS_&&(this.altKey_=a.altKey))};goog.events.KeyHandler.prototype.resetState=function(){this.keyCode_=this.lastKey_=-1};
goog.events.KeyHandler.prototype.handleKeyup_=function(a){this.resetState();this.altKey_=a.altKey};
goog.events.KeyHandler.prototype.handleEvent=function(a){var b=a.getBrowserEvent(),c,d,e=b.altKey;goog.userAgent.IE&&a.type==goog.events.EventType.KEYPRESS?(c=this.keyCode_,d=c!=goog.events.KeyCodes.ENTER&&c!=goog.events.KeyCodes.ESC?b.keyCode:0):goog.userAgent.WEBKIT&&a.type==goog.events.EventType.KEYPRESS?(c=this.keyCode_,d=0<=b.charCode&&63232>b.charCode&&goog.events.KeyCodes.isCharacterKey(c)?b.charCode:0):goog.userAgent.OPERA?(c=this.keyCode_,d=goog.events.KeyCodes.isCharacterKey(c)?b.keyCode:
0):(c=b.keyCode||this.keyCode_,d=b.charCode||0,goog.events.KeyHandler.SAVE_ALT_FOR_KEYPRESS_&&(e=this.altKey_),goog.userAgent.MAC&&(d==goog.events.KeyCodes.QUESTION_MARK&&c==goog.events.KeyCodes.WIN_KEY)&&(c=goog.events.KeyCodes.SLASH));var f=c,g=b.keyIdentifier;c?63232<=c&&c in goog.events.KeyHandler.safariKey_?f=goog.events.KeyHandler.safariKey_[c]:25==c&&a.shiftKey&&(f=9):g&&g in goog.events.KeyHandler.keyIdentifier_&&(f=goog.events.KeyHandler.keyIdentifier_[g]);a=f==this.lastKey_;this.lastKey_=
f;b=new goog.events.KeyEvent(f,d,a,b);b.altKey=e;this.dispatchEvent(b)};goog.events.KeyHandler.prototype.getElement=function(){return this.element_};
goog.events.KeyHandler.prototype.attach=function(a,b){this.keyUpKey_&&this.detach();this.element_=a;this.keyPressKey_=goog.events.listen(this.element_,goog.events.EventType.KEYPRESS,this,b);this.keyDownKey_=goog.events.listen(this.element_,goog.events.EventType.KEYDOWN,this.handleKeyDown_,b,this);this.keyUpKey_=goog.events.listen(this.element_,goog.events.EventType.KEYUP,this.handleKeyup_,b,this)};
goog.events.KeyHandler.prototype.detach=function(){this.keyPressKey_&&(goog.events.unlistenByKey(this.keyPressKey_),goog.events.unlistenByKey(this.keyDownKey_),goog.events.unlistenByKey(this.keyUpKey_),this.keyUpKey_=this.keyDownKey_=this.keyPressKey_=null);this.element_=null;this.keyCode_=this.lastKey_=-1};goog.events.KeyHandler.prototype.disposeInternal=function(){goog.events.KeyHandler.superClass_.disposeInternal.call(this);this.detach()};
goog.events.KeyEvent=function(a,b,c,d){goog.events.BrowserEvent.call(this,d);this.type=goog.events.KeyHandler.EventType.KEY;this.keyCode=a;this.charCode=b;this.repeat=c};goog.inherits(goog.events.KeyEvent,goog.events.BrowserEvent);X.interactor=function(a){X.base.call(this);this._classname="interactor";this._element=a;this._mouseWheelHandler=this._mouseOutListener=this._mouseMoveListener=this._mouseUpListener=this._mouseDownListener=this._mouseWheelListener=null;this._mouseInside=!0;this._rightButtonDown=this._middleButtonDown=this._leftButtonDown=!1;this._mousePosition=[0,0];this._lastMousePosition=new X.vector(0,0,0);this._lastTouchPosition=new X.vector(0,0,0);this.lastFingerDistance=0;this._touchHoverTrigger=this._hoverTrigger=
null;this._shiftDown=!1;this._config={MOUSEWHEEL_ENABLED:!0,MOUSECLICKS_ENABLED:!0,KEYBOARD_ENABLED:!0,HOVERING_ENABLED:!0,CONTEXTMENU_ENABLED:!1,TOUCH_ENABLED:!0,TOUCH_BOUNCING_ENABLED:!1}};goog.inherits(X.interactor,X.base);X.interactor.prototype.__defineGetter__("config",function(){return this._config});X.interactor.prototype.__defineGetter__("leftButtonDown",function(){return this._leftButtonDown});X.interactor.prototype.__defineGetter__("middleButtonDown",function(){return this._middleButtonDown});
X.interactor.prototype.__defineGetter__("rightButtonDown",function(){return this._rightButtonDown});
X.interactor.prototype.init=function(){this._config.MOUSEWHEEL_ENABLED?(this._mouseWheelHandler=new goog.events.MouseWheelHandler(this._element),this._mouseWheelListener=goog.events.listen(this._mouseWheelHandler,goog.events.MouseWheelHandler.EventType.MOUSEWHEEL,this.onMouseWheel_.bind(this))):(goog.events.unlistenByKey(this._mouseWheelListener),this._mouseWheelHandler=null);this._config.MOUSECLICKS_ENABLED?(this._mouseDownListener=goog.events.listen(this._element,goog.events.EventType.MOUSEDOWN,
this.onMouseDown_.bind(this)),this._mouseUpListener=goog.events.listen(this._element,goog.events.EventType.MOUSEUP,this.onMouseUp_.bind(this))):(goog.events.unlistenByKey(this._mouseDownListener),goog.events.unlistenByKey(this._mouseUpListener));this._element.oncontextmenu=this._config.CONTEXTMENU_ENABLED?null:function(){return!1};window.onkeydown=this._config.KEYBOARD_ENABLED?this.onKey_.bind(this):null;this._config.TOUCH_ENABLED?(this._config.TOUCH_BOUNCING_ENABLED||document.body.addEventListener("touchmove",
function(a){a.preventDefault()},!1),this._touchStartListener=goog.events.listen(this._element,goog.events.EventType.TOUCHSTART,this.onTouchStart_.bind(this)),this._touchMoveListener=goog.events.listen(this._element,goog.events.EventType.TOUCHMOVE,this.onTouchMove_.bind(this)),this._touchEndListener=goog.events.listen(this._element,goog.events.EventType.TOUCHEND,this.onTouchEnd_.bind(this))):(goog.events.unlistenByKey(this._touchStartListener),goog.events.unlistenByKey(this._touchMoveListener),goog.events.unlistenByKey(this._touchEndListener));
goog.events.unlistenByKey(this._mouseMoveListener);goog.events.unlistenByKey(this._mouseOutListener);this._mouseMoveListener=goog.events.listen(this._element,goog.events.EventType.MOUSEMOVE,this.onMouseMovementInside_.bind(this));this._mouseOutListener=goog.events.listen(this._element,goog.events.EventType.MOUSEOUT,this.onMouseMovementOutside_.bind(this))};
X.interactor.prototype.onMouseDown_=function(a){a.button==goog.events.BrowserEvent.MouseButton.LEFT?this._leftButtonDown=!0:a.button==goog.events.BrowserEvent.MouseButton.MIDDLE?this._middleButtonDown=!0:a.button==goog.events.BrowserEvent.MouseButton.RIGHT&&(this._rightButtonDown=!0);eval("this.onMouseDown("+this._leftButtonDown+","+this._middleButtonDown+","+this._rightButtonDown+")");this.hoverEnd_();a.preventDefault()};X.interactor.prototype.onMouseDown=function(){};
X.interactor.prototype.onMouseUp_=function(a){a.button==goog.events.BrowserEvent.MouseButton.LEFT?this._leftButtonDown=!1:a.button==goog.events.BrowserEvent.MouseButton.MIDDLE?this._middleButtonDown=!1:a.button==goog.events.BrowserEvent.MouseButton.RIGHT&&(this._rightButtonDown=!1);eval("this.onMouseUp("+this._leftButtonDown+","+this._middleButtonDown+","+this._rightButtonDown+")");this.hoverEnd_();a.preventDefault()};X.interactor.prototype.__defineGetter__("mousePosition",function(){return this._mousePosition});
X.interactor.prototype.onMouseUp=function(){};X.interactor.prototype.onMouseMovementOutside_=function(a){this._mouseInside=!1;this._config.KEYBOARD_ENABLED&&(window.onkeydown=null);this._rightButtonDown=this._middleButtonDown=this._leftButtonDown=!1;this.hoverEnd_();this._lastMousePosition=new X.vector(0,0,0);a.preventDefault()};X.interactor.prototype.onMouseMove=function(){};
X.interactor.prototype.onTouchStart_=function(a){a.preventDefault();a.init(a.getBrowserEvent().targetTouches[0],a.currentTarget);eval("this.onTouchStart("+a.clientX+","+a.clientY+")");this._lastTouchPosition=new X.vector(a.clientX,a.clientY,0);this._touchHoverTrigger=setTimeout(this.onTouchHover_.bind(this,a),500)};X.interactor.prototype.onTouchStart=function(){};
X.interactor.prototype.onTouchHover_=function(a){eval("this.onTouchHover("+a.clientX+","+a.clientY+")");a=new X.event.ZoomEvent;a._in=!0;a._fast=this instanceof X.interactor3D;this.dispatchEvent(a);this._touchHovering=!0};X.interactor.prototype.onTouchHover=function(){};
X.interactor.prototype.resetTouchHover_=function(){clearTimeout(this._touchHoverTrigger);if(this._touchHovering){var a=new X.event.ZoomEvent;a._in=!1;a._fast=this instanceof X.interactor3D;this.dispatchEvent(a)}this._touchHovering=!1};X.interactor.prototype.onTouchEnd_=function(a){a.preventDefault();eval("this.onTouchEnd()");this.resetTouchHover_()};X.interactor.prototype.onTouchEnd=function(){};
X.interactor.prototype.onTouchMove_=function(a){a.preventDefault();this._touchHovering||this.resetTouchHover_();this.touchmoveEvent=a=a.getBrowserEvent();eval("this.onTouchMove(this['touchmoveEvent'])");var b=a.targetTouches;if(1==b.length){a=b[0];var c=[a.clientX,a.clientY];a=new X.vector(c[0],c[1],0);var b=c[0]>3*this._element.clientWidth/4,d=c[0]<this._element.clientWidth/4,e=c[1]<this._element.clientHeight/4,c=c[1]>3*this._element.clientHeight/4,c=!b&&!d&&!e&&!c,e=this._lastTouchPosition.subtract(a);
this._lastTouchPosition=a.clone();if(this._touchHovering)a=new X.event.PanEvent,5<e.x?e.x=1:-5>e.x&&(e.x=-1),5<e.y?e.y=1:-5>e.y&&(e.y=-1),a._distance=e,this.dispatchEvent(a);else if(this instanceof X.interactor2D&&(b||d))a=new X.event.ScrollEvent,a._up=0>e.y,this.dispatchEvent(a);else if(this instanceof X.interactor3D||c)e.scale(3),a=new X.event.RotateEvent,a._distance=e,this.dispatchEvent(a)}else 2==b.length&&(a=b[0],b=b[1],a=[a.clientX,a.clientY],b=[b.clientX,b.clientY],a=new X.vector(a[0],a[1],
0),b=new X.vector(b[0],b[1],0),e=goog.math.Vec3.squaredDistance(a,b),b=e-this.lastFingerDistance,this.lastFingerDistance=e,this._lastTouchPosition.subtract(a),this._lastTouchPosition=a.clone(),10<Math.abs(b)&&(a=new X.event.ZoomEvent,a._in=0<b,a._fast=this instanceof X.interactor3D,this.dispatchEvent(a)))};X.interactor.prototype.onTouchMove=function(){};
X.interactor.prototype.onMouseMovementInside_=function(a){this.mousemoveEvent=a;eval("this.onMouseMove(this['mousemoveEvent'])");this._mouseInside=!0;this._config.KEYBOARD_ENABLED&&null==window.onkeydown&&(window.onkeydown=this.onKey_.bind(this));a.preventDefault();var b=a.shiftKey;this._shiftDown=b;this._mousePosition=[a.offsetX,a.offsetY];var c=new X.vector(this._mousePosition[0],this._mousePosition[1],0);a=this._lastMousePosition.subtract(c);this._lastMousePosition=c.clone();this._config.HOVERING_ENABLED&&
((0<Math.abs(a.x)||0<Math.abs(a.y)||this._middleButtonDown||this._leftButtonDown||this._rightButtonDown)&&this.hoverEnd_(),this._hoverTrigger=setTimeout(function(){this.hoverEnd_();var a=new X.event.HoverEvent;a._x=c.x;a._y=c.y;this.dispatchEvent(a);this._hoverTrigger=null}.bind(this),300));0!=a.magnitude()&&(this._leftButtonDown&&!b?(b=new X.event.RotateEvent,a.scale(3),b._distance=a,this.dispatchEvent(b)):this._middleButtonDown||this._leftButtonDown&&b?(b=new X.event.PanEvent,b._distance=a,this.dispatchEvent(b)):
this._rightButtonDown&&(b=new X.event.ZoomEvent,b._in=0<a.y,b._fast=!1,this.dispatchEvent(b)))};X.interactor.prototype.hoverEnd_=function(){this._hoverTrigger&&clearTimeout(this._hoverTrigger);var a=new X.event.HoverEndEvent;this.dispatchEvent(a)};X.interactor.prototype.onMouseWheel=function(){};X.interactor.prototype.onMouseWheel_=function(a){this.mouseWheelEvent=a;eval("this.onMouseWheel(this['mouseWheelEvent'])");this.hoverEnd_();a.preventDefault()};X.interactor.prototype.onKey=function(){};
X.interactor.prototype.onKey_=function(a){if(this._mouseInside){this.keyEvent=a;eval("this.onKey(this['keyEvent'])");this.hoverEnd_();var b=a.altKey,c=a.ctrlKey,d=a.metaKey,e=a.shiftKey,f=a.keyCode;82==f&&!b&&!c&&!d&&!e?(a.preventDefault(),a=new X.event.ResetViewEvent,this.dispatchEvent(a)):37<=f&&40>=f&&(a.preventDefault(),e?a=new X.event.PanEvent:b?a=new X.event.ZoomEvent:(a=new X.event.RotateEvent,this instanceof X.interactor2D&&(a=new X.event.ScrollEvent)),a&&(c=new X.vector(0,0,0),37==f?(c.x=
5,a._up=!1,b&&(a._up=!0,a._in=!0,a._fast=!1)):39==f?(c.x=-5,a._up=!0,b&&(a._in=!1,a._fast=!1)):38==f?(c.y=5,a._up=!0,b&&(a._in=!0,a._fast=!0)):40==f&&(c.y=-5,a._up=!1,b&&(a._in=!1,a._fast=!0)),a._distance=c,this.dispatchEvent(a)))}};goog.exportSymbol("X.interactor",X.interactor);goog.exportSymbol("X.interactor.prototype.init",X.interactor.prototype.init);goog.exportSymbol("X.interactor.prototype.onMouseDown",X.interactor.prototype.onMouseDown);
goog.exportSymbol("X.interactor.prototype.onMouseUp",X.interactor.prototype.onMouseUp);goog.exportSymbol("X.interactor.prototype.onMouseMove",X.interactor.prototype.onMouseMove);goog.exportSymbol("X.interactor.prototype.onMouseWheel",X.interactor.prototype.onMouseWheel);goog.exportSymbol("X.interactor.prototype.onKey",X.interactor.prototype.onKey);goog.exportSymbol("X.interactor.prototype.onTouchStart",X.interactor.prototype.onTouchStart);goog.exportSymbol("X.interactor.prototype.onTouchMove",X.interactor.prototype.onTouchMove);
goog.exportSymbol("X.interactor.prototype.onTouchEnd",X.interactor.prototype.onTouchEnd);goog.exportSymbol("X.interactor.prototype.onTouchHover",X.interactor.prototype.onTouchHover);X.interactor2D=function(a){X.interactor.call(this,a);this._classname="interactor2D"};goog.inherits(X.interactor2D,X.interactor);X.interactor2D.prototype.onMouseWheel_=function(a){X.interactor2D.superClass_.onMouseWheel_.call(this,a);var b=new X.event.ScrollEvent;goog.isDefAndNotNull(a.deltaY)||(a.deltaY=0);b._up=0>a.deltaY;this.dispatchEvent(b)};X.camera=function(a,b){if(!goog.isNumber(a)||!goog.isNumber(b))throw Error("A camera needs valid width and height values.");X.base.call(this);this._classname="camera";this._position=new X.vector(0,100,0);this._focus=new X.vector(0,0,0);this._up=new X.vector(0,0,1);this._width=a;this._height=b;this._view=this.lookAt_(this._position,this._focus)};goog.inherits(X.camera,X.base);
X.camera.prototype.observe=function(a){if(!goog.isDefAndNotNull(a)||!(a instanceof X.interactor))throw Error("Could not observe the interactor.");goog.events.listen(a,X.event.events.ROTATE,this.onRotate_.bind(this));goog.events.listen(a,X.event.events.PAN,this.onPan_.bind(this));goog.events.listen(a,X.event.events.ZOOM,this.onZoom_.bind(this))};X.camera.prototype.onRotate_=function(a){if(!(a instanceof X.event.RotateEvent))throw Error("Received no valid rotate event.");this.rotate(a._distance)};
X.camera.prototype.onZoom_=function(a){if(!(a instanceof X.event.ZoomEvent))throw Error("Received no valid zoom event.");a._in?this.zoomIn(a._fast):this.zoomOut(a._fast)};X.camera.prototype.onPan_=function(a){if(!(a instanceof X.event.PanEvent))throw Error("Received no valid pan event.");this.pan(a._distance)};X.camera.prototype.__defineGetter__("view",function(){return this._view});
X.camera.prototype.__defineSetter__("view",function(a){if(!goog.isDefAndNotNull(a)||!(a instanceof Float32Array))throw Error("Invalid view matrix.");this._view=a});X.camera.prototype.__defineGetter__("position",function(){return[this._position.x,this._position.y,this._position.z]});X.camera.prototype.__defineSetter__("position",function(a){if(!goog.isDefAndNotNull(a)||!goog.isArray(a)||3!=a.length)throw Error("Invalid position.");this._position=new X.vector(a[0],a[1],a[2]);this.reset()});
X.camera.prototype.__defineGetter__("focus",function(){return[this._focus.x,this._focus.y,this._focus.z]});X.camera.prototype.__defineSetter__("focus",function(a){if(!goog.isDefAndNotNull(a)||!goog.isArray(a)||3!=a.length)throw Error("Invalid focus");this._focus=new X.vector(a[0],a[1],a[2]);this.reset()});X.camera.prototype.__defineGetter__("up",function(){return[this._up.x,this._up.y,this._up.z]});
X.camera.prototype.__defineSetter__("up",function(a){if(!goog.isDefAndNotNull(a)||!goog.isArray(a)||3!=a.length)throw Error("Invalid up vector.");this._up=new X.vector(a[0],a[1],a[2]);this.reset()});X.camera.prototype.reset=function(){this._view=this.lookAt_(this._position,this._focus)};X.camera.prototype.rotate=function(a){if(goog.isArray(a)&&2==a.length)a=new X.vector(a[0],a[1],0);else if(!(a instanceof X.vector))throw Error("Invalid distance vector for rotate operation.");return a};
X.camera.prototype.pan=function(a){if(goog.isArray(a)&&2==a.length)a=new X.vector(a[0],a[1],0);else if(!(a instanceof X.vector))throw Error("Invalid distance vector for pan operation.");this._view[12]-=a.x;this._view[13]+=a.y};X.camera.prototype.zoomIn=function(a){var b=20;goog.isDefAndNotNull(a)&&!a&&(b=1);this._view[14]+=b};X.camera.prototype.zoomOut=function(a){var b=20;goog.isDefAndNotNull(a)&&!a&&(b=1);this._view[14]-=b};
X.camera.prototype.lookAt_=function(a,b){if(!(a instanceof X.vector)||!(b instanceof X.vector))throw Error("3D vectors required for calculating the view.");return X.matrix.identity()};goog.exportSymbol("X.camera",X.camera);goog.exportSymbol("X.camera.prototype.pan",X.camera.prototype.pan);goog.exportSymbol("X.camera.prototype.rotate",X.camera.prototype.rotate);goog.exportSymbol("X.camera.prototype.zoomIn",X.camera.prototype.zoomIn);goog.exportSymbol("X.camera.prototype.zoomOut",X.camera.prototype.zoomOut);X.camera3D=function(a,b){X.camera.call(this,a,b);this._classname="camera3D";this._fieldOfView=45;this._perspective=X.matrix.makePerspective(X.matrix.identity(),this._fieldOfView,a/b,1,1E4)};goog.inherits(X.camera3D,X.camera);
X.camera3D.prototype.rotate=function(a){a=X.camera3D.superClass_.rotate.call(this,a);var b=-a.x/5*Math.PI/180;a=-a.y/5*Math.PI/180;var c=new X.vector(this._view[1],this._view[5],this._view[9]),d=new X.vector(this._view[0],this._view[4],this._view[8]);c.normalize();d.normalize();X.matrix.rotate(this._view,b,c.x,c.y,c.z);X.matrix.rotate(this._view,a,d.x,d.y,d.z)};X.camera3D.prototype.lookAt_=function(a,b){var c=X.camera3D.superClass_.lookAt_.call(this,a,b);X.matrix.makeLookAt(c,a,b,this._up);return c};
X.camera3D.prototype.unproject_=function(a,b,c){var d=new Float32Array(4),e=new Float32Array(4),f=new Float32Array(16),g=new Float32Array(16);new Float32Array(16);X.matrix.multiply(this._perspective,this._view,g);X.matrix.invert(g,f);d[0]=a;d[1]=b;d[2]=2*c-1;d[3]=1;X.matrix.multiplyByVec4(f,d,e);e[3]=1/e[3];e[0]*=e[3];e[1]*=e[3];e[2]*=e[3];return e};goog.exportSymbol("X.camera3D",X.camera3D);X.parser=function(){X.base.call(this);this._classname="parser";this._data=null;this._dataPointer=0;this._nativeLittleEndian=0<(new Int8Array((new Int16Array([1])).buffer))[0];this._littleEndian=!0;this._lastMin=-Infinity;this._lastMax=Infinity};goog.inherits(X.parser,X.base);X.parser.prototype.parse=function(){throw Error("The function parse() should be overloaded.");};
X.parser.prototype.arrayMinMax=function(a){for(var b=Infinity,c=-Infinity,d=a.length,e=0,e=0;e<d;e++)if(!isNaN(a[e]))var f=a[e],b=Math.min(b,f),c=Math.max(c,f);return[b,c]};X.parser.prototype.parseChars=function(a,b,c){void 0===b&&(b=0);void 0===c&&(c=a.length);for(var d="",e=0,e=b;e<c;++e)d+=String.fromCharCode(a[e]);return d};X.parser.prototype.jumpTo=function(a){this._dataPointer=a};
X.parser.prototype.scan=function(a,b){goog.isDefAndNotNull(b)||(b=1);var c=1,d=Uint8Array;switch(a){case "schar":d=Int8Array;break;case "ushort":d=Uint16Array;c=2;break;case "sshort":d=Int16Array;c=2;break;case "uint":d=Uint32Array;c=4;break;case "sint":d=Int32Array;c=4;break;case "float":d=Float32Array;c=4;break;case "complex":d=Float64Array;c=8;break;case "double":d=Float64Array,c=8}d=new d(this._data.slice(this._dataPointer,this._dataPointer+=b*c));this._nativeLittleEndian!=this._littleEndian&&
(d=this.flipEndianness(d,c));return 1==b?d[0]:d};X.parser.prototype.flipEndianness=function(a,b){for(var c=new Uint8Array(a.buffer,a.byteOffset,a.byteLength),d=0;d<a.byteLength;d+=b)for(var e=d+b-1,f=d;e>f;e--,f++){var g=c[f];c[f]=c[e];c[e]=g}return a};
X.parser.computeRASBBox=function(a,b){var c=[Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE],d=goog.vec.Vec4.createFloat32FromValues(0,0,0,1),e=goog.vec.Vec4.createFloat32();goog.vec.Mat4.multVec4(a,d,e);c[0]=e[0]<c[0]?e[0]:c[0];c[1]=e[0]>c[1]?e[0]:c[1];c[2]=e[1]<c[2]?e[1]:c[2];c[3]=e[1]>c[3]?e[1]:c[3];c[4]=e[2]<c[4]?e[2]:c[4];c[5]=e[2]>c[5]?e[2]:c[5];d=goog.vec.Vec4.createFloat32FromValues(0,0,b[2]-1,1);goog.vec.Mat4.multVec4(a,d,e);c[0]=
e[0]<c[0]?e[0]:c[0];c[1]=e[0]>c[1]?e[0]:c[1];c[2]=e[1]<c[2]?e[1]:c[2];c[3]=e[1]>c[3]?e[1]:c[3];c[4]=e[2]<c[4]?e[2]:c[4];c[5]=e[2]>c[5]?e[2]:c[5];d=goog.vec.Vec4.createFloat32FromValues(0,b[1]-1,0,1);goog.vec.Mat4.multVec4(a,d,e);c[0]=e[0]<c[0]?e[0]:c[0];c[1]=e[0]>c[1]?e[0]:c[1];c[2]=e[1]<c[2]?e[1]:c[2];c[3]=e[1]>c[3]?e[1]:c[3];c[4]=e[2]<c[4]?e[2]:c[4];c[5]=e[2]>c[5]?e[2]:c[5];d=goog.vec.Vec4.createFloat32FromValues(b[0]-1,0,0,1);goog.vec.Mat4.multVec4(a,d,e);c[0]=e[0]<c[0]?e[0]:c[0];c[1]=e[0]>c[1]?
e[0]:c[1];c[2]=e[1]<c[2]?e[1]:c[2];c[3]=e[1]>c[3]?e[1]:c[3];c[4]=e[2]<c[4]?e[2]:c[4];c[5]=e[2]>c[5]?e[2]:c[5];d=goog.vec.Vec4.createFloat32FromValues(b[0]-1,b[1]-1,0,1);goog.vec.Mat4.multVec4(a,d,e);c[0]=e[0]<c[0]?e[0]:c[0];c[1]=e[0]>c[1]?e[0]:c[1];c[2]=e[1]<c[2]?e[1]:c[2];c[3]=e[1]>c[3]?e[1]:c[3];c[4]=e[2]<c[4]?e[2]:c[4];c[5]=e[2]>c[5]?e[2]:c[5];d=goog.vec.Vec4.createFloat32FromValues(b[0]-1,0,b[2]-1,1);goog.vec.Mat4.multVec4(a,d,e);c[0]=e[0]<c[0]?e[0]:c[0];c[1]=e[0]>c[1]?e[0]:c[1];c[2]=e[1]<c[2]?
e[1]:c[2];c[3]=e[1]>c[3]?e[1]:c[3];c[4]=e[2]<c[4]?e[2]:c[4];c[5]=e[2]>c[5]?e[2]:c[5];d=goog.vec.Vec4.createFloat32FromValues(0,b[1]-1,b[2]-1,1);goog.vec.Mat4.multVec4(a,d,e);c[0]=e[0]<c[0]?e[0]:c[0];c[1]=e[0]>c[1]?e[0]:c[1];c[2]=e[1]<c[2]?e[1]:c[2];c[3]=e[1]>c[3]?e[1]:c[3];c[4]=e[2]<c[4]?e[2]:c[4];c[5]=e[2]>c[5]?e[2]:c[5];d=goog.vec.Vec4.createFloat32FromValues(b[0]-1,b[1]-1,b[2]-1,1);goog.vec.Mat4.multVec4(a,d,e);c[0]=e[0]<c[0]?e[0]:c[0];c[1]=e[0]>c[1]?e[0]:c[1];c[2]=e[1]<c[2]?e[1]:c[2];c[3]=e[1]>
c[3]?e[1]:c[3];c[4]=e[2]<c[4]?e[2]:c[4];c[5]=e[2]>c[5]?e[2]:c[5];return c};X.parser.createIJKVolume=function(a,b,c,d){for(var e=Array(b[2]),f=Array(b[2]),g=b[1]*b[0],h=0,k=0,j=0,m=0,l=0,m=0;m<b[2];m++){var n=a.subarray(m*g,(m+1)*g),l=0;f[m]=Array(b[1]);e[m]=Array(b[1]);for(j=0;j<b[1];j++){f[m][j]=new a.constructor(b[0]);e[m][j]=new a.constructor(b[0]);for(k=0;k<b[0];k++)h=n[l],f[m][j][k]=255*((h-d)/(c-d)),e[m][j][k]=h,l++}}return[e,f]};
X.parser.intersectionBBoxLine=function(a,b,c){for(var d=[],e=[],f=0;6>f;f++){var g=Math.floor(f/2),h=(g+1)%3,k=(g+2)%3,j=(2+2*g)%6,m=(4+2*g)%6,l=(a[f]-b[g])*(1/c[g]);if(Infinity!=l&&-Infinity!=l){var n=b[h]+c[h]*l,l=b[k]+c[k]*l;n>=a[j]&&n<=a[j+1]&&l>=a[m]&&l<=a[m+1]?(j=[],j[g]=a[f],j[h]=n,j[k]=l,d.push(j)):(j=[],j[g]=a[f],j[h]=n,j[k]=l,e.push(j))}}return[d,e]};
X.parser.intersectionBBoxPlane=function(a,b,c){for(var d=[],e=[],f=0;6>f;f++)for(var g=Math.floor(f/2),h=(g+1)%3,k=(g+2)%3,j=(4+2*g)%6,m=0;2>m;m++){var l=(2+m+2*g)%6,n=-(c[g]*(a[f]-b[g])+c[h]*(a[l]-b[h]))/c[k]+b[k];if(n>=a[j]&&n<=a[j+1]||n<=a[j]&&n>=a[j+1]){var p=[];p[g]=a[f];p[h]=a[l];p[k]=n;d.push(p)}else p=[],p[g]=a[f],p[h]=a[l],p[k]=n,e.push(p)}return[d,e]};
X.parser.xyrasTransform=function(a,b){var c=goog.vec.Mat4.createFloat32Identity();if(!goog.vec.Vec3.equals(a,b)){var d=Math.acos(a[2]),e=goog.vec.Vec3.createFloat32();goog.vec.Vec3.cross(a,b,e);goog.vec.Vec3.normalize(e,e);var f=Math.cos(d/2),g=Math.sin(d/2)*e[0],h=Math.sin(d/2)*e[1],d=Math.sin(d/2)*e[2];goog.vec.Mat4.setRowValues(c,0,f*f+g*g-h*h-d*d,2*(g*h-f*d),2*(g*d+f*h),0);goog.vec.Mat4.setRowValues(c,1,2*(g*h+f*d),f*f+h*h-g*g-d*d,2*(h*d-f*g),0);goog.vec.Mat4.setRowValues(c,2,2*(g*d-f*h),2*(h*
d+f*g),f*f+d*d-h*h-g*g,0)}f=goog.vec.Mat4.createFloat32();goog.vec.Mat4.invert(c,f);return[c,f]};X.parser.xyBBox=function(a){for(var b=[Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE],c=0,c=0;c<a.length;++c)a[c][0]<b[0]&&(b[0]=a[c][0]),a[c][0]>b[1]&&(b[1]=a[c][0]),a[c][1]<b[2]&&(b[2]=a[c][1]),a[c][1]>b[3]&&(b[3]=a[c][1]),a[c][2]<b[4]&&(b[4]=a[c][2]),a[c][2]>b[5]&&(b[5]=a[c][2]);return b};
X.parser.reslice2=function(a,b,c,d,e,f,g,h,k){var j=new X.slice;goog.vec.Vec3.normalize(c,c);e=X.parser.intersectionBBoxPlane(e,a,c)[0];a=goog.vec.Vec3.createFloat32FromValues(0,0,1);a=X.parser.xyrasTransform(c,a);var m=a[0];a=a[1];for(var l=[],n=0;n<e.length;++n){var p=goog.vec.Vec4.createFloat32FromValues(e[n][0],e[n][1],e[n][2],1),q=goog.vec.Vec4.createFloat32();goog.vec.Mat4.multVec4(m,p,q);l.push([q[0],q[1],q[2]])}n=goog.vec.Vec3.createFloat32FromValues(1,0,0);e=goog.vec.Vec3.createFloat32();
goog.vec.Mat4.multVec3(a,n,e);n=goog.vec.Vec3.createFloat32FromValues(0,1,0);m=goog.vec.Vec3.createFloat32();goog.vec.Mat4.multVec3(a,n,m);l=X.parser.xyBBox(l);n=goog.vec.Vec4.createFloat32FromValues(l[0]+(l[1]-l[0])/2,l[2]+(l[3]-l[2])/2,l[4]+(l[5]-l[4])/2,0);p=goog.vec.Vec4.createFloat32();goog.vec.Mat4.multMat(a,n,p);var q=Math.floor(l[0]),r=Math.ceil(l[1]);q==r&&r++;var s=r-q,z=Math.floor(l[2]),x=Math.ceil(l[3]);z==x&&x++;var t=x-z,u=b[0];b=b[1];var n=Math.ceil(s/u),v=Math.ceil(t/b),y=new Uint8Array(4*
n*v),B=new X.texture;B._rawDataWidth=n;B._rawDataHeight=v;var v=goog.vec.Vec4.createFloat32(),A=goog.vec.Vec4.createFloat32FromValues(0,0,l[4],1),D=goog.vec.Mat4.createFloat32();goog.vec.Mat4.multMat(g._RASToIJK,a,D);for(var G=x-1E-7,w=r-1E-7,C=0,H=0,E=0,F=z,F=z;F<=G;F+=b){E++;H=0;A[1]=F;for(n=q;n<=w;n+=u){H++;A[0]=n;goog.vec.Mat4.multVec4(D,A,v);var L=4*C,Q=Math.floor(v[2]),R=Math.floor(v[1]),S=Math.floor(v[0]);if(0<=S&&S<g._dimensions[0]&&0<=R&&R<g._dimensions[1]&&0<=Q&&Q<g._dimensions[2]){var N=
f[Q][R][S],U=S=R=Q=0;k?((N=k.get(N))||(N=[0,0.61,0,0,1]),Q=255*N[1],R=255*N[2],S=255*N[3],U=255*N[4]):(Q=R=S=255*((N-g._min)/(g._max-g._min)),U=255);y[L]=Q;y[++L]=R;y[++L]=S;y[++L]=U}else y[L]=0,y[++L]=0,y[++L]=0,y[++L]=0;C++}}B._rawData=y;j._texture=B;j._xyBBox=l;j._XYToRAS=a;j._XYToIJK=D;j._hmin=z;j._hmax=x;j._wmin=q;j._wmax=r;j._iWidth=H;j._iHeight=E;j._widthSpacing=u;j._width=s;j._heightSpacing=b;j._height=t;j._center=[p[0],p[1],p[2]];j._front=[c[0],c[1],c[2]];j._right=[e[0],e[1],e[2]];j._up=
[m[0],m[1],m[2]];j._visible=!1;j._volume=g;j._borders=goog.isDefAndNotNull(g._volume)&&!h?!1:!0;j._borderColor=d;j.create_();j._visible=!1;return j};
X.parser.prototype.updateSliceInfo=function(a,b,c,d){var e=X.parser.intersectionBBoxLine(d._BBox,b,c);b=e[0];d._childrenInfo[a]._solutionsLine=e;var e=new goog.math.Vec3(b[0][0],b[0][1],b[0][2]),f=new goog.math.Vec3(b[1][0],b[1][1],b[1][2]),e=goog.math.Vec3.distance(e,f);d._childrenInfo[a]._dist=e;var f=goog.vec.Vec3.createFloat32FromValues(0,0,1),g=X.parser.xyrasTransform(c,f)[0],h=goog.vec.Vec4.createFloat32FromValues(d._RASSpacing[0],d._RASSpacing[1],d._RASSpacing[2],0),f=goog.vec.Vec4.createFloat32();
goog.vec.Mat4.multVec4(g,h,f);g=goog.vec.Vec4.createFloat32();goog.vec.Vec4.scale(c,f[2],g);0.1>Math.abs(f[0])&&(f[0]=0.1);0.1>Math.abs(f[1])&&(f[1]=0.1);f[0]/=d._resolutionFactor;f[1]/=d._resolutionFactor;d._childrenInfo[a]._sliceXYSpacing=[Math.abs(f[0]),Math.abs(f[1])];d._childrenInfo[a]._sliceSpacing=f[2];d._childrenInfo[a]._sliceDirection=g;e=Math.floor(Math.abs(e/f[2]));d._range[a]=e+1;d._childrenInfo[a]._nb=e+1;d._childrenInfo[a]._solutionsLine[0][0][0]>d._childrenInfo[a]._solutionsLine[0][1][0]?
0<g[0]&&(e=d._childrenInfo[a]._solutionsLine[0][0],d._childrenInfo[a]._solutionsLine[0][0]=d._childrenInfo[a]._solutionsLine[0][1],d._childrenInfo[a]._solutionsLine[0][1]=e):d._childrenInfo[a]._solutionsLine[0][0][0]<d._childrenInfo[a]._solutionsLine[0][1][0]?0>g[0]&&(e=d._childrenInfo[a]._solutionsLine[0][0],d._childrenInfo[a]._solutionsLine[0][0]=d._childrenInfo[a]._solutionsLine[0][1],d._childrenInfo[a]._solutionsLine[0][1]=e):d._childrenInfo[a]._solutionsLine[0][0][1]>d._childrenInfo[a]._solutionsLine[0][1][1]?
0<g[1]&&(e=d._childrenInfo[a]._solutionsLine[0][0],d._childrenInfo[a]._solutionsLine[0][0]=d._childrenInfo[a]._solutionsLine[0][1],d._childrenInfo[a]._solutionsLine[0][1]=e):d._childrenInfo[a]._solutionsLine[0][0][1]<d._childrenInfo[a]._solutionsLine[0][1][1]?0>g[1]&&(e=d._childrenInfo[a]._solutionsLine[0][0],d._childrenInfo[a]._solutionsLine[0][0]=d._childrenInfo[a]._solutionsLine[0][1],d._childrenInfo[a]._solutionsLine[0][1]=e):d._childrenInfo[a]._solutionsLine[0][0][2]>d._childrenInfo[a]._solutionsLine[0][1][2]?
0<g[2]&&(e=d._childrenInfo[a]._solutionsLine[0][0],d._childrenInfo[a]._solutionsLine[0][0]=d._childrenInfo[a]._solutionsLine[0][1],d._childrenInfo[a]._solutionsLine[0][1]=e):d._childrenInfo[a]._solutionsLine[0][0][2]<d._childrenInfo[a]._solutionsLine[0][1][2]&&0>g[2]&&(e=d._childrenInfo[a]._solutionsLine[0][0],d._childrenInfo[a]._solutionsLine[0][0]=d._childrenInfo[a]._solutionsLine[0][1],d._childrenInfo[a]._solutionsLine[0][1]=e);d._childrenInfo[a]._originD=-(c[0]*b[0][0]+c[1]*b[0][1]+c[2]*b[0][2])};
X.parser.prototype.reslice=function(a){var b=X.parser.createIJKVolume(a._data,a._dimensions,a._max,a._min);a._IJKVolume=b[0];a._IJKVolumeN=b[1];X.TIMER(this._classname+".reslice");a.hasLabelMap=null!=a._labelmap;a._colortable&&(a._colorTable=a._colortable._map);a.range=[0,0,0];a._RASCenter=[a._RASOrigin[0]+(a._RASDimensions[0]-1)/2,a._RASOrigin[1]+(a._RASDimensions[1]-1)/2,a._RASOrigin[2]+(a._RASDimensions[2]-1)/2];a._BBox=[Math.min(a._RASOrigin[0],a._RASOrigin[0]+a._RASDimensions[0]-1),Math.max(a._RASOrigin[0],
a._RASOrigin[0]+a._RASDimensions[0]-1),Math.min(a._RASOrigin[1],a._RASOrigin[1]+a._RASDimensions[1]-1),Math.max(a._RASOrigin[1],a._RASOrigin[1]+a._RASDimensions[1]-1),Math.min(a._RASOrigin[2],a._RASOrigin[2]+a._RASDimensions[2]-1),Math.max(a._RASOrigin[2],a._RASOrigin[2]+a._RASDimensions[2]-1)];a._childrenInfo=[{},{},{}];b=goog.vec.Vec3.createFloat32FromValues(a._RASCenter[0],a._RASCenter[1],a._RASCenter[2]);a._childrenInfo[0]._sliceOrigin=b;var c=goog.vec.Vec3.createFloat32FromValues(1,0,0);goog.vec.Vec3.normalize(c,
c);a._childrenInfo[0]._sliceNormal=c;var d=[1,0,0];a._childrenInfo[0]._color=d;this.updateSliceInfo(0,b,c,a);a._children[0]._children=Array(a._childrenInfo[0]._nb);b[0]=a._childrenInfo[0]._solutionsLine[0][0][0]+a._childrenInfo[0]._sliceDirection[0]*Math.floor(a._childrenInfo[0]._nb/2);b[1]=a._childrenInfo[0]._solutionsLine[0][0][1]+a._childrenInfo[0]._sliceDirection[1]*Math.floor(a._childrenInfo[0]._nb/2);b[2]=a._childrenInfo[0]._solutionsLine[0][0][2]+a._childrenInfo[0]._sliceDirection[2]*Math.floor(a._childrenInfo[0]._nb/
2);b=X.parser.reslice2(b,a._childrenInfo[0]._sliceXYSpacing,a._childrenInfo[0]._sliceNormal,a._childrenInfo[0]._color,a._BBox,a._IJKVolume,a,a.hasLabelMap,a._colorTable);a.hasLabelMap&&(b._labelmap=a._labelmap._children[0]._children[Math.floor(a._childrenInfo[0]._nb/2)]._texture);a._children[0]._children[Math.floor(a._childrenInfo[0]._nb/2)]=b;a._indexX=Math.floor(a._childrenInfo[0]._nb/2);a._indexXold=Math.floor(a._childrenInfo[0]._nb/2);b=goog.vec.Vec3.createFloat32FromValues(a._RASCenter[0],a._RASCenter[1],
a._RASCenter[2]);a._childrenInfo[1]._sliceOrigin=b;c=goog.vec.Vec3.createFloat32FromValues(0,1,0);goog.vec.Vec3.normalize(c,c);a._childrenInfo[1]._sliceNormal=c;d=[0,1,0];a._childrenInfo[1]._color=d;this.updateSliceInfo(1,b,c,a);a._children[1]._children=Array(a._childrenInfo[1]._nb);b[0]=a._childrenInfo[1]._solutionsLine[0][0][0]+a._childrenInfo[1]._sliceDirection[0]*Math.floor(a._childrenInfo[1]._nb/2);b[1]=a._childrenInfo[1]._solutionsLine[0][0][1]+a._childrenInfo[1]._sliceDirection[1]*Math.floor(a._childrenInfo[1]._nb/
2);b[2]=a._childrenInfo[1]._solutionsLine[0][0][2]+a._childrenInfo[1]._sliceDirection[2]*Math.floor(a._childrenInfo[1]._nb/2);b=X.parser.reslice2(b,a._childrenInfo[1]._sliceXYSpacing,a._childrenInfo[1]._sliceNormal,a._childrenInfo[1]._color,a._BBox,a._IJKVolume,a,a.hasLabelMap,a._colorTable);a.hasLabelMap&&(b._labelmap=a._labelmap._children[1]._children[Math.floor(a._childrenInfo[1]._nb/2)]._texture);a._children[1]._children[Math.floor(a._childrenInfo[1]._nb/2)]=b;a._indexY=Math.floor(a._childrenInfo[1]._nb/
2);a._indexYold=Math.floor(a._childrenInfo[1]._nb/2);b=goog.vec.Vec3.createFloat32FromValues(a._RASCenter[0],a._RASCenter[1],a._RASCenter[2]);a._childrenInfo[2]._sliceOrigin=b;c=goog.vec.Vec3.createFloat32FromValues(0,0,1);goog.vec.Vec3.normalize(c,c);a._childrenInfo[2]._sliceNormal=c;d=[0,0.392,0.804];a._childrenInfo[2]._color=d;this.updateSliceInfo(2,b,c,a);a._children[2]._children=Array(a._childrenInfo[2]._nb);b[0]=a._childrenInfo[2]._solutionsLine[0][0][0]+a._childrenInfo[2]._sliceDirection[0]*
Math.floor(a._childrenInfo[2]._nb/2);b[1]=a._childrenInfo[2]._solutionsLine[0][0][1]+a._childrenInfo[2]._sliceDirection[1]*Math.floor(a._childrenInfo[2]._nb/2);b[2]=a._childrenInfo[2]._solutionsLine[0][0][2]+a._childrenInfo[2]._sliceDirection[2]*Math.floor(a._childrenInfo[2]._nb/2);b=X.parser.reslice2(b,a._childrenInfo[2]._sliceXYSpacing,a._childrenInfo[2]._sliceNormal,a._childrenInfo[2]._color,a._BBox,a._IJKVolume,a,a.hasLabelMap,a._colorTable);a.hasLabelMap&&(b._labelmap=a._labelmap._children[2]._children[Math.floor(a._childrenInfo[2]._nb/
2)]._texture);a._children[2]._children[Math.floor(a._childrenInfo[2]._nb/2)]=b;a._indexZ=Math.floor(a._childrenInfo[2]._nb/2);a._indexZold=Math.floor(a._childrenInfo[2]._nb/2);X.TIMERSTOP(this._classname+".reslice");return a._IJKVolume};X.parserIMAGE=function(){X.parser.call(this);this._classname="parserIMAGE"};goog.inherits(X.parserIMAGE,X.parser);X.parserIMAGE.prototype.parse=function(a,b,c,d){if(!(c instanceof ArrayBuffer))throw Error();for(var e=new Uint8Array(c),f=e.length,g=Array(f);f--;)g[f]=String.fromCharCode(e[f]);e=g.join("");e=window.btoa(e);f=new Image;goog.events.listenOnce(f,goog.events.EventType.LOAD,this.parseCompleted.bind(this,f,a,b,c,d));f.src="data:image/"+d+";base64,"+e};
X.parserIMAGE.prototype.parseCompleted=function(a,b,c){b._image=a;b._rawData=null;a=new X.event.ModifiedEvent;a._object=c;a._container=b;this.dispatchEvent(a)};goog.exportSymbol("X.parserIMAGE",X.parserIMAGE);goog.exportSymbol("X.parserIMAGE.prototype.parse",X.parserIMAGE.prototype.parse);X.camera2D=function(a,b){X.camera.call(this,a,b);this._classname="camera2D"};goog.inherits(X.camera2D,X.camera);X.camera2D.prototype.rotate=function(a){a=X.camera2D.superClass_.rotate.call(this,a);var b=new X.event.WindowLevelEvent;0<a.x?b._window--:0>a.x&&b._window++;0<a.y?b._level++:0>a.y&&b._level--;this.dispatchEvent(b)};X.camera2D.prototype.zoomIn=function(a){var b=20;goog.isDefAndNotNull(a)&&!a&&(b=0.02);this._view[14]+=b};
X.camera2D.prototype.zoomOut=function(a){var b=20;goog.isDefAndNotNull(a)&&!a&&(b=0.02);this._view[14]-=b};X.camera2D.prototype.pan=function(a){if(goog.isArray(a)&&2==a.length)a=new X.vector(a[0],a[1],0);else if(!(a instanceof X.vector))throw Error("Invalid distance vector for pan operation.");this._view[12]-=a.x/this._view[14];this._view[13]+=a.y/this._view[14]};X.shaders=function(){X.base.call(this);this._classname="shaders";this._vertexshaderSource="";var a;a="precision mediump float;\n\n";a+="attribute vec3 vertexPosition;\n";a+="attribute vec3 vertexNormal;\n";a+="attribute vec3 vertexColor;\n";a+="attribute vec2 vertexTexturePos;\n";a+="attribute float vertexScalar;\n";a+="\n";a+="uniform mat4 view;\n";a+="uniform mat4 perspective;\n";a+="uniform vec3 center;\n";a+="uniform mat4 objectTransform;\n";a+="uniform bool useObjectColor;\n";a+="uniform bool useScalars;\n";
a+="uniform bool scalarsReplaceMode;\n";a+="uniform float scalarsMin;\n";a+="uniform float scalarsMax;\n";a+="uniform vec3 scalarsMinColor;\n";a+="uniform vec3 scalarsMaxColor;\n";a+="uniform float scalarsMinThreshold;\n";a+="uniform float scalarsMaxThreshold;\n";a+="uniform int scalarsInterpolation;\n";a+="uniform vec3 objectColor;\n";a+="uniform float pointSize;\n";a+="\n";a+="varying float fDiscardNow;\n";a+="varying vec4 fVertexPosition;\n";a+="varying vec3 fragmentColor;\n";a+="varying vec2 fragmentTexturePos;\n";
a+="varying vec3 fVertexNormal;\n";a+="varying vec3 fTransformedVertexNormal;\n";a+="\n";a+="void main(void) {\n";a+="  fTransformedVertexNormal = mat3(view[0].xyz,view[1].xyz,view[2].xyz) * ";a+="mat3(objectTransform[0].xyz,objectTransform[1].xyz,objectTransform[2].xyz) * ";a+="vertexNormal;\n";a+="  fVertexNormal = vertexNormal;\n";a+="  fDiscardNow = 0.0;\n";a+="  vec3 vertexPosition2 = vertexPosition - center;\n";a+="  fVertexPosition = view * objectTransform * vec4(vertexPosition2, 1.0);\n";
a+="  fragmentTexturePos = vertexTexturePos;\n";a+="  if (useScalars) {\n";a+="    float scalarValue = vertexScalar;\n";a+="    if (scalarValue < scalarsMinThreshold || scalarValue > scalarsMaxThreshold) {\n";a+="      if (scalarsReplaceMode) {\n";a+="        fragmentColor = objectColor;\n";a+="      } else {\n";a+="        fDiscardNow = 1.0;\n";a+="      }\n";a+="    } else {\n";a+="      if (scalarsReplaceMode) {\n";a+="        if (scalarsInterpolation == 1) {\n";a+="            vec3 zeroMaxColor;\n";
a+="            vec3 zeroMinColor;\n";a+="            zeroMaxColor[0] = scalarsMaxColor[0]*0.33;\n";a+="            zeroMaxColor[1] = scalarsMaxColor[1]*0.33;\n";a+="            zeroMaxColor[2] = scalarsMaxColor[2]*0.33;\n";a+="            zeroMinColor[0] = scalarsMinColor[0]*0.33;\n";a+="            zeroMinColor[1] = scalarsMinColor[1]*0.33;\n";a+="            zeroMinColor[2] = scalarsMinColor[2]*0.33;\n";a+="            if(scalarValue < 0.0) {fragmentColor = scalarValue/(scalarsMin) * scalarsMinColor + (1.0 - scalarValue/(scalarsMin)) * (zeroMinColor);}\n";
a+="            else {fragmentColor = scalarValue/(scalarsMax) * scalarsMaxColor + (1.0 - scalarValue/(scalarsMax)) * (zeroMaxColor);}\n";a+="        } else {\n";a+="            fragmentColor = scalarValue * scalarsMaxColor + (1.0 - scalarValue) * scalarsMinColor;\n";a+="          }\n";a+="      } else {\n";a+="        fragmentColor = vertexColor;\n";a+="      }\n";a+="    }\n";a+="  } else if (useObjectColor) {\n";a+="    fragmentColor = objectColor;\n";a+="  } else {\n";a+="    fragmentColor = vertexColor;\n";
a+="  }\n";a+="  gl_PointSize = pointSize;\n";a+="  gl_Position = perspective * fVertexPosition;\n";this._vertexshaderSource=a+="}\n";this._fragmentshaderSource="";a="precision mediump float;\n\n";a+="uniform bool usePicking;\n";a+="uniform bool useTexture;\n";a+="uniform bool volumeTexture;\n";a+="uniform bool useLabelMapTexture;\n";a+="uniform sampler2D textureSampler;\n";a+="uniform sampler2D textureSampler2;\n";a+="uniform float objectOpacity;\n";a+="uniform float labelmapOpacity;\n";a+="uniform vec4 labelmapColor;\n";
a+="uniform float volumeLowerThreshold;\n";a+="uniform float volumeUpperThreshold;\n";a+="uniform float volumeScalarMin;\n";a+="uniform float volumeScalarMax;\n";a+="uniform vec3 volumeScalarMinColor;\n";a+="uniform vec3 volumeScalarMaxColor;\n";a+="uniform float volumeWindowLow;\n";a+="uniform float volumeWindowHigh;\n";a+="\n";a+="varying float fDiscardNow;\n";a+="varying vec4 fVertexPosition;\n";a+="varying vec3 fragmentColor;\n";a+="varying vec2 fragmentTexturePos;\n";a+="varying vec3 fVertexNormal;\n";
a+="varying vec3 fTransformedVertexNormal;\n";a+="\n";a+="void main(void) {\n";a+=" if (fDiscardNow > 0.0) {\n";a+="   discard;\n";a+=" }\n";a+=" if (usePicking) {\n";a+="   gl_FragColor = vec4(fragmentColor, 1.0);\n";a+=" } else if (useTexture) {\n";a+="   vec4 texture1 = texture2D(textureSampler,fragmentTexturePos);\n";a+="   vec4 textureSum = texture1;\n";a+="   if (volumeTexture) {\n";a+="     float _windowLow = ((volumeWindowLow - volumeScalarMin)/ (volumeScalarMax - volumeScalarMin));\n";a+=
"     float _windowHigh = ((volumeWindowHigh - volumeScalarMin)/ (volumeScalarMax - volumeScalarMin));\n";a+="     vec3 _minrange = vec3(_windowLow,_windowLow,_windowLow);\n";a+="     vec3 _maxrange = vec3(_windowHigh,_windowHigh,_windowHigh);\n";a+="     vec3 fac = _maxrange - _minrange;\n";a+="     textureSum = vec4((textureSum.r - _minrange)/fac,1);\n";a+="     textureSum = textureSum.r * vec4(volumeScalarMaxColor,1) + (1.0 - textureSum.r) * vec4(volumeScalarMinColor,1);\n";a+="   }\n";a+="   if (useLabelMapTexture) {\n";
a+="     vec4 texture2 = texture2D(textureSampler2,fragmentTexturePos);\n";a+="     if (texture2.a > 0.0) {\n";a+="         if (labelmapColor.a != -255.0) {\n";a+="           if (all(equal(floor(texture2 * vec4(255)), labelmapColor))) {\n";a+="             if (labelmapOpacity < 1.0) {\n";a+="               textureSum = mix(texture2, textureSum, 1.0 - labelmapOpacity);\n";a+="             } else {\n";a+="               textureSum = texture2;\n";a+="             }\n";a+="           }\n";a+="         } else {\n";
a+="           if (labelmapOpacity < 1.0) {\n";a+="             textureSum = mix(texture2, textureSum, 1.0 - labelmapOpacity);\n";a+="           } else {\n";a+="             textureSum = texture2;\n";a+="           }\n";a+="         }\n";a+="     }\n";a+="   }\n";a+="   if (volumeTexture) {\n";a+="     float _volumeLowerThreshold = (volumeLowerThreshold - volumeScalarMin)/ (volumeScalarMax - volumeScalarMin);\n";a+="     float _volumeUpperThreshold = (volumeUpperThreshold - volumeScalarMin)/ (volumeScalarMax - volumeScalarMin);\n";
a+="     if (texture1.r < _volumeLowerThreshold ||\n";a+="         texture1.r > _volumeUpperThreshold ||\n";a+="         texture1.a == 0.0 ) {\n";a+="       discard;\n";a+="     };\n";a+="   };\n";a+="   gl_FragColor = textureSum;\n";a+="   gl_FragColor.a = objectOpacity;\n";a+=" } else {\n";a+="   vec3 nNormal = normalize(fTransformedVertexNormal);\n";a+="   if (fVertexNormal == vec3(0.0,0.0,0.0)) {\n";a+="     gl_FragColor = vec4(fragmentColor,1.0);\n";a+="     return;\n";a+="   }\n";a+="   vec3 light = vec3(0.0, 0.0, 1.0);\n";
a+="   vec3 lightDirection = vec3(0,0,-10);\n";a+="   lightDirection = normalize(lightDirection);\n";a+="   vec3 eyeDirection = normalize(-fVertexPosition.xyz);\n";a+="   vec3 reflectionDirection = reflect(-lightDirection, nNormal);\n";a+="   float specular = pow(max(dot(reflectionDirection, eyeDirection), 0.0), 10.0);\n";a+="   float diffuse = 0.8 * max(dot(nNormal, light), 0.0);\n";a+="   float ambient = 0.3;\n";a+="   gl_FragColor = vec4(fragmentColor * ambient +\n";a+="                       fragmentColor * diffuse +\n";
a+="                       vec3(0.2, 0.2, 0.2) * specular,\n";a+="                       objectOpacity);\n";a+=" }\n";this._fragmentshaderSource=a+="}\n"};goog.inherits(X.shaders,X.base);X.shaders.attributes={VERTEXPOSITION:"vertexPosition",VERTEXNORMAL:"vertexNormal",VERTEXCOLOR:"vertexColor",VERTEXTEXTUREPOS:"vertexTexturePos",VERTEXSCALAR:"vertexScalar"};
X.shaders.uniforms={VIEW:"view",PERSPECTIVE:"perspective",CENTER:"center",OBJECTTRANSFORM:"objectTransform",USEOBJECTCOLOR:"useObjectColor",OBJECTCOLOR:"objectColor",USESCALARS:"useScalars",SCALARSREPLACEMODE:"scalarsReplaceMode",SCALARSMIN:"scalarsMin",SCALARSMAX:"scalarsMax",SCALARSMINCOLOR:"scalarsMinColor",SCALARSMAXCOLOR:"scalarsMaxColor",SCALARSMINTHRESHOLD:"scalarsMinThreshold",SCALARSMAXTHRESHOLD:"scalarsMaxThreshold",SCALARSINTERPOLATION:"scalarsInterpolation",POINTSIZE:"pointSize",OBJECTOPACITY:"objectOpacity",
NORMAL:"normal",USEPICKING:"usePicking",USETEXTURE:"useTexture",USELABELMAPTEXTURE:"useLabelMapTexture",LABELMAPOPACITY:"labelmapOpacity",LABELMAPCOLOR:"labelmapColor",TEXTURESAMPLER:"textureSampler",TEXTURESAMPLER2:"textureSampler2",VOLUMELOWERTHRESHOLD:"volumeLowerThreshold",VOLUMEUPPERTHRESHOLD:"volumeUpperThreshold",VOLUMESCALARMIN:"volumeScalarMin",VOLUMESCALARMAX:"volumeScalarMax",VOLUMESCALARMINCOLOR:"volumeScalarMinColor",VOLUMESCALARMAXCOLOR:"volumeScalarMaxColor",VOLUMEWINDOWLOW:"volumeWindowLow",
VOLUMEWINDOWHIGH:"volumeWindowHigh",VOLUMETEXTURE:"volumeTexture"};X.shaders.prototype.vertex=function(){return this._vertexshaderSource};X.shaders.prototype.fragment=function(){return this._fragmentshaderSource};
X.shaders.prototype.validate=function(){var a=Object.keys(X.shaders.attributes),b=Object.keys(X.shaders.uniforms);if(!a.every(function(a){a=X.shaders.attributes[a];return-1!=this._vertexshaderSource.search(a)||-1!=this._fragmentshaderSource.search(a)}.bind(this)))throw Error("Could not find all attributes in the shader sources.");if(!b.every(function(a){a=X.shaders.uniforms[a];return-1!=this._vertexshaderSource.search(a)||-1!=this._fragmentshaderSource.search(a)}.bind(this)))throw Error("Could not find all uniforms in the shader sources.");
return!0};X.slice=function(a){X.object.call(this);this._classname="slice";this._center=[0,0,0];this._front=[0,0,1];this._up=[0,1,0];this._right=[1,0,0];this._height=this._width=10;this._textureCoordinateMap=[0,1,0,0,1,1,1,1,1,0,0,0];this._labelmap=this._volume=null;this._borders=!0;this._borderColor=[1,1,1];goog.isDefAndNotNull(a)&&this.copy_(a)};goog.inherits(X.slice,X.object);
X.slice.prototype.copy_=function(a){this._center=a._center.slice();this._front=a._front.slice();this._up=a._up.slice();this._width=a._width;this._height=a._height;this._volume=a._volume;this._labelmap=a._labelmap;this._borders=a._borders;this._borderColor=a._borderColor;this._hideChildren=a._hideChildren;X.slice.superClass_.copy_.call(this,a)};X.slice.prototype.__defineSetter__("height",function(a){this._height=a});X.slice.prototype.__defineSetter__("width",function(a){this._width=a});
X.slice.prototype.__defineGetter__("up",function(){return this._up});X.slice.prototype.__defineGetter__("right",function(){return this._right});
X.slice.prototype.setup=function(a,b,c,d,e,f,g,h){if(!goog.isDefAndNotNull(a)||!goog.isArray(a)||3!=a.length)throw Error("Invalid center.");if(!goog.isDefAndNotNull(b)||!goog.isArray(b)||3!=b.length)throw Error("Invalid front direction.");if(!goog.isDefAndNotNull(c)||!goog.isArray(c)||3!=c.length)throw Error("Invalid up direction.");if(!goog.isNumber(e))throw Error("Invalid width.");if(!goog.isNumber(f))throw Error("Invalid height.");var k=!1;goog.isDefAndNotNull(g)&&(k=g);g=[1,1,1];goog.isDefAndNotNull(h)&&
(g=h);this._center=a;this._front=b;this._up=c;this._right=d;this._width=e;this._height=f;this._borders=k;this._borderColor=g;this.create_()};X.slice.prototype.create=function(){this.create_()};X.slice.prototype.destroy=function(){X.slice.superClass_.destroy.call(this);this._center.length=0;this._front.length=0;this._up.length=0;this._right.length=0;this._textureCoordinateMap.length=0;this._labelmap=this._volume=null;this._borderColor.length=0};
X.slice.prototype.create_=function(){var a=(new goog.math.Vec3(this._front[0],this._front[1],this._front[2])).normalize(),b=new goog.math.Vec3(this._up[0],this._up[1],this._up[2]),c=new goog.math.Vec3(this._right[0],this._right[1],this._right[2]),d=new goog.math.Vec3(this._center[0],this._center[1],this._center[2]),e=goog.math.Vec3.sum(c.clone().invert().scale(this._width/2),b.clone().invert().scale(this._height/2)),f=new goog.math.Vec3(e.x+d.x,e.y+d.y,e.z+d.z),e=goog.math.Vec3.sum(c.clone().invert().scale(this._width/
2),b.clone().scale(this._height/2)),g=new goog.math.Vec3(e.x+d.x,e.y+d.y,e.z+d.z),e=goog.math.Vec3.sum(c.clone().scale(this._width/2),b.clone().invert().scale(this._height/2)),h=new goog.math.Vec3(e.x+d.x,e.y+d.y,e.z+d.z),e=goog.math.Vec3.sum(c.clone().scale(this._width/2),b.clone().scale(this._height/2)),b=new goog.math.Vec3(e.x+d.x,e.y+d.y,e.z+d.z);this._points=new X.triplets(18);this._normals=new X.triplets(18);this._points.add(f.x,f.y,f.z);this._points.add(g.x,g.y,g.z);this._points.add(h.x,h.y,
h.z);this._points.add(h.x,h.y,h.z);this._points.add(b.x,b.y,b.z);this._points.add(g.x,g.y,g.z);this._normals.add(a.x,a.y,a.z);this._normals.add(a.x,a.y,a.z);this._normals.add(a.x,a.y,a.z);this._normals.add(a.x,a.y,a.z);this._normals.add(a.x,a.y,a.z);this._normals.add(a.x,a.y,a.z);this._borders&&(a=new X.object,a._points=new X.triplets(24),a._normals=new X.triplets(24),a._points.add(f.x,f.y,f.z),a._points.add(g.x,g.y,g.z),a._points.add(g.x,g.y,g.z),a._points.add(b.x,b.y,b.z),a._points.add(b.x,b.y,
b.z),a._points.add(h.x,h.y,h.z),a._points.add(h.x,h.y,h.z),a._points.add(f.x,f.y,f.z),a._normals.add(0,0,0),a._normals.add(0,0,0),a._normals.add(0,0,0),a._normals.add(0,0,0),a._normals.add(0,0,0),a._normals.add(0,0,0),a._normals.add(0,0,0),a._normals.add(0,0,0),a._color=[this._borderColor[0],this._borderColor[1],this._borderColor[2]],a._type=X.displayable.types.LINES,a._linewidth=2,this._children.push(a))};goog.exportSymbol("X.slice",X.slice);goog.exportSymbol("X.slice.prototype.create",X.slice.prototype.create);
goog.exportSymbol("X.slice.prototype.destroy",X.slice.prototype.destroy);X.volume=function(a){X.object.call(this);this._classname="volume";this._center=[0,0,0];this._dimensions=[10,10,10];this._BBox=[1,1,1];this._range=[10,10,10];this._spacing=[1,1,1];this._image=[];this._indexZold=this._indexZ=this._indexYold=this._indexY=this._indexXold=this._indexX=0;this._slicesX=new X.object;this._slicesY=new X.object;this._slicesZ=new X.object;this._volumeRenderingOld=this._volumeRendering=!1;this._volumeRenderingDirection=-1;this._volumeRenderingCache=[];this._labelmap=null;this._borders=
!0;this._windowLow=Infinity;this._windowHigh=-Infinity;this._reslicing=!0;this._resolutionFactor=1;this._max=0;this._data=null;this._childrenInfo=[];this._RASCenter=[0,0,0];this._RASDimensions=[0,0,0];this._RASSpacing=[0,0,0];this._IJKVolume=[];this._IJKVolumeN=[];this._filedata=null;inject(this,new X.loadable);inject(this,new X.thresholdable);goog.isDefAndNotNull(a)&&this.copy_(a)};goog.inherits(X.volume,X.object);
X.volume.prototype.copy_=function(a){this._center=a._center.slice();this._dimensions=a._dimensions.slice();this._spacing=a._spacing.slice();this._indexX=a._indexX;this._indexXold=a._indexXold;this._indexY=a._indexY;this._indexYold=a._indexYold;this._indexZ=a._indexZ;this._indexZold=a._indexZold;this._dimensionsRAS=a._dimensionsRAS.slice();this._slicesX=new X.object(a._slicesX);this._slicesY=new X.object(a._slicesY);this._slicesZ=new X.object(a._slicesZ);this._max=a._max;this._data=a._data;this._volumeRendering=
a._volumeRendering;this._volumeRenderingOld=a._volumeRenderingOld;this._volumeRenderingDirection=a._volumeRenderingDirection;this._labelmap=a._labelmap;this._borders=a._borders;X.volume.superClass_.copy_.call(this,a)};
X.volume.prototype.create_=function(a){this._children.length=0;this._slicesX._children.length=0;this._slicesY._children.length=0;this._slicesZ._children.length=0;this._children.push(this._slicesX);this._children.push(this._slicesY);this._children.push(this._slicesZ);this._RASOrigin=a.RASOrigin;this._RASSpacing=a.RASSpacing;this._RASDimensions=a.RASDimensions;this._IJKToRAS=a.IJKToRAS;this._RASToIJK=a.RASToIJK;this._max=a.max;this._data=a.data;this._dirty=!0};
X.volume.prototype.destroy=function(){X.volume.superClass_.destroy.call(this);this._image.length=0;this._children.length=0;this._slicesX._children.length=0;this._slicesX.length=0;this._slicesY._children.length=0;this._slicesY.length=0;this._slicesZ._children.length=0;this._slicesZ.length=0;this._data=null;this._BBox.length=0;this._childrenInfo.length=0;this._RASCenter.length=0;this._RASDimensions.length=0;this._RASSpacing.length=0;this._IJKVolume.length=0;this._IJKVolumeN.length=0;this._filedata=
null};X.volume.prototype.modified=function(a){a="undefined"!==typeof a?a:!0;if(0<this._children.length){this._volumeRendering!=this._volumeRenderingOld&&(!this._volumeRendering&&-1!=this._volumeRenderingDirection&&(this._children[this._volumeRenderingDirection].visible=!1),this._dirty=!0,this._volumeRenderingOld=this._volumeRendering);if(!this._visible)return;this.slicing_();this._volumeRendering&&-1!=this._volumeRenderingDirection&&this.volumeRendering_(this._volumeRenderingDirection)}a&&X.volume.superClass_.modified.call(this)};
X.volume.prototype.slicing_=function(){for(var a=0,a=0;3>a;a++){var b=this._children[a],c=0,d=0;0==a?(c=this._indexX,d=this._indexXold,this._indexXold=this._indexX):1==a?(c=this._indexY,d=this._indexYold,this._indexYold=this._indexY):2==a&&(c=this._indexZ,d=this._indexZold,this._indexZold=this._indexZ);if(!goog.isDefAndNotNull(this._children[a]._children[parseInt(c,10)])){var e=goog.vec.Vec3.createFloat32();e[0]=this._childrenInfo[a]._solutionsLine[0][0][0]+this._childrenInfo[a]._sliceDirection[0]*
parseInt(c,10);e[1]=this._childrenInfo[a]._solutionsLine[0][0][1]+this._childrenInfo[a]._sliceDirection[1]*parseInt(c,10);e[2]=this._childrenInfo[a]._solutionsLine[0][0][2]+this._childrenInfo[a]._sliceDirection[2]*parseInt(c,10);if(this.hasLabelMap){var f=X.parser.reslice2(e,this._childrenInfo[a]._sliceXYSpacing,this._childrenInfo[a]._sliceNormal,this._childrenInfo[a]._color,this._BBox,this._labelmap._IJKVolume,this._labelmap,this._labelmap.hasLabelMap,this._labelmap._colortable._map);this._labelmap._children[a]._children[parseInt(c,
10)]=f;this._labelmap._children[a].modified(!0)}e=X.parser.reslice2(e,this._childrenInfo[a]._sliceXYSpacing,this._childrenInfo[a]._sliceNormal,this._childrenInfo[a]._color,this._BBox,this._IJKVolume,this,!0,null);this.hasLabelMap&&(e._labelmap=e._texture,e._labelmap=this._labelmap._children[a]._children[parseInt(c,10)]._texture);b._children[parseInt(c,10)]=e;this._children[a].modified(!0)}d=b._children[parseInt(d,10)];this._volumeRendering||(d.visible=!1);b=b._children[parseInt(c,10)];b.visible=!0;
b._opacity=1;this._volumeRendering&&(b._children[0]._visible=!1,a!=this._volumeRenderingDirection&&(b.visible=!1,b._opacity=0))}};X.volume.prototype.__defineGetter__("dimensions",function(){return this._dimensions});X.volume.prototype.__defineSetter__("dimensions",function(a){this._dimensions=a});X.volume.prototype.__defineGetter__("spacing",function(){return this._spacing});X.volume.prototype.__defineSetter__("spacing",function(a){this._spacing=a});X.volume.prototype.__defineGetter__("bbox",function(){return this._BBox});
X.volume.prototype.__defineGetter__("range",function(){return this._range});X.volume.prototype.__defineGetter__("dimensionsRAS",function(){return this._dimensionsRAS});X.volume.prototype.__defineGetter__("volumeRendering",function(){return this._volumeRendering});X.volume.prototype.__defineSetter__("volumeRendering",function(a){this._volumeRendering=a;this.modified(!1)});X.volume.prototype.__defineGetter__("visible",function(){return this._visible});
X.volume.prototype.__defineSetter__("visible",function(a){if(a)this._visible=a,this.modified(!1);else{for(var b=this._children,c=b.length,d=0,d=0;d<c;d++)b[d].visible=a;this._visible=a;this._dirty=!0}});X.volume.prototype.__defineGetter__("center",function(){return this._center});X.volume.prototype.__defineSetter__("center",function(a){if(!goog.isDefAndNotNull(a)||!goog.isArray(a)||3!=a.length)throw Error("Invalid center.");this._center=a});
X.volume.prototype.__defineGetter__("volumeRenderingCache",function(){return this._volumeRenderingCache});X.volume.prototype.__defineSetter__("volumeRenderingCache",function(a){if(!goog.isDefAndNotNull(a)||!goog.isArray(a)||!(3>=a.length))throw Error("Invalid volumeRederingCache.");this._volumeRenderingCache=a});X.volume.prototype.__defineGetter__("image",function(){return this._image});
X.volume.prototype.__defineGetter__("labelmap",function(){this._labelmap||(this._labelmap=new X.labelmap(this));return this._labelmap});X.volume.prototype.__defineGetter__("indexX",function(){return this._indexX});X.volume.prototype.__defineSetter__("indexX",function(a){goog.isNumber(a)&&(0<=a&&a<this._slicesX._children.length)&&(this._indexX=a,this.modified(!1))});X.volume.prototype.__defineGetter__("indexY",function(){return this._indexY});
X.volume.prototype.__defineSetter__("indexY",function(a){goog.isNumber(a)&&(0<=a&&a<this._slicesY._children.length)&&(this._indexY=a,this.modified(!1))});X.volume.prototype.__defineGetter__("indexZ",function(){return this._indexZ});X.volume.prototype.__defineSetter__("indexZ",function(a){goog.isNumber(a)&&(0<=a&&a<this._slicesZ._children.length)&&(this._indexZ=a,this.modified(!1))});X.volume.prototype.__defineGetter__("windowLow",function(){return this._windowLow});
X.volume.prototype.__defineSetter__("windowLow",function(a){this._windowLow=a});X.volume.prototype.__defineGetter__("windowHigh",function(){return this._windowHigh});X.volume.prototype.__defineSetter__("windowHigh",function(a){this._windowHigh=a});X.volume.prototype.__defineGetter__("borders",function(){return this._borders});X.volume.prototype.__defineSetter__("borders",function(a){this._borders=a});X.volume.prototype.__defineGetter__("reslicing",function(){return this._reslicing});
X.volume.prototype.__defineSetter__("reslicing",function(a){this._reslicing=a});X.volume.prototype.__defineGetter__("resolutionFactor",function(){return this._resolutionFactor});X.volume.prototype.__defineSetter__("resolutionFactor",function(a){this._resolutionFactor=a});X.volume.prototype.__defineSetter__("xNormX",function(a){this._childrenInfo[0]._sliceNormal[0]=a});X.volume.prototype.__defineGetter__("xNormX",function(){return this._childrenInfo[0]._sliceNormal[0]});
X.volume.prototype.__defineSetter__("xNormY",function(a){this._childrenInfo[0]._sliceNormal[1]=a});X.volume.prototype.__defineGetter__("xNormY",function(){return this._childrenInfo[0]._sliceNormal[1]});X.volume.prototype.__defineSetter__("xNormZ",function(a){this._childrenInfo[0]._sliceNormal[2]=a});X.volume.prototype.__defineGetter__("xNormZ",function(){return this._childrenInfo[0]._sliceNormal[2]});X.volume.prototype.__defineSetter__("xColor",function(a){this._childrenInfo[0]._color=a});
X.volume.prototype.__defineGetter__("xColor",function(){return this._childrenInfo[0]._color});X.volume.prototype.__defineSetter__("yNormX",function(a){this._childrenInfo[1]._sliceNormal[0]=a});X.volume.prototype.__defineGetter__("yNormX",function(){return this._childrenInfo[1]._sliceNormal[0]});X.volume.prototype.__defineSetter__("yNormY",function(a){this._childrenInfo[1]._sliceNormal[1]=a});X.volume.prototype.__defineGetter__("yNormY",function(){return this._childrenInfo[1]._sliceNormal[1]});
X.volume.prototype.__defineSetter__("yNormZ",function(a){this._childrenInfo[1]._sliceNormal[2]=a});X.volume.prototype.__defineGetter__("yNormZ",function(){return this._childrenInfo[1]._sliceNormal[2]});X.volume.prototype.__defineSetter__("yColor",function(a){this._childrenInfo[1]._color=a});X.volume.prototype.__defineGetter__("yColor",function(){return this._childrenInfo[1]._color});X.volume.prototype.__defineSetter__("zNormX",function(a){this._childrenInfo[2]._sliceNormal[0]=a});
X.volume.prototype.__defineGetter__("zNormX",function(){return this._childrenInfo[2]._sliceNormal[0]});X.volume.prototype.__defineSetter__("zNormY",function(a){this._childrenInfo[2]._sliceNormal[1]=a});X.volume.prototype.__defineGetter__("zNormY",function(){return this._childrenInfo[2]._sliceNormal[1]});X.volume.prototype.__defineSetter__("zNormZ",function(a){this._childrenInfo[2]._sliceNormal[2]=a});X.volume.prototype.__defineGetter__("zNormZ",function(){return this._childrenInfo[2]._sliceNormal[2]});
X.volume.prototype.__defineSetter__("zColor",function(a){this._childrenInfo[2]._color=a});X.volume.prototype.__defineGetter__("zColor",function(){return this._childrenInfo[2]._color});
X.volume.prototype.sliceInfoChanged=function(a){this._children[a].visible=!1;for(var b=0;b<this._children[a]._children.length;b++)"undefined"!=typeof this._children[a]._children[b]&&(this.hasLabelMap&&(this._labelmap._children[a]._children[b].remove(),this._labelmap._children[a]._children[b]=null),this._children[a]._children[b].remove(),this._children[a]._children[b]=null);goog.vec.Vec3.normalize(this._childrenInfo[a]._sliceNormal,this._childrenInfo[a]._sliceNormal);X.parser.prototype.updateSliceInfo(a,
this._childrenInfo[a]._sliceOrigin,this._childrenInfo[a]._sliceNormal,this);this._children[a]._children=[];this._children[a]._children=Array(this._childrenInfo[a]._nb);this.hasLabelMap&&(b=X.parser.reslice2(this._childrenInfo[a]._sliceOrigin,this._childrenInfo[a]._sliceXYSpacing,this._childrenInfo[a]._sliceNormal,this._childrenInfo[a]._color,this._BBox,this._labelmap._IJKVolume,this._labelmap,this._labelmap.hasLabelMap,this._labelmap._colortable._map),this._labelmap._children[a]._children=[],this._labelmap._children[a]._children=
Array(this._childrenInfo[a]._nb),this._labelmap._children[a]._children[Math.floor(this._childrenInfo[a]._nb/2)]=b,this._labelmap._children[a].modified());b=X.parser.reslice2(this._childrenInfo[a]._sliceOrigin,this._childrenInfo[a]._sliceXYSpacing,this._childrenInfo[a]._sliceNormal,this._childrenInfo[a]._color,this._BBox,this._IJKVolume,this,!0,null);window.console.log("modified!");this.hasLabelMap&&(b._labelmap=b._texture,b._labelmap=this._labelmap._children[a]._children[Math.floor(this._childrenInfo[a]._nb/
2)]._texture);this._children[a]._children[Math.floor(this._childrenInfo[a]._nb/2)]=b;0==a?(this._indexX=Math.floor(this._childrenInfo[a]._nb/2),this._indexXold=Math.floor(this._childrenInfo[a]._nb/2)):1==a?(this._indexY=Math.floor(this._childrenInfo[a]._nb/2),this._indexYold=Math.floor(this._childrenInfo[a]._nb/2)):(this._indexZ=Math.floor(this._childrenInfo[a]._nb/2),this._indexZold=Math.floor(this._childrenInfo[a]._nb/2));this._children[a].modified();this._children[a]._children[Math.floor(this._childrenInfo[a]._nb/
2)]._visible=!0};
X.volume.prototype.volumeRendering_=function(a){if(!this._computing)if(!this._volumeRendering||!this._dirty&&a==this._volumeRenderingDirection)this._volumeRenderingDirection=a;else if(-1==this._volumeRenderingCache.indexOf(a))this._volumeRenderingCache.push(a),this._computing=!0,this.onComputing_(a),setTimeout(function(){var b=null;0<=this._volumeRenderingDirection&&(b=this._children[this._volumeRenderingDirection],b.visible=!1);var b=this._children[a],c=b._children.length,d=Math.floor(c/4),h;for(h=
0;h<1*d;h++){if(!goog.isDefAndNotNull(b._children[h])){var k=goog.vec.Vec3.createFloat32();k[0]=this._childrenInfo[a]._solutionsLine[0][0][0]+this._childrenInfo[a]._sliceDirection[0]*h;k[1]=this._childrenInfo[a]._solutionsLine[0][0][1]+this._childrenInfo[a]._sliceDirection[1]*h;k[2]=this._childrenInfo[a]._solutionsLine[0][0][2]+this._childrenInfo[a]._sliceDirection[2]*h;if(this.hasLabelMap){var j=X.parser.reslice2(k,this._childrenInfo[a]._sliceXYSpacing,this._childrenInfo[a]._sliceNormal,this._childrenInfo[a]._color,
this._BBox,this._labelmap._IJKVolume,this._labelmap,this._labelmap.hasLabelMap,this._labelmap._colortable._map);this._labelmap._children[a]._children[h]=j;this._labelmap._children[a].modified(!0)}k=X.parser.reslice2(k,this._childrenInfo[a]._sliceXYSpacing,this._childrenInfo[a]._sliceNormal,this._childrenInfo[a]._color,this._BBox,this._IJKVolume,this,!0,null);k._children[0]._visible=!1;this.hasLabelMap&&(k._labelmap=k._texture,k._labelmap=this._labelmap._children[a]._children[h]._texture);b._children[h]=
k}b._children[h]._visible=!0}this.onComputingProgress_(0.25);setTimeout(function(){for(;h<2*d;h++){if(!goog.isDefAndNotNull(b._children[h])){var j=goog.vec.Vec3.createFloat32();j[0]=this._childrenInfo[a]._solutionsLine[0][0][0]+this._childrenInfo[a]._sliceDirection[0]*h;j[1]=this._childrenInfo[a]._solutionsLine[0][0][1]+this._childrenInfo[a]._sliceDirection[1]*h;j[2]=this._childrenInfo[a]._solutionsLine[0][0][2]+this._childrenInfo[a]._sliceDirection[2]*h;if(this.hasLabelMap){var k=X.parser.reslice2(j,
this._childrenInfo[a]._sliceXYSpacing,this._childrenInfo[a]._sliceNormal,this._childrenInfo[a]._color,this._BBox,this._labelmap._IJKVolume,this._labelmap,this._labelmap.hasLabelMap,this._labelmap._colortable._map);this._labelmap._children[a]._children[h]=k;this._labelmap._children[a].modified(!0)}j=X.parser.reslice2(j,this._childrenInfo[a]._sliceXYSpacing,this._childrenInfo[a]._sliceNormal,this._childrenInfo[a]._color,this._BBox,this._IJKVolume,this,!0,null);j._children[0]._visible=!1;this.hasLabelMap&&
(j._labelmap=j._texture,j._labelmap=this._labelmap._children[a]._children[h]._texture);b._children[h]=j}b._children[h]._visible=!0}this.onComputingProgress_(0.5);setTimeout(function(){for(;h<3*d;h++){if(!goog.isDefAndNotNull(b._children[h])){var j=goog.vec.Vec3.createFloat32();j[0]=this._childrenInfo[a]._solutionsLine[0][0][0]+this._childrenInfo[a]._sliceDirection[0]*h;j[1]=this._childrenInfo[a]._solutionsLine[0][0][1]+this._childrenInfo[a]._sliceDirection[1]*h;j[2]=this._childrenInfo[a]._solutionsLine[0][0][2]+
this._childrenInfo[a]._sliceDirection[2]*h;if(this.hasLabelMap){var k=X.parser.reslice2(j,this._childrenInfo[a]._sliceXYSpacing,this._childrenInfo[a]._sliceNormal,this._childrenInfo[a]._color,this._BBox,this._labelmap._IJKVolume,this._labelmap,this._labelmap.hasLabelMap,this._labelmap._colortable._map);this._labelmap._children[a]._children[h]=k;this._labelmap._children[a].modified(!0)}j=X.parser.reslice2(j,this._childrenInfo[a]._sliceXYSpacing,this._childrenInfo[a]._sliceNormal,this._childrenInfo[a]._color,
this._BBox,this._IJKVolume,this,!0,null);j._children[0]._visible=!1;this.hasLabelMap&&(j._labelmap=j._texture,j._labelmap=this._labelmap._children[a]._children[h]._texture);b._children[h]=j}b._children[h]._visible=!0}this.onComputingProgress_(0.75);setTimeout(function(){for(h=3*d;h<c;h++){if(!goog.isDefAndNotNull(b._children[h])){var j=goog.vec.Vec3.createFloat32();j[0]=this._childrenInfo[a]._solutionsLine[0][0][0]+this._childrenInfo[a]._sliceDirection[0]*h;j[1]=this._childrenInfo[a]._solutionsLine[0][0][1]+
this._childrenInfo[a]._sliceDirection[1]*h;j[2]=this._childrenInfo[a]._solutionsLine[0][0][2]+this._childrenInfo[a]._sliceDirection[2]*h;if(this.hasLabelMap){var k=X.parser.reslice2(j,this._childrenInfo[a]._sliceXYSpacing,this._childrenInfo[a]._sliceNormal,this._childrenInfo[a]._color,this._BBox,this._labelmap._IJKVolume,this._labelmap,this._labelmap.hasLabelMap,this._labelmap._colortable._map);this._labelmap._children[a]._children[h]=k;this._labelmap._children[a].modified(!0)}j=X.parser.reslice2(j,
this._childrenInfo[a]._sliceXYSpacing,this._childrenInfo[a]._sliceNormal,this._childrenInfo[a]._color,this._BBox,this._IJKVolume,this,!0,null);j._children[0]._visible=!1;this.hasLabelMap&&(j._labelmap=j._texture,j._labelmap=this._labelmap._children[a]._children[h]._texture);b._children[h]=j}b._children[h]._visible=!0}this.onComputingProgress_(1);setTimeout(function(){this._computing&&this._children[a].modified(!0);this._volumeRenderingDirection=a;this._dirty=!1;if(this._computing)this.onComputingEnd_(a);
this._computing=!1}.bind(this),10)}.bind(this),10)}.bind(this),10)}.bind(this),10)}.bind(this),10);else{var b=this._children[this._volumeRenderingDirection];b.visible=!1;var b=this._children[a],c=b._children.length,d;for(d=0;d<c;d++)b._children[d]._visible=!0;this._volumeRenderingDirection=a;this._dirty=!1}};X.volume.prototype.onComputing_=function(a){var b=new X.event.ComputingEvent;b._object=this;this.dispatchEvent(b);this.onComputing(a)};
X.volume.prototype.onComputingProgress_=function(a){var b=new X.event.ComputingProgressEvent;b._value=a;this.dispatchEvent(b);this.onComputingProgress(100*a)};X.volume.prototype.onComputingEnd_=function(a){var b=new X.event.ComputingEndEvent;b._object=this;this.dispatchEvent(b);this.onComputingEnd(a)};X.volume.prototype.onComputing=function(){};X.volume.prototype.onComputingProgress=function(){};X.volume.prototype.onComputingEnd=function(){};goog.exportSymbol("X.volume",X.volume);
goog.exportSymbol("X.volume.prototype.modified",X.volume.prototype.modified);goog.exportSymbol("X.volume.prototype.destroy",X.volume.prototype.destroy);goog.exportSymbol("X.volume.prototype.sliceInfoChanged",X.volume.prototype.sliceInfoChanged);goog.exportSymbol("X.volume.prototype.onComputing",X.volume.prototype.onComputing);goog.exportSymbol("X.volume.prototype.onComputingProgress",X.volume.prototype.onComputingProgress);goog.exportSymbol("X.volume.prototype.onComputingEnd",X.volume.prototype.onComputingEnd);X.parserOFF=function(){X.parser.call(this);this._classname="parserOFF"};goog.inherits(X.parserOFF,X.parser);
X.parserOFF.prototype.parse=function(a,b,c){function d(){if(k===e)throw Error("End of file reached unexpectedly.");for(var a=k;a<e;++a)if(10===f[a]){var b=j.parseChars(f,k,a);k=a+1;return b}k=e;return j.parseChars(f,k,e-1)}X.TIMER(this._classname+".parse");this._data=c;var e=c.byteLength,f=this.scan("uchar",e);c=[];b._points=new X.triplets(e);b._normals=new X.triplets(e);for(var g=b._points,h=b._normals,k=0,j=this,m=d(),m=("OFF"===m?d():m).split(" "),l=m[0],m=m[1];l--;){var n=d(),n=n.split(" "),p=
parseFloat(n[0]),q=parseFloat(n[1]),n=parseFloat(n[2]);c.push([p,q,n])}for(;m--;)n=d(),n=n.split(" "),p=c[parseInt(n[1],10)],l=c[parseInt(n[2],10)],n=c[parseInt(n[3],10)],g.add(p[0],p[1],p[2]),g.add(l[0],l[1],l[2]),g.add(n[0],n[1],n[2]),p=new goog.math.Vec3(p[0],p[1],p[2]),l=new goog.math.Vec3(l[0],l[1],l[2]),n=new goog.math.Vec3(n[0],n[1],n[2]),l=goog.math.Vec3.cross(l.subtract(p),n.subtract(p)),l.normalize(),h.add(l.x,l.y,l.z),h.add(l.x,l.y,l.z),h.add(l.x,l.y,l.z);X.TIMERSTOP(this._classname+".parse");
c=new X.event.ModifiedEvent;c._object=b;c._container=a;this.dispatchEvent(c)};goog.exportSymbol("X.parserOFF",X.parserOFF);goog.exportSymbol("X.parserOFF.prototype.parse",X.parserOFF.prototype.parse);X.parserDCM=function(){X.parser.call(this);this._classname="parserDCM"};goog.inherits(X.parserDCM,X.parser);
X.parserDCM.prototype.parse=function(a,b,c){b.MRI={};b.MRI.loaded_files=0;this.parseStream(c,b);if(!goog.isDefAndNotNull(b._file.length)||b.slices.length==b._file.length){b.MRI.loaded_files=b._file.length;var d={};c={};for(var e=0;e<b.slices.length;e++)d.hasOwnProperty(b.slices[e].series_instance_uid)||(d[b.slices[e].series_instance_uid]=[],c[b.slices[e].series_instance_uid]={}),c[b.slices[e].series_instance_uid].hasOwnProperty(b.slices[e].sop_instance_uid)||(c[b.slices[e].series_instance_uid][b.slices[e].sop_instance_uid]=
!0,d[b.slices[e].series_instance_uid].push(b.slices[e]));var f=Object.keys(d)[0],e=d[f],g=e.length;c={};var h="image_position_patient";1==g?(h="image_position_patient",d[f][0].dist=0):e[0].image_position_patient[0]!=e[1].image_position_patient[0]||e[0].image_position_patient[1]!=e[1].image_position_patient[1]||e[0].image_position_patient[2]!=e[1].image_position_patient[2]?(h="image_position_patient",d=new goog.math.Vec3(e[0].image_orientation_patient[0],e[0].image_orientation_patient[1],e[0].image_orientation_patient[2]),
f=new goog.math.Vec3(e[0].image_orientation_patient[3],e[0].image_orientation_patient[4],e[0].image_orientation_patient[5]),d=goog.math.Vec3.cross(d,f),e.map(function(a,b){b.dist=b.image_position_patient[0]*a.x+b.image_position_patient[1]*a.y+b.image_position_patient[2]*a.z;return b}.bind(null,d)),e.sort(function(a,b){return a.dist-b.dist})):e[0].instance_number!=e[1].instance_number?(h="instance_number",e.sort(function(a,b){return a.instance_number-b.instance_number})):window.console.log("Could not resolve the ordering mode");
isNaN(e[0].pixel_spacing[0])&&(e[0].pixel_spacing[0]=1);isNaN(e[0].pixel_spacing[1])&&(e[0].pixel_spacing[1]=1);if(1<g)switch(h){case "image_position_patient":var k=e[0].image_position_patient,d=e[1].image_position_patient,f=d[0]-k[0],j=d[1]-k[1],m=d[2]-k[2];e[0].pixel_spacing[2]=Math.sqrt(f*f+j*j+m*m);break;case "instance_number":e[0].pixel_spacing[2]=1;break;default:window.console.log("Unkown ordering mode - returning: "+h)}else e[0].pixel_spacing[2]=1;d=1;switch(h){case "image_position_patient":var k=
e[0].image_position_patient,l=e[g-1].image_position_patient,f=l[0]-k[0],j=l[1]-k[1],m=l[2]-k[2],f=Math.sqrt(f*f+j*j+m*m),d=d+Math.round(f/e[0].pixel_spacing[2]);break;case "instance_number":d+=Math.abs(e[g-1].instance_number-e[0].instance_number);break;default:window.console.log("Unkown ordering mode - returning: "+h)}k=e[0].columns*e[0].rows;f=k*d;l=null;switch(e[0].bits_allocated){case 8:l=new Uint8Array(f);break;case 16:l=new Uint16Array(f);break;case 32:l=new Uint32Array(f);default:window.console.log("Unknown number of bits allocated - using default: 32 bits")}b._spacing=
e[0].pixel_spacing;for(var n=0;n<g;n++){var p=e[n].data,f=0;switch(h){case "image_position_patient":f=e[n].image_position_patient[0]-e[0].image_position_patient[0];j=e[n].image_position_patient[1]-e[0].image_position_patient[1];m=e[n].image_position_patient[2]-e[0].image_position_patient[2];f=Math.round(Math.sqrt(f*f+j*j+m*m)/e[0].pixel_spacing[2]);break;case "instance_number":f=e[n].instance_number-e[0].instance_number;break;default:window.console.log("Unkown ordering mode - returning: "+h)}l.set(p,
f*k)}c.data=l;b._data=l;b._dimensions=[e[0].columns,e[0].rows,d];c.dimensions=b._dimensions;d=this.arrayMinMax(l);g=d[0];d=d[1];c.min=b._min=b._windowLow=g;c.max=b._max=b._windowHigh=d;-Infinity==b._lowerThreshold&&(b._lowerThreshold=g);Infinity==b._upperThreshold&&(b._upperThreshold=d);j=e[0].image_position_patient;g=goog.vec.Mat4.createFloat32();if("false"==b.reslicing||!1==b.reslicing)goog.vec.Mat4.setRowValues(g,0,e[0].pixel_spacing[0],0,0,0),goog.vec.Mat4.setRowValues(g,1,0,e[0].pixel_spacing[1],
0,0),goog.vec.Mat4.setRowValues(g,2,0,0,e[0].pixel_spacing[2],0),goog.vec.Mat4.setRowValues(g,3,0,0,0,1);else switch(h){case "image_position_patient":d=new goog.math.Vec3(e[0].image_orientation_patient[0],e[0].image_orientation_patient[1],e[0].image_orientation_patient[2]);f=new goog.math.Vec3(e[0].image_orientation_patient[3],e[0].image_orientation_patient[4],e[0].image_orientation_patient[5]);d=goog.math.Vec3.cross(d,f);goog.vec.Mat4.setRowValues(g,0,-e[0].image_orientation_patient[0]*e[0].pixel_spacing[0],
-e[0].image_orientation_patient[3]*e[0].pixel_spacing[1],-d.x*e[0].pixel_spacing[2],-j[0]);goog.vec.Mat4.setRowValues(g,1,-e[0].image_orientation_patient[1]*e[0].pixel_spacing[0],-e[0].image_orientation_patient[4]*e[0].pixel_spacing[1],-d.y*e[0].pixel_spacing[2],-j[1]);goog.vec.Mat4.setRowValues(g,2,e[0].image_orientation_patient[2]*e[0].pixel_spacing[0],e[0].image_orientation_patient[5]*e[0].pixel_spacing[1],d.z*e[0].pixel_spacing[2],j[2]);goog.vec.Mat4.setRowValues(g,3,0,0,0,1);break;case "instance_number":goog.vec.Mat4.setRowValues(g,
0,-1,0,0,-j[0]);goog.vec.Mat4.setRowValues(g,1,-0,-1,-0,-j[1]);goog.vec.Mat4.setRowValues(g,2,0,0,1,j[2]);goog.vec.Mat4.setRowValues(g,3,0,0,0,1);break;default:window.console.log("Unkown ordering mode - returning: "+h)}c.IJKToRAS=g;c.RASToIJK=goog.vec.Mat4.createFloat32();goog.vec.Mat4.invert(c.IJKToRAS,c.RASToIJK);h=goog.vec.Vec4.createFloat32FromValues(0,0,0,1);e=goog.vec.Vec4.createFloat32();goog.vec.Mat4.multVec4(g,h,e);h=goog.vec.Vec4.createFloat32FromValues(1,1,1,1);d=goog.vec.Vec4.createFloat32();
goog.vec.Mat4.multVec4(g,h,d);c.RASSpacing=[d[0]-e[0],d[1]-e[1],d[2]-e[2]];e=X.parser.computeRASBBox(g,[b._dimensions[0],b._dimensions[1],b._dimensions[2]]);c.RASDimensions=[e[1]-e[0]+1,e[3]-e[2]+1,e[5]-e[4]+1];c.RASOrigin=[e[0],e[2],e[4]];b.create_(c);b._image=this.reslice(b)}c=new X.event.ModifiedEvent;c._object=b;c._container=a;this.dispatchEvent(c)};
X.parserDCM.prototype.handleDefaults=function(a,b,c,d){switch(c){case 16975:case 20819:case 20053:case 22351:c=function(a){for(var b="",c=128;1<=c;c/=2)b+=a&c?"1":"0";return b};d=a[b++];var e=a[b++],f=(d&65280)>>8;a=e&255;e=(e&65280)>>8;d=c(d&255);d=c(f)+d;a=c(a);c=c(e)+a+d;d=parseInt(c,2);4294967295==d&&(d=0);b+=d/2;break;default:b+=d/2}return b};
X.parserDCM.prototype.parseStream=function(a,b){this._data=a;if("undefined"==typeof b.slices||null==b.slices)b.slices=[];for(var c={pixel_spacing:[0.1,0.1,Infinity],image_orientation_patient:[1,0,0,0,1,0],image_position_patient:[0,0,0],transfer_syntax_uid:"no_transfer_syntax_uid"},d=this.scan("ushort",this._data.byteLength),e=66,f=null,g=null,h=null,k=null;e<d.length;)switch(f=d[e++],g=d[e++],h=d[e++],k=d[e++],"1.2.840.10008.1.2"==c.transfer_syntax_uid&&0==k&&(k=h),f){case 2:switch(g){case 16:for(var j=
"",f=f=0;f<k/2;f++)h=d[e++],g=h&255,h=(h&65280)>>8,j+=String.fromCharCode(g),j+=String.fromCharCode(h);c.transfer_syntax_uid=j.replace(/\0/g,"");break;default:e=X.parserDCM.prototype.handleDefaults(d,e,h,k)}break;case 40:switch(g){case 16:c.rows=d[e];e+=k/2;break;case 17:c.columns=d[e];e+=k/2;break;case 256:c.bits_allocated=d[e];e+=k/2;break;case 257:c.bits_stored=d[e];e+=k/2;break;case 2:c.number_of_images=d[e];e+=k/2;break;case 48:j="";for(f=0;f<k/2;f++)h=d[e++],g=h&255,h=(h&65280)>>8,j+=String.fromCharCode(g),
j+=String.fromCharCode(h);j=j.split("\\");c.pixel_spacing=[parseFloat(j[0]),parseFloat(j[1]),Infinity];break;default:e=X.parserDCM.prototype.handleDefaults(d,e,h,k)}break;case 32:switch(g){case 14:c.series_instance_uid="";for(f=0;f<k/2;f++)h=d[e++],g=h&255,h=(h&65280)>>8,c.series_instance_uid+=String.fromCharCode(g),c.series_instance_uid+=String.fromCharCode(h);break;case 19:j="";for(f=0;f<k/2;f++)h=d[e++],g=h&255,h=(h&65280)>>8,j+=String.fromCharCode(g),j+=String.fromCharCode(h);c.instance_number=
parseInt(j,10);break;case 50:j="";for(f=0;f<k/2;f++)h=d[e++],g=h&255,h=(h&65280)>>8,j+=String.fromCharCode(g),j+=String.fromCharCode(h);j=j.split("\\");c.image_position_patient=[parseFloat(j[0]),parseFloat(j[1]),parseFloat(j[2])];break;case 55:j="";for(f=0;f<k/2;f++)h=d[e++],g=h&255,h=(h&65280)>>8,j+=String.fromCharCode(g),j+=String.fromCharCode(h);j=j.split("\\");c.image_orientation_patient=[parseFloat(j[0]),parseFloat(j[1]),parseFloat(j[2]),parseFloat(j[3]),parseFloat(j[4]),parseFloat(j[5])];break;
default:e=X.parserDCM.prototype.handleDefaults(d,e,h,k)}break;case 65534:switch(g){default:k=0,e+=k/2}break;case 8:switch(g){case 24:c.sop_instance_uid="";for(f=0;f<k/2;f++)h=d[e++],g=h&255,h=(h&65280)>>8,c.sop_instance_uid+=String.fromCharCode(g),c.sop_instance_uid+=String.fromCharCode(h);break;default:e=X.parserDCM.prototype.handleDefaults(d,e,h,k)}break;case 16:switch(g){case 8720:j="";for(f=0;f<k/2;f++)h=d[e++],g=h&255,h=(h&65280)>>8,j+=String.fromCharCode(g),j+=String.fromCharCode(h);break;default:e=
X.parserDCM.prototype.handleDefaults(d,e,h,k)}break;default:e=X.parserDCM.prototype.handleDefaults(d,e,h,k)}switch(c.bits_allocated){case 8:c.data=new Uint8Array(c.columns*c.rows);break;case 16:c.data=new Uint16Array(c.columns*c.rows);break;case 32:c.data=new Uint32Array(c.columns*c.rows)}this.jumpTo(this._data.byteLength-2*c.columns*c.rows);d=null;switch(c.bits_allocated){case 8:d=this.scan("uchar",c.columns*c.rows);break;case 16:d=this.scan("ushort",c.columns*c.rows);break;case 32:d=this.scan("uint",
c.columns*c.rows)}c.data=d;b.slices.push(c);return b};goog.exportSymbol("X.parserDCM",X.parserDCM);goog.exportSymbol("X.parserDCM.prototype.parse",X.parserDCM.prototype.parse);X.parserVTK=function(){X.parser.call(this);this._classname="parserVTK"};goog.inherits(X.parserVTK,X.parser);
X.parserVTK.prototype.parse=function(a,b,c){X.TIMER(this._classname+".parse");var d=b._points,e=b._normals,f=new Uint8Array(c),g="";b._points=d=new X.triplets(c.byteLength);b._normals=e=new X.triplets(c.byteLength);c=0;for(var h=f.length;c<h;c+=32768)g+=this.parseChars(f,c,Math.min(c+32768,h));f=g.split("\n");g=f.length;this._unorderedNormals=this._unorderedPoints=null;this._geometries=[];this._objectType=X.displayable.types.TRIANGLES;this._normalsMode=this._pointDataMode=this._geometryMode=this._pointsMode=
!1;c=0;for(h=g%8;h--;)this.parseLine(f[c]),c++;for(h=0.125*g^0;h--;)this.parseLine(f[c]),c++,this.parseLine(f[c]),c++,this.parseLine(f[c]),c++,this.parseLine(f[c]),c++,this.parseLine(f[c]),c++,this.parseLine(f[c]),c++,this.parseLine(f[c]),c++,this.parseLine(f[c]),c++;this.configure(d,e);b._type=this._objectType;X.TIMERSTOP(this._classname+".parse");d=new X.event.ModifiedEvent;d._object=b;d._container=a;this.dispatchEvent(d)};
X.parserVTK.prototype.parseLine=function(a){a=a.replace(/^\s+|\s+$/g,"");a=a.split(" ");var b=a.length,c=a[0];switch(c){case "POINTS":this._pointsMode=!0;this._pointDataMode=this._geometryMode=!1;a=parseInt(a[1],10);this._unorderedPoints=new X.triplets(3*a);this._unorderedNormals=new X.triplets(3*a);return;case "VERTICES":this._geometryMode=!0;this._pointDataMode=this._pointsMode=!1;a=parseInt(a[1],10);if(3<=a)this._objectType=X.displayable.types.TRIANGLES;else if(1==a)this._objectType=X.displayable.types.POINTS;
else throw Error("This VTK file is not supported!");this._geometries=[];return;case "TRIANGLE_STRIPS":this._geometryMode=!0;this._pointDataMode=this._pointsMode=!1;this._objectType=X.displayable.types.TRIANGLE_STRIPS;this._geometries=[];return;case "LINES":this._geometryMode=!0;this._pointDataMode=this._pointsMode=!1;this._objectType=X.displayable.types.LINES;this._geometries=[];return;case "POLYGONS":this._geometryMode=!0;this._pointDataMode=this._pointsMode=!1;this._objectType=X.displayable.types.POLYGONS;
this._geometries=[];return;case "POINT_DATA":this._pointDataMode=!0;this._geometryMode=this._pointsMode=!1;return}if(this._pointsMode)if(1==b||isNaN(parseFloat(c)))this._pointsMode=!1;else{if(3<=b){var c=parseFloat(a[0]),d=parseFloat(a[1]),e=parseFloat(a[2]);this._unorderedPoints.add(c,d,e)}6<=b&&(c=parseFloat(a[3]),d=parseFloat(a[4]),e=parseFloat(a[5]),this._unorderedPoints.add(c,d,e));9<=b&&(b=parseFloat(a[6]),c=parseFloat(a[7]),a=parseFloat(a[8]),this._unorderedPoints.add(b,c,a))}else this._geometryMode?
1==b||isNaN(parseFloat(c))?this._geometryMode=!1:(a=a.slice(1),this._geometries.push(a)):this._pointDataMode&&("NORMALS"==c?this._normalsMode=!0:1==b||isNaN(parseFloat(c))?this._normalsMode=this._pointDataMode=!1:this._normalsMode&&(3<=b&&(c=parseFloat(a[0]),d=parseFloat(a[1]),e=parseFloat(a[2]),this._unorderedNormals.add(c,d,e)),6<=b&&(c=parseFloat(a[3]),d=parseFloat(a[4]),e=parseFloat(a[5]),this._unorderedNormals.add(c,d,e)),9<=b&&(b=parseFloat(a[6]),c=parseFloat(a[7]),a=parseFloat(a[8]),this._unorderedNormals.add(b,
c,a))))};
X.parserVTK.prototype.configure=function(a,b){var c=this._unorderedPoints,d=this._unorderedNormals,e=d.length,f=this._geometries.length,g=f;do{var h=this._geometries[f-g],k=h.length,j;for(j=0;j<k&&!(this._objectType==X.displayable.types.LINES&&j+1>=k);j++){var m=parseInt(h[j],10),l=c.get(m);a.add(l[0],l[1],l[2]);var n=m,p=l;this._objectType==X.displayable.types.LINES?(n=parseInt(h[j+1],10),p=c.get(n),a.add(p[0],p[1],p[2])):this._objectType==X.displayable.types.TRIANGLE_STRIPS&&(0==j||j==k-1)&&a.add(l[0],
l[1],l[2]);m<e?(p=d.get(m),b.add(p[0],p[1],p[2]),this._objectType==X.displayable.types.LINES?(n=d.get(n),b.add(n[0],n[1],n[2])):this._objectType==X.displayable.types.TRIANGLE_STRIPS&&(0==j||j==k-1)&&b.add(p[0],p[1],p[2])):(n=new goog.math.Vec3(l[0],l[1],l[2]),n.normalize(),b.add(n.x,n.y,n.z),this._objectType==X.displayable.types.LINES?(n=new goog.math.Vec3(p[0],p[1],p[2]),n.normalize(),b.add(n.x,n.y,n.z)):this._objectType==X.displayable.types.TRIANGLE_STRIPS&&(0==j||j==k-1)&&b.add(n.x,n.y,n.z))}g--}while(0<
g)};goog.exportSymbol("X.parserVTK",X.parserVTK);goog.exportSymbol("X.parserVTK.prototype.parse",X.parserVTK.prototype.parse);X.parserFSM=function(){X.parser.call(this);this._classname="parserFSM";this._littleEndian=!1};goog.inherits(X.parserFSM,X.parser);
X.parserFSM.prototype.parse=function(a,b,c){X.TIMER(this._classname+".parse");this._data=c;var d=b._points,e=b._normals;b._pointIndices=[];var f=b._pointIndices;c=0;var g;do g=this.scan("uchar"),c++;while(200>c&&10!=g);this.scan("uchar");e=this.scan("uint");c=this.scan("uint");var h=this.scan("float",3*e);g=this.scan("uint",3*c);var k=new Uint32Array(e),j=new Float32Array(9*c);b._points=d=new X.triplets(9*c);b._normals=e=new X.triplets(9*c);var m;for(m=0;m<c;m++){var l=3*m,n=g[l],p=g[l+1],q=g[l+2];
f.push(n);f.push(p);f.push(q);k[n]+=1;k[p]+=1;k[q]+=1;var l=3*n,r=3*p,s=3*q,z=h[l],x=h[l+1],t=h[l+2],u=h[r],v=h[r+1],y=h[r+2],p=h[s],q=h[s+1],n=h[s+2];d.add(z,x,t);d.add(u,v,y);d.add(p,q,n);z=new goog.math.Vec3(z,x,t);u=new goog.math.Vec3(u,v,y);p=new goog.math.Vec3(p,q,n);q=u.clone().subtract(z);p=p.clone().subtract(z);p=goog.math.Vec3.cross(q,p).normalize();j[l]+=p.x;j[l+1]+=p.y;j[l+2]+=p.z;j[r]+=p.x;j[r+1]+=p.y;j[r+2]+=p.z;j[s]+=p.x;j[s+1]+=p.y;j[s+2]+=p.z}for(m=0;m<c;m++)l=3*m,n=g[l],p=g[l+1],
q=g[l+2],l=3*n,r=3*p,s=3*q,f=j[r],h=j[r+1],u=j[r+2],r=j[s],d=j[s+1],s=j[s+2],l=new goog.math.Vec3(j[l],j[l+1],j[l+2]),f=new goog.math.Vec3(f,h,u),s=new goog.math.Vec3(r,d,s),l=l.scale(1/k[n]).normalize(),f=f.scale(1/k[p]).normalize(),s=s.scale(1/k[q]).normalize(),e.add(l.x,l.y,l.z),e.add(f.x,f.y,f.z),e.add(s.x,s.y,s.z);c=this.scan("uchar",this._data.byteLength-this._dataPointer);g=null;for(l=0;l<c.length;l++)if(99==c[l]&&114==c[l+1]&&97==c[l+2]&&115==c[l+3]){for(e=g=l+9;10!=c[l]&&l<c.length;)e++,
l++;g=this.parseChars(c.subarray(g,e)).split(" ");break}g&&(b._transform.translateX(parseFloat(g[0])),b._transform.translateY(parseFloat(g[1])),b._transform.translateZ(parseFloat(g[2])));b._type=X.displayable.types.TRIANGLES;X.TIMERSTOP(this._classname+".parse");c=new X.event.ModifiedEvent;c._object=b;c._container=a;this.dispatchEvent(c)};goog.exportSymbol("X.parserFSM",X.parserFSM);goog.exportSymbol("X.parserFSM.prototype.parse",X.parserFSM.prototype.parse);var USE_TYPEDARRAY=!0;var Zlib={CRC32:{}},ZLIB_CRC32_EXPORT=!1;Zlib.CRC32.calc=function(a,b,c){return Zlib.CRC32.update(a,0,b,c)};
Zlib.CRC32.update=function(a,b,c,d){var e=Zlib.CRC32.Table,f="number"===typeof c?c:c=0;d="number"===typeof d?d:a.length;b^=4294967295;for(f=d&7;f--;++c)b=b>>>8^e[(b^a[c])&255];for(f=d>>3;f--;c+=8)b=b>>>8^e[(b^a[c])&255],b=b>>>8^e[(b^a[c+1])&255],b=b>>>8^e[(b^a[c+2])&255],b=b>>>8^e[(b^a[c+3])&255],b=b>>>8^e[(b^a[c+4])&255],b=b>>>8^e[(b^a[c+5])&255],b=b>>>8^e[(b^a[c+6])&255],b=b>>>8^e[(b^a[c+7])&255];return(b^4294967295)>>>0};
Zlib.CRC32.Table=function(a){return USE_TYPEDARRAY?new Uint32Array(a):a}([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,
1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,
1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,
1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,
570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,
3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918E3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);ZLIB_CRC32_EXPORT&&(goog.exportSymbol("Zlib.CRC32",Zlib.CRC32),goog.exportSymbol("Zlib.CRC32.calc",Zlib.CRC32.calc),goog.exportSymbol("Zlib.CRC32.update",Zlib.CRC32.update));Zlib.Huffman={};Zlib.Huffman.buildHuffmanTable=function(a){var b=a.length,c=0,d=Number.POSITIVE_INFINITY,e,f,g,h,k,j,m,l,n;for(l=0;l<b;++l)a[l]>c&&(c=a[l]),a[l]<d&&(d=a[l]);e=1<<c;f=new (USE_TYPEDARRAY?Uint32Array:Array)(e);g=1;h=0;for(k=2;g<=c;){for(l=0;l<b;++l)if(a[l]===g){j=0;m=h;for(n=0;n<g;++n)j=j<<1|m&1,m>>=1;for(n=j;n<e;n+=k)f[n]=g<<16|l;++h}++g;h<<=1;k<<=1}return[f,c,d]};var ZLIB_RAW_INFLATE_EXPORT=!1,ZLIB_RAW_INFLATE_BUFFER_SIZE=32768;
Zlib.RawInflate=function(a,b){this.blocks=[];this.bufferSize=ZLIB_RAW_INFLATE_BUFFER_SIZE;this.bitsbuflen=this.bitsbuf=this.ip=this.totalpos=0;this.input=USE_TYPEDARRAY?new Uint8Array(a):a;this.bfinal=!1;this.bufferType=Zlib.RawInflate.BufferType.ADAPTIVE;this.resize=!1;if(b||!(b={}))b.index&&(this.ip=b.index),b.bufferSize&&(this.bufferSize=b.bufferSize),b.bufferType&&(this.bufferType=b.bufferType),b.resize&&(this.resize=b.resize);switch(this.bufferType){case Zlib.RawInflate.BufferType.BLOCK:this.op=
Zlib.RawInflate.MaxBackwardLength;this.output=new (USE_TYPEDARRAY?Uint8Array:Array)(Zlib.RawInflate.MaxBackwardLength+this.bufferSize+Zlib.RawInflate.MaxCopyLength);break;case Zlib.RawInflate.BufferType.ADAPTIVE:this.op=0;this.output=new (USE_TYPEDARRAY?Uint8Array:Array)(this.bufferSize);this.expandBuffer=this.expandBufferAdaptive;this.concatBuffer=this.concatBufferDynamic;this.decodeHuffman=this.decodeHuffmanAdaptive;break;default:throw Error("invalid inflate mode");}};
Zlib.RawInflate.BufferType={BLOCK:0,ADAPTIVE:1};Zlib.RawInflate.prototype.decompress=function(){for(;!this.bfinal;)this.parseBlock();return this.concatBuffer()};Zlib.RawInflate.MaxBackwardLength=32768;Zlib.RawInflate.MaxCopyLength=258;Zlib.RawInflate.Order=function(a){return USE_TYPEDARRAY?new Uint16Array(a):a}([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);
Zlib.RawInflate.LengthCodeTable=function(a){return USE_TYPEDARRAY?new Uint16Array(a):a}([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258]);Zlib.RawInflate.LengthExtraTable=function(a){return USE_TYPEDARRAY?new Uint8Array(a):a}([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0]);
Zlib.RawInflate.DistCodeTable=function(a){return USE_TYPEDARRAY?new Uint16Array(a):a}([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577]);Zlib.RawInflate.DistExtraTable=function(a){return USE_TYPEDARRAY?new Uint8Array(a):a}([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]);
Zlib.RawInflate.FixedLiteralLengthTable=function(a){return a}(function(){var a=new (USE_TYPEDARRAY?Uint8Array:Array)(288),b,c;b=0;for(c=a.length;b<c;++b)a[b]=143>=b?8:255>=b?9:279>=b?7:8;return(0,Zlib.Huffman.buildHuffmanTable)(a)}());Zlib.RawInflate.FixedDistanceTable=function(a){return a}(function(){var a=new (USE_TYPEDARRAY?Uint8Array:Array)(30),b,c;b=0;for(c=a.length;b<c;++b)a[b]=5;return(0,Zlib.Huffman.buildHuffmanTable)(a)}());
Zlib.RawInflate.prototype.parseBlock=function(){var a=this.readBits(3);a&1&&(this.bfinal=!0);a>>>=1;switch(a){case 0:this.parseUncompressedBlock();break;case 1:this.parseFixedHuffmanBlock();break;case 2:this.parseDynamicHuffmanBlock();break;default:throw Error("unknown BTYPE: "+a);}};
Zlib.RawInflate.prototype.readBits=function(a){for(var b=this.bitsbuf,c=this.bitsbuflen,d=this.input,e=this.ip,f;c<a;){f=d[e++];if(void 0===f)throw Error("input buffer is broken");b|=f<<c;c+=8}f=b&(1<<a)-1;this.bitsbuf=b>>>a;this.bitsbuflen=c-a;this.ip=e;return f};
Zlib.RawInflate.prototype.readCodeByTable=function(a){var b=this.bitsbuf,c=this.bitsbuflen,d=this.input,e=this.ip,f=a[0];a=a[1];for(var g;c<a;){g=d[e++];if(void 0===g)throw Error("input buffer is broken");b|=g<<c;c+=8}d=f[b&(1<<a)-1];f=d>>>16;this.bitsbuf=b>>f;this.bitsbuflen=c-f;this.ip=e;return d&65535};
Zlib.RawInflate.prototype.parseUncompressedBlock=function(){var a=this.input,b=this.ip,c=this.output,d=this.op,e,f,g,h=c.length;this.bitsbuflen=this.bitsbuf=0;e=a[b++];if(void 0===e)throw Error("invalid uncompressed block header: LEN (first byte)");f=e;e=a[b++];if(void 0===e)throw Error("invalid uncompressed block header: LEN (second byte)");f|=e<<8;e=a[b++];if(void 0===e)throw Error("invalid uncompressed block header: NLEN (first byte)");g=e;e=a[b++];if(void 0===e)throw Error("invalid uncompressed block header: NLEN (second byte)");
if(f===~(g|e<<8))throw Error("invalid uncompressed block header: length verify");if(b+f>a.length)throw Error("input buffer is broken");switch(this.bufferType){case Zlib.RawInflate.BufferType.BLOCK:for(;d+f>c.length;){e=h-d;f-=e;if(USE_TYPEDARRAY)c.set(a.subarray(b,b+e),d),d+=e,b+=e;else for(;e--;)c[d++]=a[b++];this.op=d;c=this.expandBuffer();d=this.op}break;case Zlib.RawInflate.BufferType.ADAPTIVE:for(;d+f>c.length;)c=this.expandBuffer({fixRatio:2});break;default:throw Error("invalid inflate mode");
}if(USE_TYPEDARRAY)c.set(a.subarray(b,b+f),d),d+=f,b+=f;else for(;f--;)c[d++]=a[b++];this.ip=b;this.op=d;this.output=c};Zlib.RawInflate.prototype.parseFixedHuffmanBlock=function(){this.decodeHuffman(Zlib.RawInflate.FixedLiteralLengthTable,Zlib.RawInflate.FixedDistanceTable)};
Zlib.RawInflate.prototype.parseDynamicHuffmanBlock=function(){function a(a,b,c){var d,e,f;for(f=0;f<a;)switch(d=this.readCodeByTable(b),d){case 16:for(d=3+this.readBits(2);d--;)c[f++]=e;break;case 17:for(d=3+this.readBits(3);d--;)c[f++]=0;e=0;break;case 18:for(d=11+this.readBits(7);d--;)c[f++]=0;e=0;break;default:e=c[f++]=d}return c}var b=this.readBits(5)+257,c=this.readBits(5)+1,d=this.readBits(4)+4,e=new (USE_TYPEDARRAY?Uint8Array:Array)(Zlib.RawInflate.Order.length),f;for(f=0;f<d;++f)e[Zlib.RawInflate.Order[f]]=
this.readBits(3);d=(0,Zlib.Huffman.buildHuffmanTable)(e);e=new (USE_TYPEDARRAY?Uint8Array:Array)(b);f=new (USE_TYPEDARRAY?Uint8Array:Array)(c);this.decodeHuffman((0,Zlib.Huffman.buildHuffmanTable)(a.call(this,b,d,e)),(0,Zlib.Huffman.buildHuffmanTable)(a.call(this,c,d,f)))};
Zlib.RawInflate.prototype.decodeHuffman=function(a,b){var c=this.output,d=this.op;this.currentLitlenTable=a;for(var e=c.length-Zlib.RawInflate.MaxCopyLength,f,g,h;256!==(f=this.readCodeByTable(a));)if(256>f)d>=e&&(this.op=d,c=this.expandBuffer(),d=this.op),c[d++]=f;else{f-=257;h=Zlib.RawInflate.LengthCodeTable[f];0<Zlib.RawInflate.LengthExtraTable[f]&&(h+=this.readBits(Zlib.RawInflate.LengthExtraTable[f]));f=this.readCodeByTable(b);g=Zlib.RawInflate.DistCodeTable[f];0<Zlib.RawInflate.DistExtraTable[f]&&
(g+=this.readBits(Zlib.RawInflate.DistExtraTable[f]));d>=e&&(this.op=d,c=this.expandBuffer(),d=this.op);for(;h--;)c[d]=c[d++-g]}for(;8<=this.bitsbuflen;)this.bitsbuflen-=8,this.ip--;this.op=d};
Zlib.RawInflate.prototype.decodeHuffmanAdaptive=function(a,b){var c=this.output,d=this.op;this.currentLitlenTable=a;for(var e=c.length,f,g,h;256!==(f=this.readCodeByTable(a));)if(256>f)d>=e&&(c=this.expandBuffer(),e=c.length),c[d++]=f;else{f-=257;h=Zlib.RawInflate.LengthCodeTable[f];0<Zlib.RawInflate.LengthExtraTable[f]&&(h+=this.readBits(Zlib.RawInflate.LengthExtraTable[f]));f=this.readCodeByTable(b);g=Zlib.RawInflate.DistCodeTable[f];0<Zlib.RawInflate.DistExtraTable[f]&&(g+=this.readBits(Zlib.RawInflate.DistExtraTable[f]));
d+h>e&&(c=this.expandBuffer(),e=c.length);for(;h--;)c[d]=c[d++-g]}for(;8<=this.bitsbuflen;)this.bitsbuflen-=8,this.ip--;this.op=d};
Zlib.RawInflate.prototype.expandBuffer=function(){var a=new (USE_TYPEDARRAY?Uint8Array:Array)(this.op-Zlib.RawInflate.MaxBackwardLength),b=this.op-Zlib.RawInflate.MaxBackwardLength,c,d,e=this.output;if(USE_TYPEDARRAY)a.set(e.subarray(Zlib.RawInflate.MaxBackwardLength,a.length));else{c=0;for(d=a.length;c<d;++c)a[c]=e[c+Zlib.RawInflate.MaxBackwardLength]}this.blocks.push(a);this.totalpos+=a.length;if(USE_TYPEDARRAY)e.set(e.subarray(b,b+Zlib.RawInflate.MaxBackwardLength));else for(c=0;c<Zlib.RawInflate.MaxBackwardLength;++c)e[c]=
e[b+c];this.op=Zlib.RawInflate.MaxBackwardLength;return e};Zlib.RawInflate.prototype.expandBufferAdaptive=function(a){var b=this.input.length/this.ip+1|0,c=this.input,d=this.output;a&&("number"===typeof a.fixRatio&&(b=a.fixRatio),"number"===typeof a.addRatio&&(b+=a.addRatio));2>b?(a=(c.length-this.ip)/this.currentLitlenTable[2],a=258*(a/2)|0,a=a<d.length?d.length+a:d.length<<1):a=d.length*b;USE_TYPEDARRAY?(a=new Uint8Array(a),a.set(d)):a=d;return this.output=a};
Zlib.RawInflate.prototype.concatBuffer=function(){var a=0,b=this.output,c=this.blocks,d,e=new (USE_TYPEDARRAY?Uint8Array:Array)(this.totalpos+(this.op-Zlib.RawInflate.MaxBackwardLength)),f,g,h,k;if(0===c.length)return USE_TYPEDARRAY?this.output.subarray(Zlib.RawInflate.MaxBackwardLength,this.op):this.output.slice(Zlib.RawInflate.MaxBackwardLength,this.op);f=0;for(g=c.length;f<g;++f){d=c[f];h=0;for(k=d.length;h<k;++h)e[a++]=d[h]}f=Zlib.RawInflate.MaxBackwardLength;for(g=this.op;f<g;++f)e[a++]=b[f];
this.blocks=[];return this.buffer=e};Zlib.RawInflate.prototype.concatBufferDynamic=function(){var a,b=this.op;USE_TYPEDARRAY?this.resize?(a=new Uint8Array(b),a.set(this.output.subarray(0,b))):a=this.output.subarray(0,b):(this.output.length>b&&(this.output.length=b),a=this.output);return this.buffer=a};ZLIB_RAW_INFLATE_EXPORT&&(goog.exportSymbol("Zlib.RawInflate",Zlib.RawInflate),goog.exportSymbol("Zlib.RawInflate.prototype.decompress",Zlib.RawInflate.prototype.decompress));Zlib.Heap=function(a){this.buffer=new (USE_TYPEDARRAY?Uint16Array:Array)(2*a);this.length=0};Zlib.Heap.prototype.getParent=function(a){return 2*((a-2)/4|0)};Zlib.Heap.prototype.getChild=function(a){return 2*a+2};Zlib.Heap.prototype.push=function(a,b){var c,d,e=this.buffer,f;c=this.length;e[this.length++]=b;for(e[this.length++]=a;0<c;)if(d=this.getParent(c),e[c]>e[d])f=e[c],e[c]=e[d],e[d]=f,f=e[c+1],e[c+1]=e[d+1],e[d+1]=f,c=d;else break;return this.length};
Zlib.Heap.prototype.pop=function(){var a,b,c=this.buffer,d,e,f;b=c[0];a=c[1];this.length-=2;c[0]=c[this.length];c[1]=c[this.length+1];for(f=0;;){e=this.getChild(f);if(e>=this.length)break;e+2<this.length&&c[e+2]>c[e]&&(e+=2);if(c[e]>c[f])d=c[f],c[f]=c[e],c[e]=d,d=c[f+1],c[f+1]=c[e+1],c[e+1]=d;else break;f=e}return{index:a,value:b,length:this.length}};Zlib.BitStream=function(a,b){this.index="number"===typeof b?b:0;this.bitindex=0;this.buffer=a instanceof(USE_TYPEDARRAY?Uint8Array:Array)?a:new (USE_TYPEDARRAY?Uint8Array:Array)(Zlib.BitStream.DefaultBlockSize);if(2*this.buffer.length<=this.index)throw Error("invalid index");this.buffer.length<=this.index&&this.expandBuffer()};Zlib.BitStream.DefaultBlockSize=32768;
Zlib.BitStream.prototype.expandBuffer=function(){var a=this.buffer,b,c=a.length,d=new (USE_TYPEDARRAY?Uint8Array:Array)(c<<1);if(USE_TYPEDARRAY)d.set(a);else for(b=0;b<c;++b)d[b]=a[b];return this.buffer=d};
Zlib.BitStream.prototype.writeBits=function(a,b,c){var d=this.buffer,e=this.index,f=this.bitindex,g=d[e];c&&1<b&&(a=8<b?(Zlib.BitStream.ReverseTable[a&255]<<24|Zlib.BitStream.ReverseTable[a>>>8&255]<<16|Zlib.BitStream.ReverseTable[a>>>16&255]<<8|Zlib.BitStream.ReverseTable[a>>>24&255])>>32-b:Zlib.BitStream.ReverseTable[a]>>8-b);if(8>b+f)g=g<<b|a,f+=b;else for(c=0;c<b;++c)g=g<<1|a>>b-c-1&1,8===++f&&(f=0,d[e++]=Zlib.BitStream.ReverseTable[g],g=0,e===d.length&&(d=this.expandBuffer()));d[e]=g;this.buffer=
d;this.bitindex=f;this.index=e};Zlib.BitStream.prototype.finish=function(){var a=this.buffer,b=this.index;0<this.bitindex&&(a[b]<<=8-this.bitindex,a[b]=Zlib.BitStream.ReverseTable[a[b]],b++);USE_TYPEDARRAY?a=a.subarray(0,b):a.length=b;return a};Zlib.BitStream.ReverseTable=function(a){return a}(function(){var a=new (USE_TYPEDARRAY?Uint8Array:Array)(256),b;for(b=0;256>b;++b){for(var c=a,d=b,e=b,f=e,g=7,e=e>>>1;e;e>>>=1)f<<=1,f|=e&1,--g;c[d]=(f<<g&255)>>>0}return a}());var ZLIB_RAWDEFLATE_EXPORT=!1;
Zlib.RawDeflate=function(a,b){this.compressionType=Zlib.RawDeflate.CompressionType.DYNAMIC;this.lazy=0;this.input=a;this.op=0;b&&(b.lazy&&(this.lazy=b.lazy),"number"===typeof b.compressionType&&(this.compressionType=b.compressionType),b.outputBuffer&&(this.output=USE_TYPEDARRAY&&b.outputBuffer instanceof Array?new Uint8Array(b.outputBuffer):b.outputBuffer),"number"===typeof b.outputIndex&&(this.op=b.outputIndex));this.output||(this.output=new (USE_TYPEDARRAY?Uint8Array:Array)(32768))};
Zlib.RawDeflate.CompressionType={NONE:0,FIXED:1,DYNAMIC:2,RESERVED:3};Zlib.RawDeflate.Lz77MinLength=3;Zlib.RawDeflate.Lz77MaxLength=258;Zlib.RawDeflate.WindowSize=32768;Zlib.RawDeflate.MaxCodeLength=16;Zlib.RawDeflate.HUFMAX=286;
Zlib.RawDeflate.FixedHuffmanTable=function(){var a=[],b;for(b=0;288>b;b++)switch(!0){case 143>=b:a.push([b+48,8]);break;case 255>=b:a.push([b-144+400,9]);break;case 279>=b:a.push([b-256+0,7]);break;case 287>=b:a.push([b-280+192,8]);break;default:throw"invalid literal: "+b;}return a}();
Zlib.RawDeflate.prototype.compress=function(){var a,b,c,d=this.input;switch(this.compressionType){case Zlib.RawDeflate.CompressionType.NONE:b=0;for(c=d.length;b<c;)a=USE_TYPEDARRAY?d.subarray(b,b+65535):d.slice(b,b+65535),b+=a.length,this.makeNocompressBlock(a,b===c);break;case Zlib.RawDeflate.CompressionType.FIXED:this.output=this.makeFixedHuffmanBlock(d,!0);this.op=this.output.length;break;case Zlib.RawDeflate.CompressionType.DYNAMIC:this.output=this.makeDynamicHuffmanBlock(d,!0);this.op=this.output.length;
break;default:throw"invalid compression type";}return this.output};
Zlib.RawDeflate.prototype.makeNocompressBlock=function(a,b){var c,d,e=this.output,f=this.op;if(USE_TYPEDARRAY){for(e=new Uint8Array(this.output.buffer);e.length<=f+a.length+5;)e=new Uint8Array(e.length<<1);e.set(this.output)}c=Zlib.RawDeflate.CompressionType.NONE;e[f++]=(b?1:0)|c<<1;c=a.length;d=~c+65536&65535;e[f++]=c&255;e[f++]=c>>>8&255;e[f++]=d&255;e[f++]=d>>>8&255;if(USE_TYPEDARRAY)e.set(a,f),f+=a.length,e=e.subarray(0,f);else{c=0;for(d=a.length;c<d;++c)e[f++]=a[c];e.length=f}this.op=f;return this.output=
e};Zlib.RawDeflate.prototype.makeFixedHuffmanBlock=function(a,b){var c=new Zlib.BitStream(new Uint8Array(this.output.buffer),this.op),d;d=Zlib.RawDeflate.CompressionType.FIXED;c.writeBits(b?1:0,1,!0);c.writeBits(d,2,!0);d=this.lz77(a);this.fixedHuffman(d,c);return c.finish()};
Zlib.RawDeflate.prototype.makeDynamicHuffmanBlock=function(a,b){var c=new Zlib.BitStream(new Uint8Array(this.output),this.op),d,e,f,g,h=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],k,j,m,l,n,p,q=Array(19),r;d=Zlib.RawDeflate.CompressionType.DYNAMIC;c.writeBits(b?1:0,1,!0);c.writeBits(d,2,!0);d=this.lz77(a);k=this.getLengths_(this.freqsLitLen,15);j=this.getCodesFromLengths_(k);m=this.getLengths_(this.freqsDist,7);l=this.getCodesFromLengths_(m);for(e=286;257<e&&0===k[e-1];e--);for(f=30;1<f&&0===
m[f-1];f--);n=this.getTreeSymbols_(e,k,f,m);p=this.getLengths_(n.freqs,7);for(r=0;19>r;r++)q[r]=p[h[r]];for(g=19;4<g&&0===q[g-1];g--);h=this.getCodesFromLengths_(p);c.writeBits(e-257,5,!0);c.writeBits(f-1,5,!0);c.writeBits(g-4,4,!0);for(r=0;r<g;r++)c.writeBits(q[r],3,!0);r=0;for(q=n.codes.length;r<q;r++)if(e=n.codes[r],c.writeBits(h[e],p[e],!0),16<=e){r++;switch(e){case 16:e=2;break;case 17:e=3;break;case 18:e=7;break;default:throw"invalid code: "+e;}c.writeBits(n.codes[r],e,!0)}this.dynamicHuffman(d,
[j,k],[l,m],c);return c.finish()};Zlib.RawDeflate.prototype.dynamicHuffman=function(a,b,c,d){var e,f,g,h,k;g=b[0];b=b[1];h=c[0];k=c[1];c=0;for(e=a.length;c<e;++c)if(f=a[c],d.writeBits(g[f],b[f],!0),256<f)d.writeBits(a[++c],a[++c],!0),f=a[++c],d.writeBits(h[f],k[f],!0),d.writeBits(a[++c],a[++c],!0);else if(256===f)break;return d};
Zlib.RawDeflate.prototype.fixedHuffman=function(a,b){var c,d,e;c=0;for(d=a.length;c<d;c++)if(e=a[c],Zlib.BitStream.prototype.writeBits.apply(b,Zlib.RawDeflate.FixedHuffmanTable[e]),256<e)b.writeBits(a[++c],a[++c],!0),b.writeBits(a[++c],5),b.writeBits(a[++c],a[++c],!0);else if(256===e)break;return b};Zlib.RawDeflate.Lz77Match=function(a,b){this.length=a;this.backwardDistance=b};
Zlib.RawDeflate.Lz77Match.LengthCodeTable=function(a){return USE_TYPEDARRAY?new Uint32Array(a):a}(function(){function a(a){switch(!0){case 3===a:return[257,a-3,0];case 4===a:return[258,a-4,0];case 5===a:return[259,a-5,0];case 6===a:return[260,a-6,0];case 7===a:return[261,a-7,0];case 8===a:return[262,a-8,0];case 9===a:return[263,a-9,0];case 10===a:return[264,a-10,0];case 12>=a:return[265,a-11,1];case 14>=a:return[266,a-13,1];case 16>=a:return[267,a-15,1];case 18>=a:return[268,a-17,1];case 22>=a:return[269,
a-19,2];case 26>=a:return[270,a-23,2];case 30>=a:return[271,a-27,2];case 34>=a:return[272,a-31,2];case 42>=a:return[273,a-35,3];case 50>=a:return[274,a-43,3];case 58>=a:return[275,a-51,3];case 66>=a:return[276,a-59,3];case 82>=a:return[277,a-67,4];case 98>=a:return[278,a-83,4];case 114>=a:return[279,a-99,4];case 130>=a:return[280,a-115,4];case 162>=a:return[281,a-131,5];case 194>=a:return[282,a-163,5];case 226>=a:return[283,a-195,5];case 257>=a:return[284,a-227,5];case 258===a:return[285,a-258,0];
default:throw"invalid length: "+a;}}var b=[],c,d;for(c=3;258>=c;c++)d=a(c),b[c]=d[2]<<24|d[1]<<16|d[0];return b}());
Zlib.RawDeflate.Lz77Match.prototype.getDistanceCode_=function(a){switch(!0){case 1===a:a=[0,a-1,0];break;case 2===a:a=[1,a-2,0];break;case 3===a:a=[2,a-3,0];break;case 4===a:a=[3,a-4,0];break;case 6>=a:a=[4,a-5,1];break;case 8>=a:a=[5,a-7,1];break;case 12>=a:a=[6,a-9,2];break;case 16>=a:a=[7,a-13,2];break;case 24>=a:a=[8,a-17,3];break;case 32>=a:a=[9,a-25,3];break;case 48>=a:a=[10,a-33,4];break;case 64>=a:a=[11,a-49,4];break;case 96>=a:a=[12,a-65,5];break;case 128>=a:a=[13,a-97,5];break;case 192>=
a:a=[14,a-129,6];break;case 256>=a:a=[15,a-193,6];break;case 384>=a:a=[16,a-257,7];break;case 512>=a:a=[17,a-385,7];break;case 768>=a:a=[18,a-513,8];break;case 1024>=a:a=[19,a-769,8];break;case 1536>=a:a=[20,a-1025,9];break;case 2048>=a:a=[21,a-1537,9];break;case 3072>=a:a=[22,a-2049,10];break;case 4096>=a:a=[23,a-3073,10];break;case 6144>=a:a=[24,a-4097,11];break;case 8192>=a:a=[25,a-6145,11];break;case 12288>=a:a=[26,a-8193,12];break;case 16384>=a:a=[27,a-12289,12];break;case 24576>=a:a=[28,a-16385,
13];break;case 32768>=a:a=[29,a-24577,13];break;default:throw"invalid distance";}return a};Zlib.RawDeflate.Lz77Match.prototype.toLz77Array=function(){var a=this.backwardDistance,b=[],c=0,d;d=Zlib.RawDeflate.Lz77Match.LengthCodeTable[this.length];b[c++]=d&65535;b[c++]=d>>16&255;b[c++]=d>>24;d=this.getDistanceCode_(a);b[c++]=d[0];b[c++]=d[1];b[c++]=d[2];return b};
Zlib.RawDeflate.prototype.lz77=function(a){function b(a,b){var c=a.toLz77Array(),d,e;d=0;for(e=c.length;d<e;++d)m[l++]=c[d];p[c[0]]++;q[c[3]]++;n=a.length+b-1;j=null}var c,d,e,f,g,h={},k=Zlib.RawDeflate.WindowSize,j,m=USE_TYPEDARRAY?new Uint16Array(2*a.length):[],l=0,n=0,p=new (USE_TYPEDARRAY?Uint32Array:Array)(286),q=new (USE_TYPEDARRAY?Uint32Array:Array)(30),r=this.lazy;if(!USE_TYPEDARRAY){for(e=0;285>=e;)p[e++]=0;for(e=0;29>=e;)q[e++]=0}p[256]=1;c=0;for(d=a.length;c<d;++c){e=g=0;for(f=Zlib.RawDeflate.Lz77MinLength;e<
f&&c+e!==d;++e)g=g<<8|a[c+e];void 0===h[g]&&(h[g]=[]);e=h[g];if(!(0<n--)){for(;0<e.length&&c-e[0]>k;)e.shift();if(c+Zlib.RawDeflate.Lz77MinLength>=d){j&&b(j,-1);e=0;for(f=d-c;e<f;++e)g=a[c+e],m[l++]=g,++p[g];break}0<e.length?(f=this.searchLongestMatch_(a,c,e),j?j.length<f.length?(g=a[c-1],m[l++]=g,++p[g],b(f,0)):b(j,-1):f.length<r?j=f:b(f,0)):j?b(j,-1):(g=a[c],m[l++]=g,++p[g])}e.push(c)}m[l++]=256;p[256]++;this.freqsLitLen=p;this.freqsDist=q;return USE_TYPEDARRAY?m.subarray(0,l):m};
Zlib.RawDeflate.prototype.searchLongestMatch_=function(a,b,c){var d,e,f=0,g,h,k,j=a.length;h=0;k=c.length;a:for(;h<k;h++){d=c[k-h-1];g=Zlib.RawDeflate.Lz77MinLength;if(f>Zlib.RawDeflate.Lz77MinLength){for(g=f;g>Zlib.RawDeflate.Lz77MinLength;g--)if(a[d+g-1]!==a[b+g-1])continue a;g=f}for(;g<Zlib.RawDeflate.Lz77MaxLength&&b+g<j&&a[d+g]===a[b+g];)++g;g>f&&(e=d,f=g);if(g===Zlib.RawDeflate.Lz77MaxLength)break}return new Zlib.RawDeflate.Lz77Match(f,b-e)};
Zlib.RawDeflate.prototype.getTreeSymbols_=function(a,b,c,d){var e=new (USE_TYPEDARRAY?Uint32Array:Array)(a+c),f,g,h=new (USE_TYPEDARRAY?Uint32Array:Array)(316),k=new (USE_TYPEDARRAY?Uint8Array:Array)(19);for(f=g=0;f<a;f++)e[g++]=b[f];for(f=0;f<c;f++)e[g++]=d[f];if(!USE_TYPEDARRAY){f=0;for(b=k.length;f<b;++f)k[f]=0}f=c=0;for(b=e.length;f<b;f+=g){for(g=1;f+g<b&&e[f+g]===e[f];++g);a=g;if(0===e[f])if(3>a)for(;0<a--;)h[c++]=0,k[0]++;else for(;0<a;)d=138>a?a:138,d>a-3&&d<a&&(d=a-3),10>=d?(h[c++]=17,h[c++]=
d-3,k[17]++):(h[c++]=18,h[c++]=d-11,k[18]++),a-=d;else if(h[c++]=e[f],k[e[f]]++,a--,3>a)for(;0<a--;)h[c++]=e[f],k[e[f]]++;else for(;0<a;)d=6>a?a:6,d>a-3&&d<a&&(d=a-3),h[c++]=16,h[c++]=d-3,k[16]++,a-=d}return{codes:USE_TYPEDARRAY?h.subarray(0,c):h.slice(0,c),freqs:k}};
Zlib.RawDeflate.prototype.getLengths_=function(a,b){var c=a.length,d=new Zlib.Heap(2*Zlib.RawDeflate.HUFMAX),e=new (USE_TYPEDARRAY?Uint8Array:Array)(c),f,g,h;if(!USE_TYPEDARRAY)for(g=0;g<c;g++)e[g]=0;for(g=0;g<c;++g)0<a[g]&&d.push(g,a[g]);c=Array(d.length/2);f=new (USE_TYPEDARRAY?Uint32Array:Array)(d.length/2);if(1===c.length)return e[d.pop().index]=1,e;g=0;for(h=d.length/2;g<h;++g)c[g]=d.pop(),f[g]=c[g].value;d=this.reversePackageMerge_(f,f.length,b);g=0;for(h=c.length;g<h;++g)e[c[g].index]=d[g];
return e};
Zlib.RawDeflate.prototype.reversePackageMerge_=function(a,b,c){function d(a){var c=k[a][j[a]];c===b?(d(a+1),d(a+1)):--g[c];++j[a]}var e=new (USE_TYPEDARRAY?Uint16Array:Array)(c),f=new (USE_TYPEDARRAY?Uint8Array:Array)(c),g=new (USE_TYPEDARRAY?Uint8Array:Array)(b),h=Array(c),k=Array(c),j=Array(c),m=(1<<c)-b,l=1<<c-1,n,p;e[c-1]=b;for(n=0;n<c;++n)m<l?f[n]=0:(f[n]=1,m-=l),m<<=1,e[c-2-n]=(e[c-1-n]/2|0)+b;e[0]=f[0];h[0]=Array(e[0]);k[0]=Array(e[0]);for(n=1;n<c;++n)e[n]>2*e[n-1]+f[n]&&(e[n]=2*e[n-1]+f[n]),
h[n]=Array(e[n]),k[n]=Array(e[n]);for(m=0;m<b;++m)g[m]=c;for(l=0;l<e[c-1];++l)h[c-1][l]=a[l],k[c-1][l]=l;for(m=0;m<c;++m)j[m]=0;1===f[c-1]&&(--g[0],++j[c-1]);for(n=c-2;0<=n;--n){c=m=0;p=j[n+1];for(l=0;l<e[n];l++)c=h[n+1][p]+h[n+1][p+1],c>a[m]?(h[n][l]=c,k[n][l]=b,p+=2):(h[n][l]=a[m],k[n][l]=m,++m);j[n]=0;1===f[n]&&d(n)}return g};
Zlib.RawDeflate.prototype.getCodesFromLengths_=function(a){var b=new (USE_TYPEDARRAY?Uint16Array:Array)(a.length),c=[],d=[],e=0,f,g,h;f=0;for(g=a.length;f<g;f++)c[a[f]]=(c[a[f]]|0)+1;f=1;for(g=Zlib.RawDeflate.MaxCodeLength;f<=g;f++)d[f]=e,e+=c[f]|0,e<<=1;f=0;for(g=a.length;f<g;f++){e=d[a[f]];d[a[f]]+=1;c=b[f]=0;for(h=a[f];c<h;c++)b[f]=b[f]<<1|e&1,e>>>=1}return b};
ZLIB_RAWDEFLATE_EXPORT&&(goog.exportSymbol("Zlib.RawDeflate",Zlib.RawDeflate),goog.exportSymbol("Zlib.RawDeflate.CompressionType",Zlib.RawDeflate.CompressionType),goog.exportSymbol("Zlib.RawDeflate.CompressionType.NONE",Zlib.RawDeflate.CompressionType.NONE),goog.exportSymbol("Zlib.RawDeflate.CompressionType.FIXED",Zlib.RawDeflate.CompressionType.FIXED),goog.exportSymbol("Zlib.RawDeflate.CompressionType.DYNAMIC",Zlib.RawDeflate.CompressionType.DYNAMIC));var ZLIB_GZIP_EXPORT=!1;Zlib.Gzip=function(a,b){this.input=a;this.op=this.ip=0;this.flags={};b&&(b.flags&&(this.flags=b.flags),"string"===typeof b.filename&&(this.filename=b.filename),"string"===typeof b.comment&&(this.comment=b.comment),b.deflateOptions&&(this.deflateOptions=b.deflateOptions));this.deflateOptions||(this.deflateOptions={})};Zlib.Gzip.DefaultBufferSize=32768;
Zlib.Gzip.prototype.compress=function(){var a,b,c,d,e,f=new (USE_TYPEDARRAY?Uint8Array:Array)(Zlib.Gzip.DefaultBufferSize);c=0;var g=this.input,h=this.ip;b=this.filename;var k=this.comment;f[c++]=31;f[c++]=139;f[c++]=8;a=0;this.flags.fname&&(a|=Zlib.Gzip.FlagsMask.FNAME);this.flags.fcomment&&(a|=Zlib.Gzip.FlagsMask.FCOMMENT);this.flags.fhcrc&&(a|=Zlib.Gzip.FlagsMask.FHCRC);f[c++]=a;a=(Date.now?Date.now():+new Date)/1E3|0;f[c++]=a&255;f[c++]=a>>>8&255;f[c++]=a>>>16&255;f[c++]=a>>>24&255;f[c++]=0;f[c++]=
Zlib.Gzip.OperatingSystem.UNKNOWN;if(void 0!==this.flags.fname){d=0;for(e=b.length;d<e;++d)a=b.charCodeAt(d),255<a&&(f[c++]=a>>>8&255),f[c++]=a&255;f[c++]=0}if(this.flags.comment){d=0;for(e=k.length;d<e;++d)a=k.charCodeAt(d),255<a&&(f[c++]=a>>>8&255),f[c++]=a&255;f[c++]=0}this.flags.fhcrc&&(b=Zlib.CRC32.calc(f,0,c)&65535,f[c++]=b&255,f[c++]=b>>>8&255);this.deflateOptions.outputBuffer=f;this.deflateOptions.outputIndex=c;c=new Zlib.RawDeflate(g,this.deflateOptions);f=c.compress();c=c.op;USE_TYPEDARRAY&&
(c+8>f.buffer.byteLength?(this.output=new Uint8Array(c+8),this.output.set(new Uint8Array(f.buffer)),f=this.output):f=new Uint8Array(f.buffer));b=Zlib.CRC32.calc(g);f[c++]=b&255;f[c++]=b>>>8&255;f[c++]=b>>>16&255;f[c++]=b>>>24&255;e=g.length;f[c++]=e&255;f[c++]=e>>>8&255;f[c++]=e>>>16&255;f[c++]=e>>>24&255;this.ip=h;USE_TYPEDARRAY&&c<f.length&&(this.output=f=f.subarray(0,c));return f};
Zlib.Gzip.OperatingSystem={FAT:0,AMIGA:1,VMS:2,UNIX:3,VM_CMS:4,ATARI_TOS:5,HPFS:6,MACINTOSH:7,Z_SYSTEM:8,CP_M:9,TOPS_20:10,NTFS:11,QDOS:12,ACORN_RISCOS:13,UNKNOWN:255};Zlib.Gzip.FlagsMask={FTEXT:1,FHCRC:2,FEXTRA:4,FNAME:8,FCOMMENT:16};ZLIB_GZIP_EXPORT&&(goog.exportSymbol("Zlib.Gzip",Zlib.Gzip),goog.exportSymbol("Zlib.Gzip.prototype.compress",Zlib.Gzip.prototype.compress));Zlib.GunzipMember=function(){};var ZLIB_GUNZIP_EXPORT=!1;Zlib.Gunzip=function(a){this.input=a;this.ip=0;this.member=[]};Zlib.Gunzip.prototype.decompress=function(){for(var a=this.input.length;this.ip<a;)this.decodeMember();return this.concatMember()};
Zlib.Gunzip.prototype.decodeMember=function(){var a=new Zlib.GunzipMember,b,c,d,e,f,g=this.input;c=this.ip;a.id1=g[c++];a.id2=g[c++];if(31!==a.id1||139!==a.id2)throw Error("invalid file signature:",a.id1,a.id2);a.cm=g[c++];switch(a.cm){case 8:break;default:throw Error("unknown compression method: "+a.cm);}a.flg=g[c++];b=g[c++]|g[c++]<<8|g[c++]<<16|g[c++]<<24;a.mtime=new Date(1E3*b);a.xfl=g[c++];a.os=g[c++];0<(a.flg&Zlib.Gzip.FlagsMask.FEXTRA)&&(a.xlen=g[c++]|g[c++]<<8,c=this.decodeSubField(c,a.xlen));
if(0<(a.flg&Zlib.Gzip.FlagsMask.FNAME)){f=[];for(e=0;0<(b=g[c++]);)f[e++]=String.fromCharCode(b);a.name=f.join("")}if(0<(a.flg&Zlib.Gzip.FlagsMask.FCOMMENT)){f=[];for(e=0;0<(b=g[c++]);)f[e++]=String.fromCharCode(b);a.comment=f.join("")}if(0<(a.flg&Zlib.Gzip.FlagsMask.FHCRC)&&(a.crc16=Zlib.CRC32.calc(g,0,c)&65535,a.crc16!==(g[c++]|g[c++]<<8)))throw Error("invalid header crc16");b=g[g.length-4]|g[g.length-3]<<8|g[g.length-2]<<16|g[g.length-1]<<24;g.length-c-4-4<512*b&&(d=b);c=new Zlib.RawInflate(g,
{index:c,bufferSize:d});a.data=d=c.decompress();c=c.ip;a.crc32=b=(g[c++]|g[c++]<<8|g[c++]<<16|g[c++]<<24)>>>0;if(Zlib.CRC32.calc(d)!==b)throw Error("invalid CRC-32 checksum: 0x"+Zlib.CRC32.calc(d).toString(16)+" / 0x"+b.toString(16));a.isize=b=(g[c++]|g[c++]<<8|g[c++]<<16|g[c++]<<24)>>>0;if((d.length&4294967295)!==b)throw Error("invalid input size: "+(d.length&4294967295)+" / "+b);this.member.push(a);this.ip=c};Zlib.Gunzip.prototype.decodeSubField=function(a,b){return a+b};
Zlib.Gunzip.prototype.concatMember=function(){var a=this.member,b,c,d=0,e=0;b=0;for(c=a.length;b<c;++b)e+=a[b].data.length;if(USE_TYPEDARRAY){e=new Uint8Array(e);for(b=0;b<c;++b)e.set(a[b].data,d),d+=a[b].data.length}else{e=[];for(b=0;b<c;++b)e[b]=a[b].data;e=Array.prototype.concat.apply([],e)}return e};ZLIB_GUNZIP_EXPORT&&(goog.exportSymbol("Zlib.Gunzip",Zlib.Gunzip),goog.exportSymbol("Zlib.Gunzip.prototype.decompress",Zlib.Gunzip.prototype.decompress));X.parserMGZ=function(){X.parser.call(this);this._classname="parserMGZ";this._littleEndian=!1};goog.inherits(X.parserMGZ,X.parser);
X.parserMGZ.prototype.parse=function(a,b,c,d){X.TIMER(this._classname+".parse");window.console.log(b);d&&(c=(new Zlib.Gunzip(new Uint8Array(c))).decompress(),c=c.buffer);d=this.parseStream(c);var e=[d.ndim1,d.ndim2,d.ndim3];b._dimensions=e;var f=d.v_voxelsize;b._spacing=f;c=d.min;var g=d.max;b._min=b._windowLow=c;b._max=b._windowHigh=g;-Infinity==b._lowerThreshold&&(b._lowerThreshold=c);Infinity==b._upperThreshold&&(b._upperThreshold=g);c=goog.vec.Mat4.createFloat32();if("false"==b.reslicing||!1==
b.reslicing)goog.vec.Mat4.setRowValues(c,0,b._spacing[0],0,0,0),goog.vec.Mat4.setRowValues(c,1,0,b._spacing[1],0,0),goog.vec.Mat4.setRowValues(c,2,0,0,b._spacing[2],0),goog.vec.Mat4.setRowValues(c,3,0,0,0,1),goog.vec.Mat4.setColumnValues(c,3,0,0,0,1);else{goog.vec.Mat4.setRowValues(c,0,d.M_ras[0][0],d.M_ras[1][0],d.M_ras[2][0],0);goog.vec.Mat4.setRowValues(c,1,d.M_ras[0][1],d.M_ras[1][1],d.M_ras[2][1],0);goog.vec.Mat4.setRowValues(c,2,d.M_ras[0][2],d.M_ras[1][2],d.M_ras[2][2],0);goog.vec.Mat4.setRowValues(c,
3,0,0,0,1);for(var g=e[0]/2,h=e[1]/2,e=e[2]/2,k=[0,0,0],j=0;3>j;++j)k[j]=d.M_ras[3][j]-(goog.vec.Mat4.getElement(c,j,0)*f[0]*g+goog.vec.Mat4.getElement(c,j,1)*f[1]*h+goog.vec.Mat4.getElement(c,j,2)*f[2]*e);goog.vec.Mat4.setColumnValues(c,3,k[0],k[1],k[2],1)}d.IJKToRAS=c;d.RASToIJK=goog.vec.Mat4.createFloat32();goog.vec.Mat4.invert(d.IJKToRAS,d.RASToIJK);g=goog.vec.Vec4.createFloat32FromValues(0,0,0,1);f=goog.vec.Vec4.createFloat32();goog.vec.Mat4.multVec4(c,g,f);h=goog.vec.Vec4.createFloat32FromValues(1,
1,1,1);g=goog.vec.Vec4.createFloat32();goog.vec.Mat4.multVec4(c,h,g);c=X.parser.computeRASBBox(c,b._dimensions);d.RASSpacing=[g[0]-f[0],g[1]-f[1],g[2]-f[2]];d.RASDimensions=[c[1]-c[0]+1,c[3]-c[2]+1,c[5]-c[4]+1];d.RASOrigin=[c[0],c[2],c[4]];b.create_(d);X.TIMERSTOP(this._classname+".parse");b._image=this.reslice(b);d=new X.event.ModifiedEvent;d._object=b;d._container=a;this.dispatchEvent(d)};
X.parserMGZ.prototype.parseStream=function(a){this._data=a;a={version:0,Tr:0,Te:0,flipangle:0,Ti:0,ndim1:0,ndim2:0,ndim3:0,nframes:0,type:0,dof:0,rasgoodflag:0,MRIreader:null,M_ras:null,v_voxelsize:null,data:null,min:Infinity,max:-Infinity};a.version=this.scan("uint");a.ndim1=this.scan("uint");a.ndim2=this.scan("uint");a.ndim3=this.scan("uint");a.nframes=this.scan("uint");a.type=this.scan("uint");a.dof=this.scan("uint");a.rasgoodflag=this.scan("ushort");if(0<a.rasgoodflag){a.v_voxelsize=this.scan("float",
3);var b=[];b.push(this.scan("float",3));b.push(this.scan("float",3));b.push(this.scan("float",3));b.push(this.scan("float",3));a.M_ras=b}this.jumpTo(284);b=a.ndim1*a.ndim2*a.ndim3;switch(a.type){case 0:a.data=this.scan("uchar",b);break;case 1:a.data=this.scan("uint",b);break;case 3:a.data=this.scan("float",b);break;case 4:a.data=this.scan("ushort",b);break;default:throw Error("Unsupported MGH/MGZ data type: "+a.type);}b=this.arrayMinMax(a.data);a.min=b[0];a.max=b[1];this._dataPointer+16<this._data.byteLength&&
(a.Tr=this.scan("float"),a.flipangle=this.scan("float"),a.Te=this.scan("float"),a.Ti=this.scan("float"));return a};goog.exportSymbol("X.parserMGZ",X.parserMGZ);goog.exportSymbol("X.parserMGZ.prototype.parse",X.parserMGZ.prototype.parse);X.parserLBL=function(){X.parser.call(this);this._classname="parserLBL"};goog.inherits(X.parserLBL,X.parser);
X.parserLBL.prototype.parse=function(a,b,c){X.TIMER(this._classname+".parse");var d=b._pointIndices,e=d.length;if(0==e)throw Error("No _pointIndices defined on the X.object.");this._data=c;var f=[],g=this.scan("uchar",c.byteLength),h=g.length,k=!1,j=0;for(c=1;c<h;c++)10==g[c-1]?(j=c,k=!0):k&&32==g[c]&&(k=parseInt(this.parseChars(g,j,c),10),f.push(k),k=!1);g=b._scalars._array?b._scalars._array:new Float32Array(e);h=f.length;for(c=0;c<h;c++)g[f[c]]=1;f=new Float32Array(3*e);for(c=h=0;c<e;c++){j=d[c];
if(j>e)throw Error("Could not find scalar for vertex.");j=g[j];f[h++]=j;f[h++]=j;f[h++]=j}b._scalars._array=g;b._scalars._glArray=f;b._scalars._dirty=!0;X.TIMERSTOP(this._classname+".parse");d=new X.event.ModifiedEvent;d._object=b;d._container=a;this.dispatchEvent(d)};goog.exportSymbol("X.parserLBL",X.parserLBL);goog.exportSymbol("X.parserLBL.prototype.parse",X.parserLBL.prototype.parse);X.parserCRV=function(){X.parser.call(this);this._classname="parserCRV";this._littleEndian=!1};goog.inherits(X.parserCRV,X.parser);
X.parserCRV.prototype.parse=function(a,b,c){X.TIMER(this._classname+".parse");var d=b._pointIndices;if(0==d.length)throw Error("No _pointIndices defined on the X.object.");this._data=c;this.jumpTo(3);var e=this.scan("uint");this.scan("uint");this.scan("uint");var f=0,g=0,h=0,k=0,j=0,m=0,l=0,n=0,p=0,q=0,r=0;c=Array(2);var s=Array(2),z=this.scan("float",e),x;for(x=0;x<e;x++){var t=z[x];0==x&&(c[0]=s[0]=t);0<=t?(f++,k+=t):(g++,h+=t);p+=t;r++;s[0]=Math.max(t,s[0]);c[0]=Math.min(t,c[0]);z[x]=t}0!=f&&(j=
k/f);0!=g&&(m=h/g);0!=r&&(q=p/r);for(x=p=h=k=0;x<e;x++){var t=z[x],u=0;0<=t?(u=Math.pow(t-j,2),k+=u):(u=Math.pow(t-m,2),h+=u);u=Math.pow(t-q,2);p+=u}1<f&&(l=Math.sqrt(k/(f-1)));1<g&&(n=Math.sqrt(h/(g-1)));1<r&&Math.sqrt(p/(r-1));c[1]=m-2.5*n;s[1]=j+2.5*l;e=d.length;f=new Float32Array(3*e);for(x=0;x<e;x++)g=z[d[x]],h=3*x,f[h]=g,f[h+1]=g,f[h+2]=g;b._scalars._min=c[1];b._scalars._max=s[1];-Infinity==b._scalars._lowerThreshold&&(b._scalars._lowerThreshold=c[1]);Infinity==b._scalars._upperThreshold&&(b._scalars._upperThreshold=
s[1]);b._scalars._array=z;b._scalars._glArray=f;b._scalars._dirty=!0;X.TIMERSTOP(this._classname+".parse");d=new X.event.ModifiedEvent;d._object=b;d._container=a;this.dispatchEvent(d)};goog.exportSymbol("X.parserCRV",X.parserCRV);goog.exportSymbol("X.parserCRV.prototype.parse",X.parserCRV.prototype.parse);Zlib.Adler32=function(a){"string"===typeof a&&(a=Zlib.Util.stringToByteArray(a));return Zlib.Adler32.update(1,a)};Zlib.Adler32.update=function(a,b){for(var c=a&65535,d=a>>>16&65535,e=b.length,f,g=0;0<e;){f=e>Zlib.Adler32.OptimizationParameter?Zlib.Adler32.OptimizationParameter:e;e-=f;do c+=b[g++],d+=c;while(--f);c%=65521;d%=65521}return(d<<16|c)>>>0};Zlib.Adler32.OptimizationParameter=1024;var ZLIB_DEFLATE_EXPORT=!1;Zlib.Deflate=function(a,b){this.input=a;this.output=new (USE_TYPEDARRAY?Uint8Array:Array)(Zlib.Deflate.DefaultBufferSize);this.compressionType=Zlib.Deflate.CompressionType.DYNAMIC;var c={},d;if((b||!(b={}))&&"number"===typeof b.compressionType)this.compressionType=b.compressionType;for(d in b)c[d]=b[d];c.outputBuffer=this.output;this.rawDeflate=new Zlib.RawDeflate(this.input,c)};Zlib.Deflate.DefaultBufferSize=32768;Zlib.Deflate.CompressionType=Zlib.RawDeflate.CompressionType;
Zlib.Deflate.compress=function(a,b){return(new Zlib.Deflate(a,b)).compress()};
Zlib.Deflate.prototype.compress=function(){var a,b,c,d=0;c=this.output;a=Zlib.CompressionMethod.DEFLATE;switch(a){case Zlib.CompressionMethod.DEFLATE:b=Math.LOG2E*Math.log(Zlib.RawDeflate.WindowSize)-8;break;default:throw Error("invalid compression method");}b=b<<4|a;c[d++]=b;switch(a){case Zlib.CompressionMethod.DEFLATE:switch(this.compressionType){case Zlib.Deflate.CompressionType.NONE:a=0;break;case Zlib.Deflate.CompressionType.FIXED:a=1;break;case Zlib.Deflate.CompressionType.DYNAMIC:a=2;break;
default:throw Error("unsupported compression type");}break;default:throw Error("invalid compression method");}a=a<<6|0;c[d++]=a|31-(256*b+a)%31;b=Zlib.Adler32(this.input);this.rawDeflate.op=d;c=this.rawDeflate.compress();d=c.length;USE_TYPEDARRAY&&(c=new Uint8Array(c.buffer),c.length<=d+4&&(this.output=new Uint8Array(c.length+4),this.output.set(c),c=this.output),c=c.subarray(0,d+4));c[d++]=b>>24&255;c[d++]=b>>16&255;c[d++]=b>>8&255;c[d++]=b&255;return c};
ZLIB_DEFLATE_EXPORT&&(goog.exportSymbol("Zlib.Deflate",Zlib.Deflate),goog.exportSymbol("Zlib.Deflate.compress",Zlib.Deflate.compress),goog.exportSymbol("Zlib.Deflate.prototype.compress",Zlib.Deflate.prototype.compress),goog.exportSymbol("Zlib.Deflate.CompressionType",Zlib.Deflate.CompressionType),goog.exportSymbol("Zlib.Deflate.CompressionType.NONE",Zlib.Deflate.CompressionType.NONE),goog.exportSymbol("Zlib.Deflate.CompressionType.FIXED",Zlib.Deflate.CompressionType.FIXED),goog.exportSymbol("Zlib.Deflate.CompressionType.DYNAMIC",
Zlib.Deflate.CompressionType.DYNAMIC));Zlib.CompressionMethod={DEFLATE:8,RESERVED:15};Zlib.Util={};Zlib.Util.convertNetworkByteOrder=function(a,b){var c=[],d;do d=a&255,c.push(d),a>>>=8;while(0<a);if("number"===typeof b)for(;c.length<b;)c.push(0);return c.reverse()};Zlib.Util.slice=function(a,b,c){var d,e=a.length;if(a instanceof Array)return a.slice(b,b+c);d=[];for(var f=0;f<c&&!(b+f>=e);f++)d.push(a[b+f]);return d};Zlib.Util.push=function(a,b){var c=0,d=b.length,e=b.length;if(a.push)for(;c<e;c++)a.push(b[c]);else for(;c<e;c++)a[d+c]=b[c];return a.length};
Zlib.Util.stringToByteArray=function(a){a=a.split("");var b,c;b=0;for(c=a.length;b<c;b++)a[b]=(a[b].charCodeAt(0)&255)>>>0;return a};var ZLIB_INFLATE_EXPORT=!1;
Zlib.Inflate=function(a,b){var c,d;this.input=a;this.ip=0;if(b||!(b={}))b.index&&(this.ip=b.index),b.verify&&(this.verify=b.verify);c=a[this.ip++];d=a[this.ip++];switch(c&15){case Zlib.CompressionMethod.DEFLATE:this.method=Zlib.CompressionMethod.DEFLATE;break;default:throw Error("unsupported compression method");}if(0!==((c<<8)+d)%31)throw Error("invalid fcheck flag:"+((c<<8)+d)%31);if(d&32)throw Error("fdict flag is not supported");this.rawinflate=new Zlib.RawInflate(a,{index:this.ip,bufferSize:b.bufferSize,
bufferType:b.bufferType,resize:b.resize})};Zlib.Inflate.BufferType=Zlib.RawInflate.BufferType;Zlib.Inflate.prototype.decompress=function(){var a=this.input,b;b=this.rawinflate.decompress();this.ip=this.rawinflate.ip;if(this.verify&&(a=(a[this.ip++]<<24|a[this.ip++]<<16|a[this.ip++]<<8|a[this.ip++])>>>0,a!==Zlib.Adler32(b)))throw Error("invalid adler-32 checksum");return b};
ZLIB_INFLATE_EXPORT&&(goog.exportSymbol("Zlib.Inflate",Zlib.Inflate),goog.exportSymbol("Zlib.Inflate.BufferType",Zlib.Inflate.BufferType),goog.exportProperty(Zlib.Inflate.BufferType,"ADAPTIVE",Zlib.Inflate.BufferType.ADAPTIVE),goog.exportProperty(Zlib.Inflate.BufferType,"BLOCK",Zlib.Inflate.BufferType.BLOCK),goog.exportSymbol("Zlib.Inflate.prototype.decompress",Zlib.Inflate.prototype.decompress));X.parserRAW=function(){X.parser.call(this);this._classname="parserRAW"};goog.inherits(X.parserRAW,X.parser);
X.parserRAW.prototype.parse=function(a,b,c,d){X.TIMER(this._classname+".parse");d&&(c=(new Zlib.Inflate(new Uint8Array(c))).decompress(),c=c.buffer);d={};d.data=new Uint8Array(c);var e=this.arrayMinMax(d.data);c=e[0];e=e[1];d.min=b._min=b._windowLow=c;d.max=b._max=b._windowHigh=e;-Infinity==b._lowerThreshold&&(b._lowerThreshold=c);Infinity==b._upperThreshold&&(b._upperThreshold=e);e=goog.vec.Mat4.createFloat32Identity();d.IJKToRAS=e;d.RASToIJK=goog.vec.Mat4.createFloat32Identity();var f=goog.vec.Vec4.createFloat32FromValues(0,
0,0,1);c=goog.vec.Vec4.createFloat32();goog.vec.Mat4.multVec4(e,f,c);var g=goog.vec.Vec4.createFloat32FromValues(1,1,1,1),f=goog.vec.Vec4.createFloat32();goog.vec.Mat4.multVec4(e,g,f);e=X.parser.computeRASBBox(e,b._dimensions);d.RASSpacing=[f[0]-c[0],f[1]-c[1],f[2]-c[2]];d.RASDimensions=[e[1]-e[0]+1,e[3]-e[2]+1,e[5]-e[4]+1];d.RASOrigin=[e[0],e[2],e[4]];b.create_(d);X.TIMERSTOP(this._classname+".parse");b._image=this.reslice(b);d=new X.event.ModifiedEvent;d._object=b;d._container=a;this.dispatchEvent(d)};
goog.exportSymbol("X.parserRAW",X.parserRAW);goog.exportSymbol("X.parserRAW.prototype.parse",X.parserRAW.prototype.parse);X.parserLUT=function(){X.parser.call(this);this._classname="parserLUT"};goog.inherits(X.parserLUT,X.parser);
X.parserLUT.prototype.parse=function(a,b,c){X.TIMER(this._classname+".parse");this._data=c;c=this.scan("uchar",c.byteLength);var d=c.length,e=0,f;for(f=0;f<d;f++)if(10==c[f]){var g=this.parseChars(c,e,f),e=f+1,g=g.replace(/^\s+|\s+$/g,"");"#"!=g[0]&&(g=g.split(" "),g=g.filter(function(a){return""!=a}),6==g.length&&(g[2]=parseInt(g[2],10)/255,g[3]=parseInt(g[3],10)/255,g[4]=parseInt(g[4],10)/255,g[5]=parseInt(g[5],10)/255,a.add(parseInt(g[0],10),g[1],g[2],g[3],g[4],g[5],10)))}X.TIMERSTOP(this._classname+
".parse");c=new X.event.ModifiedEvent;c._object=b;c._container=a;this.dispatchEvent(c)};goog.exportSymbol("X.parserLUT",X.parserLUT);goog.exportSymbol("X.parserLUT.prototype.parse",X.parserLUT.prototype.parse);goog.vec.Mat3={};goog.vec.Mat3.createFloat32=function(){return new Float32Array(9)};goog.vec.Mat3.createFloat64=function(){return new Float64Array(9)};goog.vec.Mat3.createNumber=function(){var a=Array(9);goog.vec.Mat3.setFromValues(a,0,0,0,0,0,0,0,0,0);return a};goog.vec.Mat3.create=function(){return goog.vec.Mat3.createFloat32()};goog.vec.Mat3.createFloat32Identity=function(){var a=goog.vec.Mat3.createFloat32();a[0]=a[4]=a[8]=1;return a};
goog.vec.Mat3.createFloat64Identity=function(){var a=goog.vec.Mat3.createFloat64();a[0]=a[4]=a[8]=1;return a};goog.vec.Mat3.createNumberIdentity=function(){var a=Array(9);goog.vec.Mat3.setFromValues(a,1,0,0,0,1,0,0,0,1);return a};goog.vec.Mat3.createIdentity=function(){return goog.vec.Mat3.createFloat32Identity()};goog.vec.Mat3.createFloat32FromArray=function(a){var b=goog.vec.Mat3.createFloat32();goog.vec.Mat3.setFromArray(b,a);return b};
goog.vec.Mat3.createFloat32FromValues=function(a,b,c,d,e,f,g,h,k){var j=goog.vec.Mat3.createFloat32();goog.vec.Mat3.setFromValues(j,a,b,c,d,e,f,g,h,k);return j};goog.vec.Mat3.cloneFloat32=goog.vec.Mat3.createFloat32FromArray;goog.vec.Mat3.createFloat64FromArray=function(a){var b=goog.vec.Mat3.createFloat64();goog.vec.Mat3.setFromArray(b,a);return b};
goog.vec.Mat3.createFloat64FromValues=function(a,b,c,d,e,f,g,h,k){var j=goog.vec.Mat3.createFloat64();goog.vec.Mat3.setFromValues(j,a,b,c,d,e,f,g,h,k);return j};goog.vec.Mat3.cloneFloat64=goog.vec.Mat3.createFloat64FromArray;goog.vec.Mat3.createFromArray=function(a){var b=goog.vec.Mat3.createFloat32();goog.vec.Mat3.setFromArray(b,a);return b};goog.vec.Mat3.createFromValues=function(a,b,c,d,e,f,g,h,k){var j=goog.vec.Mat3.create();goog.vec.Mat3.setFromValues(j,a,b,c,d,e,f,g,h,k);return j};
goog.vec.Mat3.clone=goog.vec.Mat3.createFromArray;goog.vec.Mat3.getElement=function(a,b,c){return a[b+3*c]};goog.vec.Mat3.setElement=function(a,b,c,d){a[b+3*c]=d;return a};goog.vec.Mat3.setFromValues=function(a,b,c,d,e,f,g,h,k,j){a[0]=b;a[1]=c;a[2]=d;a[3]=e;a[4]=f;a[5]=g;a[6]=h;a[7]=k;a[8]=j;return a};goog.vec.Mat3.setFromArray=function(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];a[6]=b[6];a[7]=b[7];a[8]=b[8];return a};
goog.vec.Mat3.setFromRowMajorArray=function(a,b){a[0]=b[0];a[1]=b[3];a[2]=b[6];a[3]=b[1];a[4]=b[4];a[5]=b[7];a[6]=b[2];a[7]=b[5];a[8]=b[8];return a};goog.vec.Mat3.setDiagonalValues=function(a,b,c,d){a[0]=b;a[4]=c;a[8]=d;return a};goog.vec.Mat3.setDiagonal=function(a,b){a[0]=b[0];a[4]=b[1];a[8]=b[2];return a};goog.vec.Mat3.setColumnValues=function(a,b,c,d,e){b*=3;a[b]=c;a[b+1]=d;a[b+2]=e;return a};goog.vec.Mat3.setColumn=function(a,b,c){b*=3;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];return a};
goog.vec.Mat3.getColumn=function(a,b,c){b*=3;c[0]=a[b];c[1]=a[b+1];c[2]=a[b+2];return c};goog.vec.Mat3.setColumns=function(a,b,c,d){goog.vec.Mat3.setColumn(a,0,b);goog.vec.Mat3.setColumn(a,1,c);goog.vec.Mat3.setColumn(a,2,d);return a};goog.vec.Mat3.getColumns=function(a,b,c,d){goog.vec.Mat3.getColumn(a,0,b);goog.vec.Mat3.getColumn(a,1,c);goog.vec.Mat3.getColumn(a,2,d)};goog.vec.Mat3.setRowValues=function(a,b,c,d,e){a[b]=c;a[b+3]=d;a[b+6]=e;return a};
goog.vec.Mat3.setRow=function(a,b,c){a[b]=c[0];a[b+3]=c[1];a[b+6]=c[2];return a};goog.vec.Mat3.getRow=function(a,b,c){c[0]=a[b];c[1]=a[b+3];c[2]=a[b+6];return c};goog.vec.Mat3.setRows=function(a,b,c,d){goog.vec.Mat3.setRow(a,0,b);goog.vec.Mat3.setRow(a,1,c);goog.vec.Mat3.setRow(a,2,d);return a};goog.vec.Mat3.getRows=function(a,b,c,d){goog.vec.Mat3.getRow(a,0,b);goog.vec.Mat3.getRow(a,1,c);goog.vec.Mat3.getRow(a,2,d)};
goog.vec.Mat3.makeZero=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=0;a[6]=0;a[7]=0;a[8]=0;return a};goog.vec.Mat3.makeIdentity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};goog.vec.Mat3.addMat=function(a,b,c){c[0]=a[0]+b[0];c[1]=a[1]+b[1];c[2]=a[2]+b[2];c[3]=a[3]+b[3];c[4]=a[4]+b[4];c[5]=a[5]+b[5];c[6]=a[6]+b[6];c[7]=a[7]+b[7];c[8]=a[8]+b[8];return c};
goog.vec.Mat3.subMat=function(a,b,c){c[0]=a[0]-b[0];c[1]=a[1]-b[1];c[2]=a[2]-b[2];c[3]=a[3]-b[3];c[4]=a[4]-b[4];c[5]=a[5]-b[5];c[6]=a[6]-b[6];c[7]=a[7]-b[7];c[8]=a[8]-b[8];return c};goog.vec.Mat3.multScalar=function(a,b,c){c[0]=a[0]*b;c[1]=a[1]*b;c[2]=a[2]*b;c[3]=a[3]*b;c[4]=a[4]*b;c[5]=a[5]*b;c[6]=a[6]*b;c[7]=a[7]*b;c[8]=a[8]*b;return c};
goog.vec.Mat3.multMat=function(a,b,c){var d=a[0],e=a[1],f=a[2],g=a[3],h=a[4],k=a[5],j=a[6],m=a[7];a=a[8];var l=b[0],n=b[1],p=b[2],q=b[3],r=b[4],s=b[5],z=b[6],x=b[7];b=b[8];c[0]=d*l+g*n+j*p;c[1]=e*l+h*n+m*p;c[2]=f*l+k*n+a*p;c[3]=d*q+g*r+j*s;c[4]=e*q+h*r+m*s;c[5]=f*q+k*r+a*s;c[6]=d*z+g*x+j*b;c[7]=e*z+h*x+m*b;c[8]=f*z+k*x+a*b;return c};
goog.vec.Mat3.transpose=function(a,b){if(b==a){var c=a[1],d=a[2],e=a[5];b[1]=a[3];b[2]=a[6];b[3]=c;b[5]=a[7];b[6]=d;b[7]=e}else b[0]=a[0],b[1]=a[3],b[2]=a[6],b[3]=a[1],b[4]=a[4],b[5]=a[7],b[6]=a[2],b[7]=a[5],b[8]=a[8];return b};
goog.vec.Mat3.invert=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],k=a[6],j=a[7],m=a[8],l=g*m-j*h,n=j*e-d*m,p=d*h-g*e,q=c*l+f*n+k*p;if(0==q)return!1;q=1/q;b[0]=l*q;b[3]=(k*h-f*m)*q;b[6]=(f*j-k*g)*q;b[1]=n*q;b[4]=(c*m-k*e)*q;b[7]=(k*d-c*j)*q;b[2]=p*q;b[5]=(f*e-c*h)*q;b[8]=(c*g-f*d)*q;return!0};goog.vec.Mat3.equals=function(a,b){return a.length==b.length&&a[0]==b[0]&&a[1]==b[1]&&a[2]==b[2]&&a[3]==b[3]&&a[4]==b[4]&&a[5]==b[5]&&a[6]==b[6]&&a[7]==b[7]&&a[8]==b[8]};
goog.vec.Mat3.multVec3=function(a,b,c){var d=b[0],e=b[1];b=b[2];c[0]=d*a[0]+e*a[3]+b*a[6];c[1]=d*a[1]+e*a[4]+b*a[7];c[2]=d*a[2]+e*a[5]+b*a[8];return c};goog.vec.Mat3.makeTranslate=function(a,b,c){goog.vec.Mat3.makeIdentity(a);return goog.vec.Mat3.setColumnValues(a,2,b,c,1)};goog.vec.Mat3.makeScale=function(a,b,c,d){goog.vec.Mat3.makeIdentity(a);return goog.vec.Mat3.setDiagonalValues(a,b,c,d)};
goog.vec.Mat3.makeRotate=function(a,b,c,d,e){var f=Math.cos(b),g=1-f;b=Math.sin(b);return goog.vec.Mat3.setFromValues(a,c*c*g+f,c*d*g+e*b,c*e*g-d*b,c*d*g-e*b,d*d*g+f,d*e*g+c*b,c*e*g+d*b,d*e*g-c*b,e*e*g+f)};goog.vec.Mat3.makeRotateX=function(a,b){var c=Math.cos(b),d=Math.sin(b);return goog.vec.Mat3.setFromValues(a,1,0,0,0,c,d,0,-d,c)};goog.vec.Mat3.makeRotateY=function(a,b){var c=Math.cos(b),d=Math.sin(b);return goog.vec.Mat3.setFromValues(a,c,0,-d,0,1,0,d,0,c)};
goog.vec.Mat3.makeRotateZ=function(a,b){var c=Math.cos(b),d=Math.sin(b);return goog.vec.Mat3.setFromValues(a,c,d,0,-d,c,0,0,0,1)};
goog.vec.Mat3.rotate=function(a,b,c,d,e){var f=a[0],g=a[1],h=a[2],k=a[3],j=a[4],m=a[5],l=a[6],n=a[7],p=a[8],q=Math.cos(b),r=Math.sin(b),s=1-q;b=c*c*s+q;var z=c*d*s+e*r,x=c*e*s-d*r,t=c*d*s-e*r,u=d*d*s+q,v=d*e*s+c*r,y=c*e*s+d*r;c=d*e*s-c*r;e=e*e*s+q;return goog.vec.Mat3.setFromValues(a,f*b+k*z+l*x,g*b+j*z+n*x,h*b+m*z+p*x,f*t+k*u+l*v,g*t+j*u+n*v,h*t+m*u+p*v,f*y+k*c+l*e,g*y+j*c+n*e,h*y+m*c+p*e)};
goog.vec.Mat3.rotateX=function(a,b){var c=a[3],d=a[4],e=a[5],f=a[6],g=a[7],h=a[8],k=Math.cos(b),j=Math.sin(b);a[3]=c*k+f*j;a[4]=d*k+g*j;a[5]=e*k+h*j;a[6]=c*-j+f*k;a[7]=d*-j+g*k;a[8]=e*-j+h*k;return a};goog.vec.Mat3.rotateY=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[6],g=a[7],h=a[8],k=Math.cos(b),j=Math.sin(b);a[0]=c*k+f*-j;a[1]=d*k+g*-j;a[2]=e*k+h*-j;a[6]=c*j+f*k;a[7]=d*j+g*k;a[8]=e*j+h*k;return a};
goog.vec.Mat3.rotateZ=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],k=Math.cos(b),j=Math.sin(b);a[0]=c*k+f*j;a[1]=d*k+g*j;a[2]=e*k+h*j;a[3]=c*-j+f*k;a[4]=d*-j+g*k;a[5]=e*-j+h*k;return a};goog.vec.Mat3.makeEulerZXZ=function(a,b,c,d){var e=Math.cos(b);b=Math.sin(b);var f=Math.cos(c);c=Math.sin(c);var g=Math.cos(d);d=Math.sin(d);a[0]=e*g-f*b*d;a[1]=f*e*d+g*b;a[2]=d*c;a[3]=-e*d-g*f*b;a[4]=e*f*g-b*d;a[5]=g*c;a[6]=c*b;a[7]=-e*c;a[8]=f;return a};
goog.vec.Mat3.toEulerZXZ=function(a,b,c){var d=Math.sqrt(a[2]*a[2]+a[5]*a[5]);c=c?-1:1;d>goog.vec.EPSILON?(b[2]=Math.atan2(a[2]*c,a[5]*c),b[1]=Math.atan2(d*c,a[8]),b[0]=Math.atan2(a[6]*c,-a[7]*c)):(b[0]=0,b[1]=Math.atan2(d*c,a[8]),b[2]=Math.atan2(a[1],a[0]));b[0]=(b[0]+2*Math.PI)%(2*Math.PI);b[2]=(b[2]+2*Math.PI)%(2*Math.PI);b[1]=(b[1]*c+2*Math.PI)%(2*Math.PI)*c;return b};X.parserMRC=function(){X.parser.call(this);this._classname="parserMRC"};goog.inherits(X.parserMRC,X.parser);
X.parserMRC.prototype.parse=function(a,b,c){X.TIMER(this._classname+".parse");c=this.parseStream(c);var d=c.min,e=c.max;b._dimensions=[c.nx,c.ny,c.nz];b._spacing=[c.xlen/c.mx,c.ylen/c.my,c.zlen/c.mz];b._min=b._windowLow=d;b._max=b._windowHigh=e;-Infinity==b._lowerThreshold&&(b._lowerThreshold=d);Infinity==b._upperThreshold&&(b._upperThreshold=e);e=goog.vec.Mat4.createFloat32();goog.vec.Mat4.setRowValues(e,3,0,0,0,1);goog.vec.Mat4.setRowValues(e,0,-1,0,0,c.nx);goog.vec.Mat4.setRowValues(e,1,0,0,-1,
c.ny);goog.vec.Mat4.setRowValues(e,2,0,-1,0,c.nz);c.IJKToRAS=e;c.RASToIJK=goog.vec.Mat4.createFloat32();goog.vec.Mat4.invert(c.IJKToRAS,c.RASToIJK);var f=goog.vec.Vec4.createFloat32FromValues(0,0,0,1),d=goog.vec.Vec4.createFloat32();goog.vec.Mat4.multVec4(e,f,d);var g=goog.vec.Vec4.createFloat32FromValues(1,1,1,1),f=goog.vec.Vec4.createFloat32();goog.vec.Mat4.multVec4(e,g,f);g=[c.nx,c.ny,c.nz];e=X.parser.computeRASBBox(e,g);c.RASSpacing=[f[0]-d[0],f[1]-d[1],f[2]-d[2]];c.RASDimensions=[e[1]+e[0]+1,
e[3]-e[2]+1,e[5]-e[4]+1];c.RASOrigin=[e[0],e[2],e[4]];b._dimensions=g;b.create_(c);b._image=this.reslice(b);X.TIMERSTOP(this._classname+".parse");c=new X.event.ModifiedEvent;c._object=b;c._container=a;this.dispatchEvent(c)};
X.parserMRC.prototype.parseStream=function(a){this._data=a;a={nx:0,ny:0,nz:0,mode:0,nxstart:0,nystart:0,nzstart:0,mx:0,my:0,mz:0,xlen:0,ylen:0,zlen:0,alpha:0,beta:0,gamma:0,mapc:0,mapr:0,maps:0,amin:0,amax:0,amean:0,ispg:0,next:0,creatid:0,extra:null,nint:0,nreal:0,extra:null,imodStamp:0,imodFlags:0,idtype:0,lens:0,nd1:0,nd2:0,vd1:0,vd2:0,tiltangles:null,xorg:0,yorg:0,zorg:0,cmap:0,stamp:0,rms:0,nlabl:0,data:null,min:Infinity,max:-Infinity,mean:0,space:null,spaceorientation:null,rasspaceorientation:null,
orientation:null,normcosine:null};this.jumpTo(0);a.nx=this.scan("sint");a.ny=this.scan("sint");a.nz=this.scan("sint");a.mode=this.scan("sint");var b=a.nx*a.ny*a.nz;this.jumpTo(1024);switch(a.mode){case 0:a.data=this.scan("schar",b);break;case 1:a.data=this.scan("sshort",b);break;case 2:a.data=this.scan("float",b);break;case 3:a.data=this.scan("uint",b);break;case 4:a.data=this.scan("double",b);break;case 6:a.data=this.scan("ushort",b);break;case 16:a.data=this.scan("uchar",b);break;default:throw Error("Unsupported MRC data type: "+
a.mode);}this.jumpTo(28);a.mx=this.scan("sint");a.my=this.scan("sint");a.mz=this.scan("sint");a.xlen=this.scan("float");a.ylen=this.scan("float");a.zlen=this.scan("float");a.alpha=this.scan("float");a.beta=this.scan("float");a.gamma=this.scan("float");a.mapc=this.scan("sint");a.mapr=this.scan("sint");a.maps=this.scan("sint");a.amin=this.scan("float");a.amax=this.scan("float");a.amean=this.scan("float");a.ispeg=this.scan("sint");a.next=this.scan("sint");a.creatid=this.scan("short");a.nint=this.scan("short");
a.nreal=this.scan("short");a.imodStamp=this.scan("sint");a.imodFLags=this.scan("sint");a.idtype=this.scan("short");a.lens=this.scan("short");a.nd1=this.scan("short");a.nd2=this.scan("short");a.vd1=this.scan("short");a.vd2=this.scan("short");a.tiltangles=this.scan("float",6);this.jumpTo(196);a.xorg=this.scan("float");a.yorg=this.scan("float");a.zorg=this.scan("float");this.jumpTo(216);a.rms=this.scan("float");a.nlabl=this.scan("sint");a.lables=this.scan("schar",10);if(0!=a.next)switch(this.jumpTo(parseInt(a.next+
1024,10)),a.mode){case 0:a.data=this.scan("schar",b);break;case 1:a.data=this.scan("sshort",b);break;case 2:a.data=this.scan("float",b);break;case 3:a.data=this.scan("uint",b);break;case 4:a.data=this.scan("double",b);break;case 6:a.data=this.scan("ushort",b);break;case 16:a.data=this.scan("uchar",b);break;default:throw Error("Unsupported MRC data type: "+a.mode);}0>a.amean-(a.amax-a.amean)?(a.min=a.amin,a.max=a.amean+(a.amean-a.amin)):(a.min=a.amean-(a.amax-a.amean),a.max=a.amax);return a};
goog.exportSymbol("X.parserMRC",X.parserMRC);goog.exportSymbol("X.parserMRC.prototype.parse",X.parserMRC.prototype.parse);X.parserNRRD=function(){X.parser.call(this);this._classname="parserNRRD"};goog.inherits(X.parserNRRD,X.parser);
X.parserNRRD.prototype.parse=function(a,b,c){X.TIMER(this._classname+".parse");this._data=c;c=this.scan("uchar",c.byteLength);var d=c.length,e=null,f=0,g;for(g=1;g<d;g++)if(10==c[g-1]&&10==c[g]){e=this.parseChars(c,0,g-2);f=g+1;break}this.parseHeader(e);d=c.subarray(f);if("gzip"==this.encoding||"gz"==this.encoding)d=(new Zlib.Gunzip(new Uint8Array(d))).decompress();d=d.buffer;c={data:null,min:Infinity,max:-Infinity};c.data=new this.__array(d);e=this.arrayMinMax(c.data);d=c.min=e[0];e=c.max=e[1];b._min=
b._windowLow=d;b._max=b._windowHigh=e;b._dimensions=[this.sizes[0],this.sizes[1],this.sizes[2]];f=(new goog.math.Vec3(this.vectors[0][0],this.vectors[0][1],this.vectors[0][2])).magnitude();g=(new goog.math.Vec3(this.vectors[1][0],this.vectors[1][1],this.vectors[1][2])).magnitude();var h=(new goog.math.Vec3(this.vectors[2][0],this.vectors[2][1],this.vectors[2][2])).magnitude();b._spacing=[f,g,h];-Infinity==b._lowerThreshold&&(b._lowerThreshold=d);Infinity==b._upperThreshold&&(b._upperThreshold=e);
f=e=1;"left-posterior-superior"==this.space&&(f=e=-1);d=goog.vec.Mat4.createFloat32Identity();"false"==b.reslicing||!1==b.reslicing?(goog.vec.Mat4.setRowValues(d,0,e,0,0,0),goog.vec.Mat4.setRowValues(d,1,0,f,0,0),goog.vec.Mat4.setRowValues(d,2,0,0,1,0)):(goog.vec.Mat4.setRowValues(d,0,e*this.vectors[0][0],e*this.vectors[1][0],e*this.vectors[2][0],e*this.space_origin[0]),goog.vec.Mat4.setRowValues(d,1,f*this.vectors[0][1],f*this.vectors[1][1],f*this.vectors[2][1],f*this.space_origin[1]),goog.vec.Mat4.setRowValues(d,
2,1*this.vectors[0][2],1*this.vectors[1][2],1*this.vectors[2][2],1*this.space_origin[2]));goog.vec.Mat4.setRowValues(d,3,0,0,0,1);c.IJKToRAS=d;c.RASToIJK=goog.vec.Mat4.createFloat32();goog.vec.Mat4.invert(c.IJKToRAS,c.RASToIJK);f=goog.vec.Vec4.createFloat32FromValues(0,0,0,1);e=goog.vec.Vec4.createFloat32();goog.vec.Mat4.multVec4(d,f,e);g=goog.vec.Vec4.createFloat32FromValues(1,1,1,1);f=goog.vec.Vec4.createFloat32();goog.vec.Mat4.multVec4(d,g,f);d=X.parser.computeRASBBox(d,b._dimensions);c.RASSpacing=
[f[0]-e[0],f[1]-e[1],f[2]-e[2]];c.RASDimensions=[d[1]-d[0]+1,d[3]-d[2]+1,d[5]-d[4]+1];c.RASOrigin=[d[0],d[2],d[4]];b.create_(c);X.TIMERSTOP(this._classname+".parse");b._image=this.reslice(b);c=new X.event.ModifiedEvent;c._object=b;c._container=a;this.dispatchEvent(c)};
X.parserNRRD.prototype.parseHeader=function(a){var b,c,d,e,f,g;a=a.split(/\r?\n/);f=0;for(g=a.length;f<g;f++)if(b=a[f],b.match(/NRRD\d+/))this.isNrrd=!0;else if(!b.match(/^#/)&&(e=b.match(/(.*):(.*)/)))c=e[1].trim(),b=e[2].trim(),(d=this.fieldFunctions[c])?d.call(this,b):this[c]=b;if(!this.isNrrd)throw Error("Not an NRRD file");if("raw"!==this.encoding&&"gzip"!==this.encoding&&"gz"!==this.encoding)throw Error("Only raw or gz/gzip encoding is allowed");if(!this.vectors&&(this.vectors=[new goog.math.Vec3(1,
0,0),new goog.math.Vec3(0,1,0),new goog.math.Vec3(0,0,1)],this.spacings)){a=[];for(e=0;2>=e;e++)a.push(!isNaN(this.spacings[e])?this.vectors[e].scale(this.spacings[e]):void 0);return a}};
X.parserNRRD.prototype.fieldFunctions={type:function(a){switch(a){case "uchar":case "unsigned char":case "uint8":case "uint8_t":this.__array=Uint8Array;break;case "signed char":case "int8":case "int8_t":this.__array=Int8Array;break;case "short":case "short int":case "signed short":case "signed short int":case "int16":case "int16_t":this.__array=Int16Array;break;case "ushort":case "unsigned short":case "unsigned short int":case "uint16":case "uint16_t":this.__array=Uint16Array;break;case "int":case "signed int":case "int32":case "int32_t":this.__array=
Int32Array;break;case "uint":case "unsigned int":case "uint32":case "uint32_t":this.__array=Uint32Array;break;case "float":this.__array=Float32Array;break;case "double":this.__array=Float64Array;break;default:throw Error("Unsupported NRRD data type: "+a);}return this.type=a},endian:function(a){return this.endian=a},encoding:function(a){return this.encoding=a},dimension:function(a){return this.dim=parseInt(a,10)},sizes:function(a){var b,c,d,e;d=a.split(/\s+/);e=[];b=0;for(c=d.length;b<c;b++)a=d[b],
e.push(parseInt(a,10));return this.sizes=e},space:function(a){return this.space=a},"space origin":function(a){return this.space_origin=a.split("(")[1].split(")")[0].split(",")},"space directions":function(a){var b,c;a=a.match(/\(.*?\)/g);var d,e,f;f=[];d=0;for(e=a.length;d<e;d++)c=a[d],f.push(function(){var a,d,e,f;e=c.slice(1,-1).split(/,/);f=[];a=0;for(d=e.length;a<d;a++)b=e[a],f.push(parseFloat(b));return f}());return this.vectors=f},spacings:function(a){var b;b=a.split(/\s+/);var c,d,e;e=[];c=
0;for(d=b.length;c<d;c++)a=b[c],e.push(parseFloat(a));return this.spacings=e}};goog.exportSymbol("X.parserNRRD",X.parserNRRD);goog.exportSymbol("X.parserNRRD.prototype.parse",X.parserNRRD.prototype.parse);X.parserSTL=function(){X.parser.call(this);this._classname="parserSTL"};goog.inherits(X.parserSTL,X.parser);
X.parserSTL.prototype.parse=function(a,b,c){X.TIMER(this._classname+".parse");this._data=c;var d=b._points,e=b._normals;"solid"==this.parseChars(this.scan("uchar",5))?(b._points=d=new X.triplets(c.byteLength),b._normals=e=new X.triplets(c.byteLength),this.parseASCII(d,e,this.scan("uchar",c.byteLength-5))):(this.jumpTo(80),c=this.scan("uint"),b._points=d=new X.triplets(9*c),b._normals=e=new X.triplets(9*c),this.parseBIN(d,e,c));X.TIMERSTOP(this._classname+".parse");d=new X.event.ModifiedEvent;d._object=
b;d._container=a;this.dispatchEvent(d)};X.parserSTL.prototype.parseASCII=function(a,b,c){var d=c.length,e=!1,f=!1,g=0,h;for(h=0;h<d;h++)if(10==c[h]){if(e||f){var k=this.parseChars(c,g,h).split(" "),f=parseFloat(k[0]),j=parseFloat(k[1]),k=parseFloat(k[2]);e?(b.add(f,j,k),b.add(f,j,k),b.add(f,j,k)):a.add(f,j,k);f=e=!1}}else 32==c[h-1]&&(102==c[h]?(g=h+=13,e=!0):118==c[h]&&(g=h+=7,f=!0))};
X.parserSTL.prototype.parseBIN=function(a,b,c){for(var d=0,d=0;d<c;d++){var e=this.scan("float",12),f=e[0],g=e[1],h=e[2];b.add(f,g,h);b.add(f,g,h);b.add(f,g,h);a.add(e[3],e[4],e[5]);a.add(e[6],e[7],e[8]);a.add(e[9],e[10],e[11]);this._dataPointer+=2}};goog.exportSymbol("X.parserSTL",X.parserSTL);goog.exportSymbol("X.parserSTL.prototype.parse",X.parserSTL.prototype.parse);X.parserNII=function(){X.parser.call(this);this._classname="parserNII"};goog.inherits(X.parserNII,X.parser);
X.parserNII.prototype.parse=function(a,b,c){if(!this.verifyNII(c))try{c=(new Zlib.Gunzip(new Uint8Array(c))).decompress().buffer,this.verifyNII(c)||(this._littleEndian=!1)}catch(d){this._littleEndian=!1}c=this.parseStream(c);var e=c.min,f=c.max;b._min=b._windowLow=e;b._max=b._windowHigh=f;-Infinity==b._lowerThreshold&&(b._lowerThreshold=e);Infinity==b._upperThreshold&&(b._upperThreshold=f);e=goog.vec.Mat4.createFloat32();goog.vec.Mat4.setRowValues(e,3,0,0,0,1);if("false"==b.reslicing||!1==b.reslicing){var g=
f=1,h=1;0<c.pixdim[1]&&(f=c.pixdim[1]);0<c.pixdim[2]&&(g=c.pixdim[2]);0<c.pixdim[2]&&(h=c.pixdim[3]);0>c.pixdim[0]&&(h=-h);goog.vec.Mat4.setRowValues(e,0,f,0,0,0);goog.vec.Mat4.setRowValues(e,1,0,g,0,0);goog.vec.Mat4.setRowValues(e,2,0,0,h,0)}else if(0<c.qform_code){var k=0,j=c.quatern_b,m=c.quatern_c,l=c.quatern_d,h=g=f=1,n=c.qoffset_x,p=c.qoffset_y,q=c.qoffset_z,k=1-(j*j+m*m+l*l);1E-7>k?(k=1/Math.sqrt(j*j+m*m+l*l),j*=k,m*=k,l*=k,k=0):k=Math.sqrt(k);0<c.pixdim[1]&&(f=c.pixdim[1]);0<c.pixdim[2]&&
(g=c.pixdim[2]);0<c.pixdim[2]&&(h=c.pixdim[3]);0>c.pixdim[0]&&(h=-h);goog.vec.Mat4.setRowValues(e,0,(k*k+j*j-m*m-l*l)*f,2*(j*m-k*l)*g,2*(j*l+k*m)*h,n);goog.vec.Mat4.setRowValues(e,1,2*(j*m+k*l)*f,(k*k+m*m-j*j-l*l)*g,2*(m*l-k*j)*h,p);goog.vec.Mat4.setRowValues(e,2,2*(j*l-k*m)*f,2*(m*l+k*j)*g,(k*k+l*l-m*m-j*j)*h,q)}else 0<c.sform_code?(f=c.srow_x,g=c.srow_y,h=c.srow_z,goog.vec.Mat4.setRowValues(e,0,f[0],f[1],f[2],f[3]),goog.vec.Mat4.setRowValues(e,1,g[0],g[1],g[2],g[3]),goog.vec.Mat4.setRowValues(e,
2,h[0],h[1],h[2],h[3])):0==c.qform_code?(goog.vec.Mat4.setRowValues(e,0,c.pixdim[1],0,0,0),goog.vec.Mat4.setRowValues(e,1,0,c.pixdim[2],0,0),goog.vec.Mat4.setRowValues(e,2,0,0,c.pixdim[3],0)):window.console.log("UNKNOWN METHOD IN PARSER NII");c.IJKToRAS=e;c.RASToIJK=goog.vec.Mat4.createFloat32();goog.vec.Mat4.invert(c.IJKToRAS,c.RASToIJK);g=goog.vec.Vec4.createFloat32FromValues(0,0,0,1);f=goog.vec.Vec4.createFloat32();goog.vec.Mat4.multVec4(e,g,f);h=goog.vec.Vec4.createFloat32FromValues(1,1,1,1);
g=goog.vec.Vec4.createFloat32();goog.vec.Mat4.multVec4(e,h,g);h=[c.dim[1],c.dim[2],c.dim[3]];e=X.parser.computeRASBBox(e,h);c.RASSpacing=[g[0]-f[0],g[1]-f[1],g[2]-f[2]];c.RASDimensions=[e[1]-e[0]+1,e[3]-e[2]+1,e[5]-e[4]+1];c.RASOrigin=[e[0],e[2],e[4]];b._dimensions=h;b.create_(c);b._image=this.reslice(b);c=new X.event.ModifiedEvent;c._object=b;c._container=a;this.dispatchEvent(c)};
X.parserNII.prototype.parseStream=function(a){this._data=a;a={sizeof_hdr:0,data_type:null,db_name:null,extents:0,session_error:0,regular:0,dim_info:null,dim:null,intent_p1:0,intent_p2:0,intent_p3:0,intent_code:0,datatype:0,bitpix:0,slice_start:0,pixdim:null,vox_offset:0,scl_slope:0,scl_inter:0,slice_end:0,slice_code:null,xyzt_units:null,cal_max:0,cal_min:0,slice_duration:0,toffset:0,glmax:0,glmin:0,descrip:null,aux_file:null,qform_code:0,sform_code:0,quatern_b:0,quatern_c:0,quatern_d:0,qoffset_x:0,
qoffset_y:0,qoffset_z:0,srow_x:null,srow_y:null,srow_z:null,intent_name:null,magic:null,data:null,min:Infinity,max:-Infinity};a.sizeof_hdr=this.scan("uint");a.data_type=this.scan("uchar",10);a.db_name=this.scan("uchar",18);a.extents=this.scan("uint");a.session_error=this.scan("ushort");a.regular=this.scan("uchar");a.dim_info=this.scan("uchar");a.dim=this.scan("ushort",8);a.intent_p1=this.scan("float");a.intent_p2=this.scan("float");a.intent_p3=this.scan("float");a.intent_code=this.scan("ushort");
a.datatype=this.scan("ushort");a.bitpix=this.scan("ushort");a.slice_start=this.scan("ushort");a.pixdim=this.scan("float",8);a.vox_offset=this.scan("float");a.scl_slope=this.scan("float");a.scl_inter=this.scan("float");a.slice_end=this.scan("ushort");a.slice_code=this.scan("uchar");a.xyzt_units=this.scan("uchar");a.cal_max=this.scan("float");a.cal_min=this.scan("float");a.slice_duration=this.scan("float");a.toffset=this.scan("float");a.glmax=this.scan("uint",1);a.glmin=this.scan("uint",1);a.descrip=
this.scan("uchar",80);a.aux_file=this.scan("uchar",24);a.qform_code=this.scan("ushort");a.sform_code=this.scan("ushort");a.quatern_b=this.scan("float");a.quatern_c=this.scan("float");a.quatern_d=this.scan("float");a.qoffset_x=this.scan("float");a.qoffset_y=this.scan("float");a.qoffset_z=this.scan("float");a.srow_x=this.scan("float",4);a.srow_y=this.scan("float",4);a.srow_z=this.scan("float",4);a.intent_name=this.scan("uchar",16);a.magic=this.scan("uchar",4);this.jumpTo(parseInt(a.vox_offset,10));
var b=a.dim[1]*a.dim[2]*a.dim[3];switch(a.datatype){case 2:a.data=this.scan("uchar",b);break;case 4:a.data=this.scan("sshort",b);break;case 8:a.data=this.scan("sint",b);break;case 16:a.data=this.scan("float",b);break;case 32:a.data=this.scan("complex",b);break;case 64:a.data=this.scan("double",b);break;case 256:a.data=this.scan("schar",b);break;case 512:a.data=this.scan("ushort",b);break;case 768:a.data=this.scan("uint",b);break;default:throw Error("Unsupported NII data type: "+a.datatype);}b=this.arrayMinMax(a.data);
a.min=b[0];a.max=b[1];return a};X.parserNII.prototype.verifyNII=function(a){var b=-1,b="undefined"==typeof DataView?(new Int32Array(a,0,1))[0]:(new DataView(a,0)).getInt32(0,!0);return 348==b?!0:!1};goog.exportSymbol("X.parserNII",X.parserNII);goog.exportSymbol("X.parserNII.prototype.parse",X.parserNII.prototype.parse);X.parserTRK=function(){X.parser.call(this);this._classname="parserTRK"};goog.inherits(X.parserTRK,X.parser);
X.parserTRK.prototype.parse=function(a,b,c){X.TIMER(this._classname+".parse");var d=b._points,e=b._normals,f=b._colors;this._data=c;this.scan("uchar",6);this.scan("ushort",3);var g=this.scan("float",3);this.scan("float",3);var h=this.scan("ushort");this.scan("uchar",200);this.scan("ushort");this.scan("uchar",200);c=this.scan("float",16);this.scan("uchar",444);this.scan("uchar",4);this.scan("uchar",4);this.scan("float",6);this.scan("uchar",2);this.scan("uchar");this.scan("uchar");this.scan("uchar");
this.scan("uchar");this.scan("uchar");this.scan("uchar");var k=this.scan("uint");this.scan("uint");var j=this.scan("uint"),m=0===k?Infinity:k,l=[],n=[],k=Infinity,p=-Infinity,q=null,r=null,s=null,z=null,e=d=null,x=this.scan("uint",(this._data.byteLength-1E3)/4);this.jumpTo(j);for(var t=this.scan("float",(this._data.byteLength-1E3)/4),u=0,j=f=0;j<m;j++){if("undefined"===typeof x[u]){m=j;break}for(var v=x[u],y=new X.triplets(3*v),B=0,A=0;A<v;A++){var D=t[u+3*A+A*h+1],G=t[u+3*A+A*h+2],w=t[u+3*A+A*h+
3],D=D/g[0],G=G/g[1],w=w/g[2];y.add(D,G,w);if(0<A)var C=y.get(A-1),B=B+Math.sqrt(Math.pow(D-C[0],2)+Math.pow(G-C[1],2)+Math.pow(w-C[2],2));A<v-1&&(f+=6)}u+=3*v+v*h+1;A=y._minA;v=y._maxA;D=y._minB;G=y._maxB;w=y._minC;C=y._maxC;if(!q||A<q)q=A;if(!r||v>r)r=v;if(!s||D<s)s=D;if(!z||G>z)z=G;if(!d||w<d)d=w;if(!e||C>e)e=C;l.push(y);n.push(B)}g=(q+r)/2;h=(s+z)/2;z=(d+e)/2;s=new Float32Array(f);b._points=d=new X.triplets(f);b._normals=e=new X.triplets(f);b._colors=f=new X.triplets(f);for(j=q=0;j<m;j++){r=l[j];
x=r.count;B=n[j];k=Math.min(k,B);p=Math.max(p,B);for(A=0;A<x-1;A++){u=r.get(A);t=r.get(A+1);d.add(u[0],u[1],u[2]);d.add(t[0],t[1],t[2]);var y=u[0]-g,v=u[1]-h,D=u[2]-z,G=Math.sqrt(y*y+v*v+D*D),w=t[0]-g,C=t[1]-h,H=t[2]-z,E=Math.sqrt(w*w+C*C+H*H);e.add(y/G,v/G,D/G);e.add(w/E,C/E,H/E);t=[Math.abs(t[0]-u[0]),Math.abs(t[1]-u[1]),Math.abs(t[2]-u[2])];u=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=u;t[1]/=u;t[2]/=u;f.add(t[0],t[1],t[2]);f.add(t[0],t[1],t[2]);s[q++]=B;s[q++]=B;s[q++]=B;s[q++]=B;s[q++]=B;
s[q++]=B}}b._type=X.displayable.types.LINES;m=new X.scalars;m._min=k;m._max=p;m._lowerThreshold=k;m._upperThreshold=p;m._glArray=s;m._replaceMode=!1;m._dirty=!0;b._scalars=m;k=!1;for(j=0;16>j;j++)if(0!=c[j]){k=!0;break}!1==k&&(c[0]=c[5]=c[10]=c[15]=1);X.TIMERSTOP(this._classname+".parse");X.matrix.transpose(c,b._transform._matrix);c=new X.event.ModifiedEvent;c._object=b;c._container=a;this.dispatchEvent(c)};goog.exportSymbol("X.parserTRK",X.parserTRK);
goog.exportSymbol("X.parserTRK.prototype.parse",X.parserTRK.prototype.parse);X.parserOBJ=function(){X.parser.call(this);this._classname="parserOBJ"};goog.inherits(X.parserOBJ,X.parser);
X.parserOBJ.prototype.parse=function(a,b,c){X.TIMER(this._classname+".parse");this._data=c;c=c.byteLength;var d=this.scan("uchar",c),e=[];b._points=new X.triplets(c);b._normals=new X.triplets(c);var f=b._points,g=b._normals,h=0,k;for(k=0;k<c;++k)if(10==d[k]){h=this.parseChars(d,h,k).replace(/\s{2,}/g," ").split(" ");if("v"==h[0]){var j=parseFloat(h[1]),m=parseFloat(h[2]),h=parseFloat(h[3]);e.push([j,m,h])}else"f"==h[0]&&(m=e[parseInt(h[1],10)-1],j=e[parseInt(h[2],10)-1],h=e[parseInt(h[3],10)-1],f.add(m[0],
m[1],m[2]),f.add(j[0],j[1],j[2]),f.add(h[0],h[1],h[2]),m=new goog.math.Vec3(m[0],m[1],m[2]),j=new goog.math.Vec3(j[0],j[1],j[2]),h=new goog.math.Vec3(h[0],h[1],h[2]),h=goog.math.Vec3.cross(j.subtract(m),h.subtract(m)),h.normalize(),g.add(h.x,h.y,h.z),g.add(h.x,h.y,h.z),g.add(h.x,h.y,h.z));h=k+1}X.TIMERSTOP(this._classname+".parse");c=new X.event.ModifiedEvent;c._object=b;c._container=a;this.dispatchEvent(c)};goog.exportSymbol("X.parserOBJ",X.parserOBJ);
goog.exportSymbol("X.parserOBJ.prototype.parse",X.parserOBJ.prototype.parse);X.loader=function(){X.base.call(this);this._classname="loader";this._jobs=new goog.structs.Map;this._progress=0};goog.inherits(X.loader,X.base);X.loader.prototype.completed=function(){return!this._jobs.containsValue(!1)};X.loader.prototype.addProgress=function(a){this._progress+=a/this._jobs.getCount()/3;this._progress=Math.min(1,this._progress);a=new X.event.ProgressEvent;a._value=this._progress;this.dispatchEvent(a)};
X.loader.prototype.checkFileFormat=function(a){a=a._file._path;var b=a.split(".").pop().toUpperCase();b==a.toUpperCase()&&(b="");if(!(b in X.loader.extensions))throw Error("The "+b+" file format is not supported.");return[a,b,X.loader.extensions[b][0],X.loader.extensions[b][1],X.loader.extensions[b][2]]};
X.loader.prototype.load=function(a,b){if(!a||!b)throw Error("No container or object to load.");if(!this._jobs.containsKey(a._id)||this._jobs.get(a._id)){this._jobs.set(a._id,!1);var c=this.checkFileFormat(a)[0];if(null!=a._filedata)this.parse(null,a,b);else{var d=new XMLHttpRequest;goog.events.listen(d,"abort",this.failed.bind(this,d,a,b));goog.events.listen(d,"error",this.failed.bind(this,d,a,b));goog.events.listen(d,"load",this.parse.bind(this,d,a,b));d.open("GET",c,!0);d.responseType="arraybuffer";
d.send(null)}}};X.loader.prototype.parse=function(a,b,c){this.addProgress(1);setTimeout(function(){var d=this.checkFileFormat(b),e=d[3],d=new d[2];goog.events.listenOnce(d,X.event.events.MODIFIED,this.complete.bind(this));var f=b._filedata;null==f&&(f=a.response,b._filedata=f);d.parse(b,c,f,e)}.bind(this),100)};
X.loader.prototype.complete=function(a){this.addProgress(1);setTimeout(function(){var b=a._container,c=a._object;b._file._dirty=!1;b._dirty=!0;c.modified();this._jobs.set(b._id,!0)}.bind(this),100)};X.loader.prototype.failed=function(a,b,c){throw Error("Loading failed: ",b,c);};
X.loader.extensions={OBJ:[X.parserOBJ,null],OFF:[X.parserOFF,null],STL:[X.parserSTL,null],VTK:[X.parserVTK,null],TRK:[X.parserTRK,null],MRC:[X.parserMRC,null],ST:[X.parserMRC,null],FSM:[X.parserFSM,null],INFLATED:[X.parserFSM,null],SMOOTHWM:[X.parserFSM,null],SPHERE:[X.parserFSM,null],PIAL:[X.parserFSM,null],ORIG:[X.parserFSM,null],NRRD:[X.parserNRRD,null],NII:[X.parserNII,null],GZ:[X.parserNII,null],DCM:[X.parserDCM,null],DICOM:[X.parserDCM,null],"":[X.parserDCM,null],CRV:[X.parserCRV,null],LABEL:[X.parserLBL,
null],MGH:[X.parserMGZ,!1],MGZ:[X.parserMGZ,!0],RAW:[X.parserRAW,!1],RZ:[X.parserRAW,!0],TXT:[X.parserLUT,null],LUT:[X.parserLUT,null],PNG:[X.parserIMAGE,"png"],JPG:[X.parserIMAGE,"jpeg"],JPEG:[X.parserIMAGE,"jpeg"],GIF:[X.parserIMAGE,"gif"]};CSG.cylinder=function(a){function b(a,b,d){b=2*b*Math.PI;b=k.times(Math.cos(b)).plus(j.times(Math.sin(b)));a=c.plus(e.times(a)).plus(b.times(f));d=b.times(1-Math.abs(d)).plus(g.times(d));return new csgVertex(a,d)}CSG.call(this);a=a||{};var c=new csgVector(a.start||[0,-1,0]),d=new csgVector(a.end||[0,1,0]),e=d.minus(c),f=a.radius||1;a=a.slices||16;for(var g=e.unit(),h=0.5<Math.abs(g.y()),k=(new csgVector(h,!h,0)).cross(g).unit(),j=k.cross(g).unit(),h=new csgVertex(c,g.negated()),d=new csgVertex(d,
g.unit()),m=[],l=0;l<a;l++){var n=l/a,p=(l+1)/a;m.push(new csgPolygon([h,b(0,n,-1),b(0,p,-1)]));m.push(new csgPolygon([b(0,p,0),b(0,n,0),b(1,n,0),b(1,p,0)]));m.push(new csgPolygon([d,b(1,p,1),b(1,n,1)]))}return CSG.fromPolygons(m)};goog.inherits(CSG.cylinder,CSG);X.cylinder=function(){X.object.call(this);this._classname="cylinder";this._start=[-10,-10,-10];this._end=[10,10,10];this._radius=10;this._slices=32;inject(this,new X.constructable)};goog.inherits(X.cylinder,X.object);X.cylinder.prototype.__defineGetter__("start",function(){return this._start});X.cylinder.prototype.__defineSetter__("start",function(a){if(!goog.isDefAndNotNull(a)||!goog.isArray(a)||3!=a.length)throw Error("Invalid start");this._start=a});
X.cylinder.prototype.__defineGetter__("end",function(){return this._end});X.cylinder.prototype.__defineSetter__("end",function(a){if(!goog.isDefAndNotNull(a)||!goog.isArray(a)||3!=a.length)throw Error("Invalid end");this._end=a});X.cylinder.prototype.__defineGetter__("radius",function(){return this._radius});X.cylinder.prototype.__defineSetter__("radius",function(a){if(!goog.isNumber(a))throw Error("Invalid radius.");this._radius=a});
X.cylinder.prototype.modified=function(){this.fromCSG(new CSG.cylinder({start:this._start,end:this._end,radius:this._radius,slices:this._slices}));X.cylinder.superClass_.modified.call(this)};goog.exportSymbol("X.cylinder",X.cylinder);goog.exportSymbol("X.cylinder.prototype.modified",X.cylinder.prototype.modified);CSG.sphere=function(a){function b(a,b){a*=2*Math.PI;b*=Math.PI;var e=new csgVector(Math.cos(a)*Math.sin(b),Math.cos(b),Math.sin(a)*Math.sin(b));g.push(new csgVertex(c.plus(e.times(d)),e))}CSG.call(this);a=a||{};var c=new csgVector(a.center||[0,0,0]),d=a.radius||1,e=a.slices||16;a=a.stacks||8;for(var f=[],g=[],h=0;h<e;h++)for(var k=0;k<a;k++)g=[],b(h/e,k/a),0<k&&b((h+1)/e,k/a),k<a-1&&b((h+1)/e,(k+1)/a),b(h/e,(k+1)/a),f.push(new csgPolygon(g));return CSG.fromPolygons(f)};goog.inherits(CSG.sphere,CSG);X.sphere=function(){X.object.call(this);this._classname="sphere";this._center=[0,0,0];this._radius=5;this._slices=32;this._stacks=16;inject(this,new X.constructable)};goog.inherits(X.sphere,X.object);X.sphere.prototype.__defineGetter__("center",function(){return this._center});X.sphere.prototype.__defineSetter__("center",function(a){if(!goog.isDefAndNotNull(a)||!goog.isArray(a)||3!=a.length)throw Error("Invalid center");this._center=a});X.sphere.prototype.__defineGetter__("radius",function(){return this._radius});
X.sphere.prototype.__defineSetter__("radius",function(a){if(!goog.isNumber(a))throw Error("Invalid radius.");this._radius=a});X.sphere.prototype.modified=function(){this.fromCSG(new CSG.sphere({center:this._center,radius:this._radius,slices:this._slices,stacks:this._stacks}));X.sphere.superClass_.modified.call(this)};goog.exportSymbol("X.sphere",X.sphere);goog.exportSymbol("X.sphere.prototype.modified",X.sphere.prototype.modified);X.labelmap=function(a){X.volume.call(this);this._classname="labelmap";this._volume=a;this._showOnlyColor=new Float32Array([-255,-255,-255,-255])};goog.inherits(X.labelmap,X.volume);X.labelmap.prototype.modified=function(){var a=new X.event.ModifiedEvent;a._object=this;this.dispatchEvent(a);this._volume.modified()};
X.labelmap.prototype.__defineSetter__("showOnly",function(a){var b=[-1,-1,-1,-1];if(goog.isDefAndNotNull(a))if(goog.isArray(a)&&4==a.length)b=a;else{if(!this._colortable)throw Error("No colortable assigned.");b=this._colortable._map.get(a).slice(1,5)}this._showOnlyColor=new Float32Array([Math.floor(255*b[0]),Math.floor(255*b[1]),Math.floor(255*b[2]),Math.floor(255*b[3])])});goog.exportSymbol("X.labelmap",X.labelmap);CSG.cube=function(a){CSG.call(this);a=a||{};var b=new csgVector(a.center||[0,0,0]),c=!a.radius?[1,1,1]:a.radius.length?a.radius:[a.radius,a.radius,a.radius];return CSG.fromPolygons([[[0,4,6,2],[-1,0,0]],[[1,3,7,5],[1,0,0]],[[0,1,5,4],[0,-1,0]],[[2,6,7,3],[0,1,0]],[[0,2,3,1],[0,0,-1]],[[4,5,7,6],[0,0,1]]].map(function(a){return new csgPolygon(a[0].map(function(e){e=new csgVector(b.x()+c[0]*(2*!!(e&1)-1),b.y()+c[1]*(2*!!(e&2)-1),b.z()+c[2]*(2*!!(e&4)-1));return new csgVertex(e,new csgVector(a[1]))}))}))};
goog.inherits(CSG.cube,CSG);X.cube=function(){X.object.call(this);this._classname="cube";this._center=[0,0,0];this._lengthZ=this._lengthY=this._lengthX=20;this._textureCoordinateMap=[0,1,1,1,1,0,0,1,1,0,0,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0,0,0,0,1,1,1,0,0,1,1,1,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0];inject(this,new X.constructable)};goog.inherits(X.cube,X.object);X.cube.prototype.__defineGetter__("center",function(){return this._center});
X.cube.prototype.__defineSetter__("center",function(a){if(!goog.isDefAndNotNull(a)||!goog.isArray(a)||3!=a.length)throw Error("Invalid center");this._center=a});X.cube.prototype.__defineGetter__("lengthX",function(){return this._lengthX});X.cube.prototype.__defineSetter__("lengthX",function(a){if(!goog.isNumber(a))throw Error("Invalid lengthX.");this._lengthX=a});X.cube.prototype.__defineGetter__("lengthY",function(){return this._lengthY});
X.cube.prototype.__defineSetter__("lengthY",function(a){if(!goog.isNumber(a))throw Error("Invalid lengthY.");this._lengthY=a});X.cube.prototype.__defineGetter__("lengthZ",function(){return this._lengthZ});X.cube.prototype.__defineSetter__("lengthZ",function(a){if(!goog.isNumber(a))throw Error("Invalid lengthZ.");this._lengthZ=a});X.cube.prototype.modified=function(){this.fromCSG(new CSG.cube({center:this._center,radius:[this._lengthX/2,this._lengthY/2,this._lengthZ/2]}));X.cube.superClass_.modified.call(this)};
goog.exportSymbol("X.cube",X.cube);goog.exportSymbol("X.cube.prototype.modified",X.cube.prototype.modified);X.interactor3D=function(a){X.interactor.call(this,a);this._classname="interactor3D";this._clear_all=!1};goog.inherits(X.interactor3D,X.interactor);X.interactor3D.prototype.onMouseWheel_=function(a){X.interactor3D.superClass_.onMouseWheel_.call(this,a);var b=new X.event.ZoomEvent;goog.isDefAndNotNull(a.deltaY)||(a.deltaY=0);b._in=0>a.deltaY;b._fast=!0;this.dispatchEvent(b)};X.array=function(a){X.base.call(this);this._classname="array";this._array=[];this._comparator=a};goog.inherits(X.array,X.base);X.array.compare=function(a,b,c,d,e){for(var f=0;f<e;f++)if(a[f+c]!==b[f+d])return!1;return!0};X.array.prototype.add=function(a){this._array.push(a);return!0};X.array.prototype.remove=function(a){a=this._array.indexOf(a);-1<a&&this._array.splice(a,1);return!0};X.array.prototype.clear=function(){this._array.length=0};
X.array.prototype.swap_=function(a,b){var c=this._array[a];this._array[a]=this._array[b];this._array[b]=c};X.array.prototype.insert_=function(a,b,c){for(;a+1<b&&0>this._comparator(this._array[a+1],c);)this.swap_(a,a+1),++a;this._array[a]=c};X.array.prototype.merge_inplace_=function(a,b,c){for(;a<b;++a)if(0<this._comparator(this._array[a],this._array[b])){var d=this._array[a];this._array[a]=this._array[b];this.insert_(b,c,d)}};
X.array.prototype.msort_=function(a,b){var c=b-a;2>c||(c=a+Math.floor(c/2),this.msort_(a,c),this.msort_(c,b),this.merge_inplace_(a,c,b))};X.array.prototype.sort=function(){this.msort_(0,this._array.length)};X.array.prototype.values=function(){return this._array};goog.events.EventWrapper=function(){};goog.events.EventWrapper.prototype.listen=function(){};goog.events.EventWrapper.prototype.unlisten=function(){};goog.events.EventHandler=function(a){goog.Disposable.call(this);this.handler_=a;this.keys_=[]};goog.inherits(goog.events.EventHandler,goog.Disposable);goog.events.EventHandler.typeArray_=[];goog.events.EventHandler.prototype.listen=function(a,b,c,d,e){goog.isArray(b)||(goog.events.EventHandler.typeArray_[0]=b,b=goog.events.EventHandler.typeArray_);for(var f=0;f<b.length;f++){var g=goog.events.listen(a,b[f],c||this,d||!1,e||this.handler_||this);this.keys_.push(g)}return this};
goog.events.EventHandler.prototype.listenOnce=function(a,b,c,d,e){if(goog.isArray(b))for(var f=0;f<b.length;f++)this.listenOnce(a,b[f],c,d,e);else a=goog.events.listenOnce(a,b,c||this,d,e||this.handler_||this),this.keys_.push(a);return this};goog.events.EventHandler.prototype.listenWithWrapper=function(a,b,c,d,e){b.listen(a,c,d,e||this.handler_||this,this);return this};goog.events.EventHandler.prototype.getListenerCount=function(){return this.keys_.length};
goog.events.EventHandler.prototype.unlisten=function(a,b,c,d,e){if(goog.isArray(b))for(var f=0;f<b.length;f++)this.unlisten(a,b[f],c,d,e);else if(a=goog.events.getListener(a,b,c||this,d,e||this.handler_||this))a=a.key,goog.events.unlistenByKey(a),goog.array.remove(this.keys_,a);return this};goog.events.EventHandler.prototype.unlistenWithWrapper=function(a,b,c,d,e){b.unlisten(a,c,d,e||this.handler_||this,this);return this};
goog.events.EventHandler.prototype.removeAll=function(){goog.array.forEach(this.keys_,goog.events.unlistenByKey);this.keys_.length=0};goog.events.EventHandler.prototype.disposeInternal=function(){goog.events.EventHandler.superClass_.disposeInternal.call(this);this.removeAll()};goog.events.EventHandler.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented");};goog.ui={};goog.ui.IdGenerator=function(){};goog.addSingletonGetter(goog.ui.IdGenerator);goog.ui.IdGenerator.prototype.nextId_=0;goog.ui.IdGenerator.prototype.getNextUniqueId=function(){return":"+(this.nextId_++).toString(36)};goog.ui.IdGenerator.instance=goog.ui.IdGenerator.getInstance();goog.ui.Component=function(a){goog.events.EventTarget.call(this);this.dom_=a||goog.dom.getDomHelper();this.rightToLeft_=goog.ui.Component.defaultRightToLeft_};goog.inherits(goog.ui.Component,goog.events.EventTarget);goog.ui.Component.prototype.idGenerator_=goog.ui.IdGenerator.getInstance();goog.ui.Component.defaultRightToLeft_=null;
goog.ui.Component.EventType={BEFORE_SHOW:"beforeshow",SHOW:"show",HIDE:"hide",DISABLE:"disable",ENABLE:"enable",HIGHLIGHT:"highlight",UNHIGHLIGHT:"unhighlight",ACTIVATE:"activate",DEACTIVATE:"deactivate",SELECT:"select",UNSELECT:"unselect",CHECK:"check",UNCHECK:"uncheck",FOCUS:"focus",BLUR:"blur",OPEN:"open",CLOSE:"close",ENTER:"enter",LEAVE:"leave",ACTION:"action",CHANGE:"change"};
goog.ui.Component.Error={NOT_SUPPORTED:"Method not supported",DECORATE_INVALID:"Invalid element to decorate",ALREADY_RENDERED:"Component already rendered",PARENT_UNABLE_TO_BE_SET:"Unable to set parent component",CHILD_INDEX_OUT_OF_BOUNDS:"Child component index out of bounds",NOT_OUR_CHILD:"Child is not in parent component",NOT_IN_DOCUMENT:"Operation not supported while component is not in document",STATE_INVALID:"Invalid component state"};
goog.ui.Component.State={ALL:255,DISABLED:1,HOVER:2,ACTIVE:4,SELECTED:8,CHECKED:16,FOCUSED:32,OPENED:64};
goog.ui.Component.getStateTransitionEvent=function(a,b){switch(a){case goog.ui.Component.State.DISABLED:return b?goog.ui.Component.EventType.DISABLE:goog.ui.Component.EventType.ENABLE;case goog.ui.Component.State.HOVER:return b?goog.ui.Component.EventType.HIGHLIGHT:goog.ui.Component.EventType.UNHIGHLIGHT;case goog.ui.Component.State.ACTIVE:return b?goog.ui.Component.EventType.ACTIVATE:goog.ui.Component.EventType.DEACTIVATE;case goog.ui.Component.State.SELECTED:return b?goog.ui.Component.EventType.SELECT:
goog.ui.Component.EventType.UNSELECT;case goog.ui.Component.State.CHECKED:return b?goog.ui.Component.EventType.CHECK:goog.ui.Component.EventType.UNCHECK;case goog.ui.Component.State.FOCUSED:return b?goog.ui.Component.EventType.FOCUS:goog.ui.Component.EventType.BLUR;case goog.ui.Component.State.OPENED:return b?goog.ui.Component.EventType.OPEN:goog.ui.Component.EventType.CLOSE}throw Error(goog.ui.Component.Error.STATE_INVALID);};
goog.ui.Component.setDefaultRightToLeft=function(a){goog.ui.Component.defaultRightToLeft_=a};goog.ui.Component.prototype.id_=null;goog.ui.Component.prototype.inDocument_=!1;goog.ui.Component.prototype.element_=null;goog.ui.Component.prototype.rightToLeft_=null;goog.ui.Component.prototype.model_=null;goog.ui.Component.prototype.parent_=null;goog.ui.Component.prototype.children_=null;goog.ui.Component.prototype.childIndex_=null;goog.ui.Component.prototype.wasDecorated_=!1;
goog.ui.Component.prototype.getId=function(){return this.id_||(this.id_=this.idGenerator_.getNextUniqueId())};goog.ui.Component.prototype.setId=function(a){this.parent_&&this.parent_.childIndex_&&(goog.object.remove(this.parent_.childIndex_,this.id_),goog.object.add(this.parent_.childIndex_,a,this));this.id_=a};goog.ui.Component.prototype.getElement=function(){return this.element_};
goog.ui.Component.prototype.getElementStrict=function(){var a=this.element_;goog.asserts.assert(a,"Can not call getElementStrict before rendering/decorating.");return a};goog.ui.Component.prototype.setElementInternal=function(a){this.element_=a};goog.ui.Component.prototype.getElementsByClass=function(a){return this.element_?this.dom_.getElementsByClass(a,this.element_):[]};goog.ui.Component.prototype.getElementByClass=function(a){return this.element_?this.dom_.getElementByClass(a,this.element_):null};
goog.ui.Component.prototype.getHandler=function(){return this.googUiComponentHandler_||(this.googUiComponentHandler_=new goog.events.EventHandler(this))};goog.ui.Component.prototype.setParent=function(a){if(this==a)throw Error(goog.ui.Component.Error.PARENT_UNABLE_TO_BE_SET);if(a&&this.parent_&&this.id_&&this.parent_.getChild(this.id_)&&this.parent_!=a)throw Error(goog.ui.Component.Error.PARENT_UNABLE_TO_BE_SET);this.parent_=a;goog.ui.Component.superClass_.setParentEventTarget.call(this,a)};
goog.ui.Component.prototype.getParent=function(){return this.parent_};goog.ui.Component.prototype.setParentEventTarget=function(a){if(this.parent_&&this.parent_!=a)throw Error(goog.ui.Component.Error.NOT_SUPPORTED);goog.ui.Component.superClass_.setParentEventTarget.call(this,a)};goog.ui.Component.prototype.getDomHelper=function(){return this.dom_};goog.ui.Component.prototype.isInDocument=function(){return this.inDocument_};goog.ui.Component.prototype.createDom=function(){this.element_=this.dom_.createElement("div")};
goog.ui.Component.prototype.render=function(a){this.render_(a)};goog.ui.Component.prototype.renderBefore=function(a){this.render_(a.parentNode,a)};goog.ui.Component.prototype.render_=function(a,b){if(this.inDocument_)throw Error(goog.ui.Component.Error.ALREADY_RENDERED);this.element_||this.createDom();a?a.insertBefore(this.element_,b||null):this.dom_.getDocument().body.appendChild(this.element_);(!this.parent_||this.parent_.isInDocument())&&this.enterDocument()};
goog.ui.Component.prototype.decorate=function(a){if(this.inDocument_)throw Error(goog.ui.Component.Error.ALREADY_RENDERED);if(a&&this.canDecorate(a)){this.wasDecorated_=!0;if(!this.dom_||this.dom_.getDocument()!=goog.dom.getOwnerDocument(a))this.dom_=goog.dom.getDomHelper(a);this.decorateInternal(a);this.enterDocument()}else throw Error(goog.ui.Component.Error.DECORATE_INVALID);};goog.ui.Component.prototype.canDecorate=function(){return!0};goog.ui.Component.prototype.wasDecorated=function(){return this.wasDecorated_};
goog.ui.Component.prototype.decorateInternal=function(a){this.element_=a};goog.ui.Component.prototype.enterDocument=function(){this.inDocument_=!0;this.forEachChild(function(a){!a.isInDocument()&&a.getElement()&&a.enterDocument()})};goog.ui.Component.prototype.exitDocument=function(){this.forEachChild(function(a){a.isInDocument()&&a.exitDocument()});this.googUiComponentHandler_&&this.googUiComponentHandler_.removeAll();this.inDocument_=!1};
goog.ui.Component.prototype.disposeInternal=function(){this.inDocument_&&this.exitDocument();this.googUiComponentHandler_&&(this.googUiComponentHandler_.dispose(),delete this.googUiComponentHandler_);this.forEachChild(function(a){a.dispose()});!this.wasDecorated_&&this.element_&&goog.dom.removeNode(this.element_);this.parent_=this.model_=this.element_=this.childIndex_=this.children_=null;goog.ui.Component.superClass_.disposeInternal.call(this)};
goog.ui.Component.prototype.makeId=function(a){return this.getId()+"."+a};goog.ui.Component.prototype.makeIds=function(a){var b={},c;for(c in a)b[c]=this.makeId(a[c]);return b};goog.ui.Component.prototype.getModel=function(){return this.model_};goog.ui.Component.prototype.setModel=function(a){this.model_=a};goog.ui.Component.prototype.getFragmentFromId=function(a){return a.substring(this.getId().length+1)};
goog.ui.Component.prototype.getElementByFragment=function(a){if(!this.inDocument_)throw Error(goog.ui.Component.Error.NOT_IN_DOCUMENT);return this.dom_.getElement(this.makeId(a))};goog.ui.Component.prototype.addChild=function(a,b){this.addChildAt(a,this.getChildCount(),b)};
goog.ui.Component.prototype.addChildAt=function(a,b,c){if(a.inDocument_&&(c||!this.inDocument_))throw Error(goog.ui.Component.Error.ALREADY_RENDERED);if(0>b||b>this.getChildCount())throw Error(goog.ui.Component.Error.CHILD_INDEX_OUT_OF_BOUNDS);if(!this.childIndex_||!this.children_)this.childIndex_={},this.children_=[];a.getParent()==this?(goog.object.set(this.childIndex_,a.getId(),a),goog.array.remove(this.children_,a)):goog.object.add(this.childIndex_,a.getId(),a);a.setParent(this);goog.array.insertAt(this.children_,
a,b);a.inDocument_&&this.inDocument_&&a.getParent()==this?(c=this.getContentElement(),c.insertBefore(a.getElement(),c.childNodes[b]||null)):c?(this.element_||this.createDom(),b=this.getChildAt(b+1),a.render_(this.getContentElement(),b?b.element_:null)):this.inDocument_&&(!a.inDocument_&&a.element_&&a.element_.parentNode&&a.element_.parentNode.nodeType==goog.dom.NodeType.ELEMENT)&&a.enterDocument()};goog.ui.Component.prototype.getContentElement=function(){return this.element_};
goog.ui.Component.prototype.isRightToLeft=function(){null==this.rightToLeft_&&(this.rightToLeft_=goog.style.isRightToLeft(this.inDocument_?this.element_:this.dom_.getDocument().body));return this.rightToLeft_};goog.ui.Component.prototype.setRightToLeft=function(a){if(this.inDocument_)throw Error(goog.ui.Component.Error.ALREADY_RENDERED);this.rightToLeft_=a};goog.ui.Component.prototype.hasChildren=function(){return!!this.children_&&0!=this.children_.length};
goog.ui.Component.prototype.getChildCount=function(){return this.children_?this.children_.length:0};goog.ui.Component.prototype.getChildIds=function(){var a=[];this.forEachChild(function(b){a.push(b.getId())});return a};goog.ui.Component.prototype.getChild=function(a){return this.childIndex_&&a?goog.object.get(this.childIndex_,a)||null:null};goog.ui.Component.prototype.getChildAt=function(a){return this.children_?this.children_[a]||null:null};
goog.ui.Component.prototype.forEachChild=function(a,b){this.children_&&goog.array.forEach(this.children_,a,b)};goog.ui.Component.prototype.indexOfChild=function(a){return this.children_&&a?goog.array.indexOf(this.children_,a):-1};
goog.ui.Component.prototype.removeChild=function(a,b){if(a){var c=goog.isString(a)?a:a.getId();a=this.getChild(c);c&&a&&(goog.object.remove(this.childIndex_,c),goog.array.remove(this.children_,a),b&&(a.exitDocument(),a.element_&&goog.dom.removeNode(a.element_)),a.setParent(null))}if(!a)throw Error(goog.ui.Component.Error.NOT_OUR_CHILD);return a};goog.ui.Component.prototype.removeChildAt=function(a,b){return this.removeChild(this.getChildAt(a),b)};
goog.ui.Component.prototype.removeChildren=function(a){for(var b=[];this.hasChildren();)b.push(this.removeChildAt(0,a));return b};goog.a11y={};goog.a11y.aria={};
goog.a11y.aria.Role={ALERT:"alert",ALERTDIALOG:"alertdialog",APPLICATION:"application",ARTICLE:"article",BANNER:"banner",BUTTON:"button",CHECKBOX:"checkbox",COLUMNHEADER:"columnheader",COMBOBOX:"combobox",COMPLEMENTARY:"complementary",CONTENTINFO:"contentinfo",DEFINITION:"definition",DIALOG:"dialog",DIRECTORY:"directory",DOCUMENT:"document",FORM:"form",GRID:"grid",GRIDCELL:"gridcell",GROUP:"group",HEADING:"heading",IMG:"img",LINK:"link",LIST:"list",LISTBOX:"listbox",LISTITEM:"listitem",LOG:"log",
MAIN:"main",MARQUEE:"marquee",MATH:"math",MENU:"menu",MENUBAR:"menubar",MENU_ITEM:"menuitem",MENU_ITEM_CHECKBOX:"menuitemcheckbox",MENU_ITEM_RADIO:"menuitemradio",NAVIGATION:"navigation",NOTE:"note",OPTION:"option",PRESENTATION:"presentation",PROGRESSBAR:"progressbar",RADIO:"radio",RADIOGROUP:"radiogroup",REGION:"region",ROW:"row",ROWGROUP:"rowgroup",ROWHEADER:"rowheader",SCROLLBAR:"scrollbar",SEARCH:"search",SEPARATOR:"separator",SLIDER:"slider",SPINBUTTON:"spinbutton",STATUS:"status",TAB:"tab",
TAB_LIST:"tablist",TAB_PANEL:"tabpanel",TEXTBOX:"textbox",TIMER:"timer",TOOLBAR:"toolbar",TOOLTIP:"tooltip",TREE:"tree",TREEGRID:"treegrid",TREEITEM:"treeitem"};goog.a11y.aria.State={ACTIVEDESCENDANT:"activedescendant",ATOMIC:"atomic",AUTOCOMPLETE:"autocomplete",BUSY:"busy",CHECKED:"checked",CONTROLS:"controls",DESCRIBEDBY:"describedby",DISABLED:"disabled",DROPEFFECT:"dropeffect",EXPANDED:"expanded",FLOWTO:"flowto",GRABBED:"grabbed",HASPOPUP:"haspopup",HIDDEN:"hidden",INVALID:"invalid",LABEL:"label",LABELLEDBY:"labelledby",LEVEL:"level",LIVE:"live",MULTILINE:"multiline",MULTISELECTABLE:"multiselectable",ORIENTATION:"orientation",OWNS:"owns",POSINSET:"posinset",
PRESSED:"pressed",READONLY:"readonly",RELEVANT:"relevant",REQUIRED:"required",SELECTED:"selected",SETSIZE:"setsize",SORT:"sort",VALUEMAX:"valuemax",VALUEMIN:"valuemin",VALUENOW:"valuenow",VALUETEXT:"valuetext"};goog.a11y.aria.LivePriority={OFF:"off",POLITE:"polite",ASSERTIVE:"assertive"};goog.a11y.aria.setRole=function(a,b){a.setAttribute("role",b)};goog.a11y.aria.getRole=function(a){return a.getAttribute("role")||""};goog.a11y.aria.setState=function(a,b,c){a.setAttribute("aria-"+b,c)};goog.a11y.aria.getState=function(a,b){var c=a.getAttribute("aria-"+b);return!0===c||!1===c?c?"true":"false":c?String(c):""};goog.a11y.aria.getActiveDescendant=function(a){var b=goog.a11y.aria.getState(a,goog.a11y.aria.State.ACTIVEDESCENDANT);return goog.dom.getOwnerDocument(a).getElementById(b)};
goog.a11y.aria.setActiveDescendant=function(a,b){goog.a11y.aria.setState(a,goog.a11y.aria.State.ACTIVEDESCENDANT,b?b.id:"")};goog.a11y.aria.getLabel=function(a){return goog.a11y.aria.getState(a,goog.a11y.aria.State.LABEL)};goog.a11y.aria.setLabel=function(a,b){goog.a11y.aria.setState(a,goog.a11y.aria.State.LABEL,b)};goog.ui.RangeModel=function(){goog.events.EventTarget.call(this)};goog.inherits(goog.ui.RangeModel,goog.events.EventTarget);goog.ui.RangeModel.prototype.value_=0;goog.ui.RangeModel.prototype.minimum_=0;goog.ui.RangeModel.prototype.maximum_=100;goog.ui.RangeModel.prototype.extent_=0;goog.ui.RangeModel.prototype.step_=1;goog.ui.RangeModel.prototype.isChanging_=!1;goog.ui.RangeModel.prototype.mute_=!1;goog.ui.RangeModel.prototype.setMute=function(a){this.mute_=a};
goog.ui.RangeModel.prototype.setValue=function(a){a=this.roundToStepWithMin(a);this.value_!=a&&(this.value_=a+this.extent_>this.maximum_?this.maximum_-this.extent_:a<this.minimum_?this.minimum_:a,!this.isChanging_&&!this.mute_&&this.dispatchEvent(goog.ui.Component.EventType.CHANGE))};goog.ui.RangeModel.prototype.getValue=function(){return this.roundToStepWithMin(this.value_)};
goog.ui.RangeModel.prototype.setExtent=function(a){a=this.roundToStepWithMin(a);this.extent_!=a&&(this.extent_=0>a?0:this.value_+a>this.maximum_?this.maximum_-this.value_:a,!this.isChanging_&&!this.mute_&&this.dispatchEvent(goog.ui.Component.EventType.CHANGE))};goog.ui.RangeModel.prototype.getExtent=function(){return this.roundToStep(this.extent_)};
goog.ui.RangeModel.prototype.setMinimum=function(a){if(this.minimum_!=a){var b=this.isChanging_;this.isChanging_=!0;this.minimum_=a;a+this.extent_>this.maximum_&&(this.extent_=this.maximum_-this.minimum_);a>this.value_&&this.setValue(a);a>this.maximum_&&(this.extent_=0,this.setMaximum(a),this.setValue(a));this.isChanging_=b;!this.isChanging_&&!this.mute_&&this.dispatchEvent(goog.ui.Component.EventType.CHANGE)}};goog.ui.RangeModel.prototype.getMinimum=function(){return this.roundToStepWithMin(this.minimum_)};
goog.ui.RangeModel.prototype.setMaximum=function(a){a=this.roundToStepWithMin(a);if(this.maximum_!=a){var b=this.isChanging_;this.isChanging_=!0;this.maximum_=a;a<this.value_+this.extent_&&this.setValue(a-this.extent_);a<this.minimum_&&(this.extent_=0,this.setMinimum(a),this.setValue(this.maximum_));a<this.minimum_+this.extent_&&(this.extent_=this.maximum_-this.minimum_);this.isChanging_=b;!this.isChanging_&&!this.mute_&&this.dispatchEvent(goog.ui.Component.EventType.CHANGE)}};
goog.ui.RangeModel.prototype.getMaximum=function(){return this.roundToStepWithMin(this.maximum_)};goog.ui.RangeModel.prototype.getStep=function(){return this.step_};goog.ui.RangeModel.prototype.setStep=function(a){this.step_!=a&&(this.step_=a,a=this.isChanging_,this.isChanging_=!0,this.setMaximum(this.getMaximum()),this.setExtent(this.getExtent()),this.setValue(this.getValue()),this.isChanging_=a,!this.isChanging_&&!this.mute_&&this.dispatchEvent(goog.ui.Component.EventType.CHANGE))};
goog.ui.RangeModel.prototype.roundToStepWithMin=function(a){return null==this.step_?a:this.minimum_+Math.round((a-this.minimum_)/this.step_)*this.step_};goog.ui.RangeModel.prototype.roundToStep=function(a){return null==this.step_?a:Math.round(a/this.step_)*this.step_};goog.ui.ProgressBar=function(a){goog.ui.Component.call(this,a);this.rangeModel_=new goog.ui.RangeModel;goog.events.listen(this.rangeModel_,goog.ui.Component.EventType.CHANGE,this.handleChange_,!1,this)};goog.inherits(goog.ui.ProgressBar,goog.ui.Component);goog.ui.ProgressBar.Orientation={VERTICAL:"vertical",HORIZONTAL:"horizontal"};goog.ui.ProgressBar.ORIENTATION_TO_CSS_NAME_={};goog.ui.ProgressBar.ORIENTATION_TO_CSS_NAME_[goog.ui.ProgressBar.Orientation.VERTICAL]="progress-bar-vertical";
goog.ui.ProgressBar.ORIENTATION_TO_CSS_NAME_[goog.ui.ProgressBar.Orientation.HORIZONTAL]="progress-bar-horizontal";goog.ui.ProgressBar.prototype.createDom=function(){this.thumbElement_=this.createThumb_();var a=goog.ui.ProgressBar.ORIENTATION_TO_CSS_NAME_[this.orientation_];this.setElementInternal(this.getDomHelper().createDom("div",a,this.thumbElement_));this.setValueState_();this.setMinimumState_();this.setMaximumState_()};
goog.ui.ProgressBar.prototype.enterDocument=function(){goog.ui.ProgressBar.superClass_.enterDocument.call(this);this.attachEvents_();this.updateUi_();var a=this.getElement();goog.asserts.assert(a,"The progress bar DOM element cannot be null.");goog.a11y.aria.setRole(a,"progressbar");goog.a11y.aria.setState(a,"live","polite")};goog.ui.ProgressBar.prototype.exitDocument=function(){goog.ui.ProgressBar.superClass_.exitDocument.call(this);this.detachEvents_()};
goog.ui.ProgressBar.prototype.createThumb_=function(){return this.getDomHelper().createDom("div","progress-bar-thumb")};goog.ui.ProgressBar.prototype.attachEvents_=function(){goog.userAgent.IE&&7>goog.userAgent.VERSION&&goog.events.listen(this.getElement(),goog.events.EventType.RESIZE,this.updateUi_,!1,this)};goog.ui.ProgressBar.prototype.detachEvents_=function(){goog.userAgent.IE&&7>goog.userAgent.VERSION&&goog.events.unlisten(this.getElement(),goog.events.EventType.RESIZE,this.updateUi_,!1,this)};
goog.ui.ProgressBar.prototype.decorateInternal=function(a){goog.ui.ProgressBar.superClass_.decorateInternal.call(this,a);goog.dom.classes.add(this.getElement(),goog.ui.ProgressBar.ORIENTATION_TO_CSS_NAME_[this.orientation_]);a=goog.dom.getElementsByTagNameAndClass(null,"progress-bar-thumb",this.getElement())[0];a||(a=this.createThumb_(),this.getElement().appendChild(a));this.thumbElement_=a};goog.ui.ProgressBar.prototype.getValue=function(){return this.rangeModel_.getValue()};
goog.ui.ProgressBar.prototype.setValue=function(a){this.rangeModel_.setValue(a);this.getElement()&&this.setValueState_()};goog.ui.ProgressBar.prototype.setValueState_=function(){var a=this.getElement();goog.asserts.assert(a,"The progress bar DOM element cannot be null.");goog.a11y.aria.setState(a,"valuenow",this.getValue())};goog.ui.ProgressBar.prototype.getMinimum=function(){return this.rangeModel_.getMinimum()};
goog.ui.ProgressBar.prototype.setMinimum=function(a){this.rangeModel_.setMinimum(a);this.getElement()&&this.setMinimumState_()};goog.ui.ProgressBar.prototype.setMinimumState_=function(){var a=this.getElement();goog.asserts.assert(a,"The progress bar DOM element cannot be null.");goog.a11y.aria.setState(a,"valuemin",this.getMinimum())};goog.ui.ProgressBar.prototype.getMaximum=function(){return this.rangeModel_.getMaximum()};
goog.ui.ProgressBar.prototype.setMaximum=function(a){this.rangeModel_.setMaximum(a);this.getElement()&&this.setMaximumState_()};goog.ui.ProgressBar.prototype.setMaximumState_=function(){var a=this.getElement();goog.asserts.assert(a,"The progress bar DOM element cannot be null.");goog.a11y.aria.setState(a,"valuemax",this.getMaximum())};goog.ui.ProgressBar.prototype.orientation_=goog.ui.ProgressBar.Orientation.HORIZONTAL;goog.ui.ProgressBar.prototype.handleChange_=function(){this.updateUi_();this.dispatchEvent(goog.ui.Component.EventType.CHANGE)};
goog.ui.ProgressBar.prototype.updateUi_=function(){if(this.thumbElement_){var a=this.getMinimum(),b=this.getMaximum(),a=(this.getValue()-a)/(b-a),b=Math.round(100*a);this.orientation_==goog.ui.ProgressBar.Orientation.VERTICAL?goog.userAgent.IE&&7>goog.userAgent.VERSION?(this.thumbElement_.style.top=0,this.thumbElement_.style.height="100%",b=this.thumbElement_.offsetHeight,a=Math.round(a*b),this.thumbElement_.style.top=b-a+"px",this.thumbElement_.style.height=a+"px"):(this.thumbElement_.style.top=
100-b+"%",this.thumbElement_.style.height=b+"%"):this.thumbElement_.style.width=b+"%"}};goog.ui.ProgressBar.prototype.initializeUi_=function(){var a=this.thumbElement_.style;this.orientation_==goog.ui.ProgressBar.Orientation.VERTICAL?(a.left=0,a.width="100%"):(a.top=a.left=0,a.height="100%")};
goog.ui.ProgressBar.prototype.setOrientation=function(a){if(this.orientation_!=a){var b=goog.ui.ProgressBar.ORIENTATION_TO_CSS_NAME_[this.orientation_],c=goog.ui.ProgressBar.ORIENTATION_TO_CSS_NAME_[a];this.orientation_=a;this.getElement()&&(goog.dom.classes.swap(this.getElement(),b,c),this.initializeUi_(),this.updateUi_())}};goog.ui.ProgressBar.prototype.getOrientation=function(){return this.orientation_};
goog.ui.ProgressBar.prototype.disposeInternal=function(){this.detachEvents_();goog.ui.ProgressBar.superClass_.disposeInternal.call(this);this.thumbElement_=null;this.rangeModel_.dispose()};goog.ui.ProgressBar.prototype.getStep=function(){return this.rangeModel_.getStep()};goog.ui.ProgressBar.prototype.setStep=function(a){this.rangeModel_.setStep(a)};X.progressbar=function(a,b){if(!goog.isDefAndNotNull(a))throw Error("No valid parent element.");if(!goog.isDefAndNotNull(b))throw Error("Invalid initial value.");goog.ui.ProgressBar.call(this);this._classname="progressbar";this._parent=a;this._parent_position_original="";this._doneProgressBar=this._style=null;this._css=[];var c;c=".progress-bar-horizontal {\n  position: relative;\n  border: 1px solid #949dad;\n";c+="  background: white;\n";c+="  padding: 1px;\n";c+="  overflow: hidden;\n";c+="  margin: 2px;\n";
c+="  width: 100px;\n";c+="  height: 5px;\n";c+="}";var d;d=".progress-bar-thumb {\n  position: relative;\n  background: #F62217;\n";d+="  overflow: hidden;\n";d+="  width: 0%;\n";d+="  height: 100%;\n";d+="}";var e;e=".progress-bar-thumb-done {\n  background: #57E964;\n}";this._css=[c,d,e];this.setValue(b);this.init_()};goog.inherits(X.progressbar,goog.ui.ProgressBar);
X.progressbar.prototype.init_=function(){var a=goog.style.getComputedStyle(this._parent,"position");if("static"==a||""==a)this._parent_position_original=this._parent.style.position,this._parent.style.position="relative";var a=goog.dom.getDocument().getElementsByTagName("head")[0],b=goog.dom.createDom("style");b.type="text/css";b.media="screen";var c=goog.dom.createTextNode(this._css[0]),d=goog.dom.createTextNode(this._css[1]),e=goog.dom.createTextNode(this._css[2]);goog.dom.appendChild(a,b);goog.dom.appendChild(b,
c);goog.dom.appendChild(b,d);goog.dom.appendChild(b,e);this._style=b;this.render(this._parent);a=this.getElement();a.style.position="absolute";a.style.top=(this._parent.clientHeight-5)/2+"px";a.style.left=(this._parent.clientWidth-100)/2+"px";a.classList.add("xtk-progress-bar")};
X.progressbar.prototype.done=function(){var a=this.getElement().style.top,b=this.getElement().style.left;goog.dom.removeNode(this.getElement());var c=new X.progressbar(this._parent,100),d=c.getElement();d.style.position="absolute";d.style.top=a;d.style.left=b;d.classList.add("xtk-progress-bar");goog.dom.getFirstElementChild(d).classList.add("progress-bar-thumb-done");this._doneProgressBar=c};
X.progressbar.prototype.kill=function(){this._style&&goog.dom.removeNode(this._style);this.getElement()&&goog.dom.removeNode(this.getElement());this._doneProgressBar&&goog.dom.removeNode(this._doneProgressBar.getElement());this._doneProgressBar=this._style=null;this._parent_position_original&&(this._parent.style.position=this._parent_position_original)};goog.Timer=function(a,b){goog.events.EventTarget.call(this);this.interval_=a||1;this.timerObject_=b||goog.Timer.defaultTimerObject;this.boundTick_=goog.bind(this.tick_,this);this.last_=goog.now()};goog.inherits(goog.Timer,goog.events.EventTarget);goog.Timer.MAX_TIMEOUT_=2147483647;goog.Timer.prototype.enabled=!1;goog.Timer.defaultTimerObject=goog.global;goog.Timer.intervalScale=0.8;goog.Timer.prototype.timer_=null;goog.Timer.prototype.getInterval=function(){return this.interval_};
goog.Timer.prototype.setInterval=function(a){this.interval_=a;this.timer_&&this.enabled?(this.stop(),this.start()):this.timer_&&this.stop()};goog.Timer.prototype.tick_=function(){if(this.enabled){var a=goog.now()-this.last_;0<a&&a<this.interval_*goog.Timer.intervalScale?this.timer_=this.timerObject_.setTimeout(this.boundTick_,this.interval_-a):(this.dispatchTick(),this.enabled&&(this.timer_=this.timerObject_.setTimeout(this.boundTick_,this.interval_),this.last_=goog.now()))}};
goog.Timer.prototype.dispatchTick=function(){this.dispatchEvent(goog.Timer.TICK)};goog.Timer.prototype.start=function(){this.enabled=!0;this.timer_||(this.timer_=this.timerObject_.setTimeout(this.boundTick_,this.interval_),this.last_=goog.now())};goog.Timer.prototype.stop=function(){this.enabled=!1;this.timer_&&(this.timerObject_.clearTimeout(this.timer_),this.timer_=null)};goog.Timer.prototype.disposeInternal=function(){goog.Timer.superClass_.disposeInternal.call(this);this.stop();delete this.timerObject_};
goog.Timer.TICK="tick";goog.Timer.callOnce=function(a,b,c){if(goog.isFunction(a))c&&(a=goog.bind(a,c));else if(a&&"function"==typeof a.handleEvent)a=goog.bind(a.handleEvent,a);else throw Error("Invalid listener argument");return b>goog.Timer.MAX_TIMEOUT_?-1:goog.Timer.defaultTimerObject.setTimeout(a,b||0)};goog.Timer.clear=function(a){goog.Timer.defaultTimerObject.clearTimeout(a)};X.renderer=function(){X.base.call(this);this._classname="renderer";this._container=window.document.body;this._width=this._container.clientWidth;this._height=this._container.clientHeight;this._interactor=this._camera=this._canvas=null;this._objects=new X.array(X.object.OPACITY_COMPARATOR);this._topLevelObjects=[];this._loader=null;this._onShowtime=this._loadingCompleted=this._locked=!1;this._context=this._progressBar2=this._progressBar=null;this._config={PROGRESSBAR_ENABLED:!0,INTERMEDIATE_RENDERING:!1,
SLICENAVIGATORS:!0};this._AnimationFrameID=-1;window.console.log("XTK release 10 -- 2015-08-05 22:22:28 -- http://www.goXTK.com -- @goXTK")};goog.inherits(X.renderer,X.base);X.renderer.prototype.onComputing=function(){window.cancelAnimationFrame(this._AnimationFrameID);this._config.PROGRESSBAR_ENABLED&&(this._progressBar2=new X.progressbar(this._container,3))};
X.renderer.prototype.onComputingEnd=function(){this._config.PROGRESSBAR_ENABLED&&this._progressBar2&&(this._progressBar2.done(),this.__readyCheckTimer2=goog.Timer.callOnce(function(){this.__readyCheckTimer2=null;this._progressBar2&&(this._progressBar2.kill(),this._progressBar2=null);this._loadingCompleted=this._onShowtime=!0;this.render()}.bind(this),700))};X.renderer.prototype.onComputingProgress=function(a){this._progressBar2&&this._progressBar2.setValue(100*a._value)};
X.renderer.prototype.onProgress=function(a){this._progressBar&&this._progressBar.setValue(100*a._value)};X.renderer.prototype.onModified=function(a){goog.isDefAndNotNull(a)&&a instanceof X.event.ModifiedEvent&&a._object&&this.update_(a._object)};X.renderer.prototype.onRemove=function(a){goog.isDefAndNotNull(a)&&a instanceof X.event.RemoveEvent&&a._object&&this.remove(a._object)};
X.renderer.prototype.onHover_=function(a){if(!goog.isDefAndNotNull(a)||!(a instanceof X.event.HoverEvent))throw Error("Invalid hover event.");};X.renderer.prototype.onResize_=function(){this.resize()};
X.renderer.prototype.resize=function(){var a=goog.dom.getElement(this._container);this._width=a.clientWidth;this._height=a.clientHeight;a=goog.dom.getElement(this._canvas);a.width=this._width;a.height=this._height;"renderer3D"==this._classname&&(this._context.viewport(0,0,this._width,this._height),this._camera._perspective=X.matrix.makePerspective(X.matrix.identity(),this._camera._fieldOfView,this._canvas.width/this._canvas.height,1,1E4))};
X.renderer.prototype.onScroll_=function(a){if(!goog.isDefAndNotNull(a)||!(a instanceof X.event.ScrollEvent))throw Error("Invalid scroll event.");};X.renderer.prototype.__defineGetter__("config",function(){return this._config});X.renderer.prototype.__defineGetter__("interactor",function(){return this._interactor});X.renderer.prototype.__defineGetter__("camera",function(){return this._camera});X.renderer.prototype.__defineGetter__("loadingCompleted",function(){return this._loadingCompleted});
X.renderer.prototype.__defineGetter__("container",function(){return this._container});X.renderer.prototype.__defineSetter__("container",function(a){if(!goog.isDefAndNotNull(a))throw Error("An ID to a valid container (<div>..) is required.");var b=a;goog.isString(b)&&(b=goog.dom.getElement(a));if(!goog.dom.isElement(b))throw Error("Could not find the given container.");this._container=b});X.renderer.prototype.resetViewAndRender=function(){this._camera.reset()};
X.renderer.prototype.showProgressBar_=function(){this._config.PROGRESSBAR_ENABLED&&!this._progressBar&&(this._progressBar=new X.progressbar(this._container,3))};X.renderer.prototype.hideProgressBar_=function(){this._config.PROGRESSBAR_ENABLED&&(this._progressBar&&!this.__readyCheckTimer2)&&(this._progressBar.done(),this.__readyCheckTimer2=goog.Timer.callOnce(function(){this.__readyCheckTimer2=null;this._progressBar&&(this._progressBar.kill(),this._progressBar=null);this.render()}.bind(this),700))};
X.renderer.prototype.init=function(a){var b=goog.dom.createDom("canvas");goog.dom.appendChild(this._container,b);this._width=this._container.clientWidth;this._height=this._container.clientHeight;b.width=this._width;b.height=this._height;try{var c=b.getContext(a);if(!c)throw Error();}catch(d){throw a="Sorry, "+a+' context is <strong>not supported</strong> on this machine! See <a href="http://crash.goXTK.com" target="_blank">http://crash.goXTK.com</a> for requirements..',this._container.innerHTML='<h3 style="color:red;font-family:sans-serif;">Oooops..</h3><p style="color:red;font-family:sans-serif;">'+
a+"</p>",Error(a);}this._loader=new X.loader;goog.events.listen(this._loader,X.event.events.PROGRESS,this.onProgress.bind(this));this._canvas=b;this._context=c;b=new X.interactor3D(this._canvas);"2d"==a&&(b=new X.interactor2D(this._canvas));b.init();goog.events.listen(b,X.event.events.RESETVIEW,this.resetViewAndRender.bind(this));goog.events.listen(b,X.event.events.HOVER,this.onHover_.bind(this));goog.events.listen(b,X.event.events.SCROLL,this.onScroll_.bind(this));this._interactor=b;b=new X.camera3D(this._width,
this._height);"2d"==a&&(b=new X.camera2D(this._width,this._height));b.observe(this._interactor);this._camera=b;goog.events.listen(window,goog.events.EventType.RESIZE,this.onResize_,!1,this)};X.renderer.prototype.add=function(a){(a instanceof X.cube||a instanceof X.sphere||a instanceof X.cylinder)&&a.modified();this._topLevelObjects.push(a);this.update_(a)};
X.renderer.prototype.remove=function(a){if(!this._canvas||!this._context)throw Error("The renderer was not initialized properly.");if(goog.isDefAndNotNull(a)){goog.events.removeAll(a);var b=this._topLevelObjects.length,c;for(c=0;c<b;c++)if(this._topLevelObjects[c]._id==a._id)return this._topLevelObjects[c]=null,this._topLevelObjects.splice(c,1),!0}return!1};
X.renderer.prototype.update_=function(a){if(!this._canvas||!this._context)throw Error("The renderer was not initialized properly.");goog.isDefAndNotNull(a)&&(goog.events.hasListener(a,X.event.events.MODIFIED)||goog.events.listen(a,X.event.events.MODIFIED,this.onModified.bind(this)),goog.events.hasListener(a,X.event.events.REMOVE)||goog.events.listen(a,X.event.events.REMOVE,this.onRemove.bind(this)),goog.events.hasListener(a,X.event.events.COMPUTING)||goog.events.listen(a,X.event.events.COMPUTING,
this.onComputing.bind(this)),goog.events.hasListener(a,X.event.events.COMPUTING_PROGRESS)||goog.events.listen(a,X.event.events.COMPUTING_PROGRESS,this.onComputingProgress.bind(this)),goog.events.hasListener(a,X.event.events.COMPUTING_END)||goog.events.listen(a,X.event.events.COMPUTING_END,this.onComputingEnd.bind(this)))};
X.renderer.prototype.get=function(a){if(!goog.isDefAndNotNull(a))throw Error("Invalid object id.");for(var b=this._objects.values(),c=b.length,d=0,d=0;d<c;d++)if(b[d]._id==a)return b[d];return null};X.renderer.prototype.printScene=function(){var a=this._topLevelObjects.length,b;for(b=0;b<a;b++)this.generateTree_(this._topLevelObjects[b],0)};
X.renderer.prototype.generateTree_=function(a,b){if("undefined"!=typeof a){for(var c=0,c=0;c<b;c++);if(0<a._children.length)for(var c=a._children,d=c.length,e=0,e=0;e<d;e++)this.generateTree_(c[e],b+1)}};
X.renderer.prototype.render=function(){if(!this._canvas||!this._context)throw Error("The renderer was not initialized properly.");if(!goog.isDefAndNotNull(this._readyCheckTimer)){if(this._loader.completed()){if(!this._loadingCompleted&&!this._onShowtime&&(this._onShowtime=!0,eval("this.onShowtime()"),this._loadingCompleted=!0),this._progressBar){this.hideProgressBar_();return}}else if(this.showProgressBar_(),this._onShowtime=this._loadingCompleted=!1,this._readyCheckTimer=goog.Timer.callOnce(function(){this._readyCheckTimer=
null;this.render()}.bind(this),100),!this._config.INTERMEDIATE_RENDERING)return;this._AnimationFrameID=window.requestAnimationFrame(this.render.bind(this));eval("this.onRender()");this.render_(!1,!0);eval("this.afterRender()")}};X.renderer.prototype.onShowtime=function(){};X.renderer.prototype.onRender=function(){};X.renderer.prototype.afterRender=function(){};X.renderer.prototype.render_=function(){};
X.renderer.prototype.destroy=function(){goog.events.removeAll(this);goog.events.unlisten(window,goog.events.EventType.RESIZE,this.onResize_,!1,this);window.cancelAnimationFrame(this._AnimationFrameID);this._loader&&(delete this._loader,this._loader=null);this._progressBar&&(this._progressBar.kill(),delete this._progressBar,this._progressBar=null);this._objects.clear();delete this._objects;this._topLevelObjects.length=0;delete this._topLevelObjects;delete this._loader;this._loader=null;delete this._camera;
this._camera=null;delete this._interactor;this._interactor=null;delete this._context;this._context=null;goog.dom.removeNode(this._canvas);delete this._canvas;this._canvas=null};goog.style.bidi={};goog.style.bidi.getScrollLeft=function(a){var b=goog.style.isRightToLeft(a);return b&&goog.userAgent.GECKO?-a.scrollLeft:b&&(!goog.userAgent.IE||!goog.userAgent.isVersionOrHigher("8"))&&"visible"!=goog.style.getComputedOverflowX(a)?a.scrollWidth-a.clientWidth-a.scrollLeft:a.scrollLeft};
goog.style.bidi.getOffsetStart=function(a){var b=a.offsetLeft,c=a.offsetParent;!c&&"fixed"==goog.style.getComputedPosition(a)&&(c=goog.dom.getOwnerDocument(a).documentElement);if(!c)return b;if(goog.userAgent.GECKO)var d=goog.style.getBorderBox(c),b=b+d.left;else goog.userAgent.isDocumentMode(8)&&(d=goog.style.getBorderBox(c),b-=d.left);return goog.style.isRightToLeft(c)?c.clientWidth-(b+a.offsetWidth):b};
goog.style.bidi.setScrollOffset=function(a,b){b=Math.max(b,0);a.scrollLeft=goog.style.isRightToLeft(a)?goog.userAgent.GECKO?-b:!goog.userAgent.IE||!goog.userAgent.isVersionOrHigher("8")?a.scrollWidth-b-a.clientWidth:b:b};goog.style.bidi.setPosition=function(a,b,c,d){goog.isNull(c)||(a.style.top=c+"px");d?(a.style.right=b+"px",a.style.left=""):(a.style.left=b+"px",a.style.right="")};goog.positioning={};goog.positioning.Corner={TOP_LEFT:0,TOP_RIGHT:2,BOTTOM_LEFT:1,BOTTOM_RIGHT:3,TOP_START:4,TOP_END:6,BOTTOM_START:5,BOTTOM_END:7};goog.positioning.CornerBit={BOTTOM:1,RIGHT:2,FLIP_RTL:4};goog.positioning.Overflow={IGNORE:0,ADJUST_X:1,FAIL_X:2,ADJUST_Y:4,FAIL_Y:8,RESIZE_WIDTH:16,RESIZE_HEIGHT:32,ADJUST_X_EXCEPT_OFFSCREEN:65,ADJUST_Y_EXCEPT_OFFSCREEN:132};
goog.positioning.OverflowStatus={NONE:0,ADJUSTED_X:1,ADJUSTED_Y:2,WIDTH_ADJUSTED:4,HEIGHT_ADJUSTED:8,FAILED_LEFT:16,FAILED_RIGHT:32,FAILED_TOP:64,FAILED_BOTTOM:128,FAILED_OUTSIDE_VIEWPORT:256};goog.positioning.OverflowStatus.FAILED=goog.positioning.OverflowStatus.FAILED_LEFT|goog.positioning.OverflowStatus.FAILED_RIGHT|goog.positioning.OverflowStatus.FAILED_TOP|goog.positioning.OverflowStatus.FAILED_BOTTOM|goog.positioning.OverflowStatus.FAILED_OUTSIDE_VIEWPORT;
goog.positioning.OverflowStatus.FAILED_HORIZONTAL=goog.positioning.OverflowStatus.FAILED_LEFT|goog.positioning.OverflowStatus.FAILED_RIGHT;goog.positioning.OverflowStatus.FAILED_VERTICAL=goog.positioning.OverflowStatus.FAILED_TOP|goog.positioning.OverflowStatus.FAILED_BOTTOM;
goog.positioning.positionAtAnchor=function(a,b,c,d,e,f,g,h,k){goog.asserts.assert(c);var j=goog.positioning.getOffsetParentPageOffset(c),m=goog.positioning.getVisiblePart_(a);goog.style.translateRectForAnotherFrame(m,goog.dom.getDomHelper(a),goog.dom.getDomHelper(c));a=goog.positioning.getEffectiveCorner(a,b);m=new goog.math.Coordinate(a&goog.positioning.CornerBit.RIGHT?m.left+m.width:m.left,a&goog.positioning.CornerBit.BOTTOM?m.top+m.height:m.top);m=goog.math.Coordinate.difference(m,j);e&&(m.x+=
(a&goog.positioning.CornerBit.RIGHT?-1:1)*e.x,m.y+=(a&goog.positioning.CornerBit.BOTTOM?-1:1)*e.y);var l;if(g)if(k)l=k;else if(l=goog.style.getVisibleRectForElement(c))l.top-=j.y,l.right-=j.x,l.bottom-=j.y,l.left-=j.x;return goog.positioning.positionAtCoordinate(m,c,d,f,l,g,h)};
goog.positioning.getOffsetParentPageOffset=function(a){var b;if(a=a.offsetParent){var c=a.tagName==goog.dom.TagName.HTML||a.tagName==goog.dom.TagName.BODY;if(!c||"static"!=goog.style.getComputedPosition(a))b=goog.style.getPageOffset(a),c||(b=goog.math.Coordinate.difference(b,new goog.math.Coordinate(goog.style.bidi.getScrollLeft(a),a.scrollTop)))}return b||new goog.math.Coordinate};
goog.positioning.getVisiblePart_=function(a){var b=goog.style.getBounds(a);(a=goog.style.getVisibleRectForElement(a))&&b.intersection(goog.math.Rect.createFromBox(a));return b};
goog.positioning.positionAtCoordinate=function(a,b,c,d,e,f,g){a=a.clone();var h=goog.positioning.OverflowStatus.NONE;c=goog.positioning.getEffectiveCorner(b,c);var k=goog.style.getSize(b);g=g?g.clone():k.clone();if(d||c!=goog.positioning.Corner.TOP_LEFT)c&goog.positioning.CornerBit.RIGHT?a.x-=g.width+(d?d.right:0):d&&(a.x+=d.left),c&goog.positioning.CornerBit.BOTTOM?a.y-=g.height+(d?d.bottom:0):d&&(a.y+=d.top);if(f&&(h=e?goog.positioning.adjustForViewport_(a,g,e,f):goog.positioning.OverflowStatus.FAILED_OUTSIDE_VIEWPORT,
h&goog.positioning.OverflowStatus.FAILED))return h;goog.style.setPosition(b,a);goog.math.Size.equals(k,g)||goog.style.setBorderBoxSize(b,g);return h};
goog.positioning.adjustForViewport_=function(a,b,c,d){var e=goog.positioning.OverflowStatus.NONE,f=goog.positioning.Overflow.ADJUST_X_EXCEPT_OFFSCREEN,g=goog.positioning.Overflow.ADJUST_Y_EXCEPT_OFFSCREEN;if((d&f)==f&&(a.x<c.left||a.x>=c.right))d&=~goog.positioning.Overflow.ADJUST_X;if((d&g)==g&&(a.y<c.top||a.y>=c.bottom))d&=~goog.positioning.Overflow.ADJUST_Y;a.x<c.left&&d&goog.positioning.Overflow.ADJUST_X&&(a.x=c.left,e|=goog.positioning.OverflowStatus.ADJUSTED_X);a.x<c.left&&(a.x+b.width>c.right&&
d&goog.positioning.Overflow.RESIZE_WIDTH)&&(b.width=Math.max(b.width-(a.x+b.width-c.right),0),e|=goog.positioning.OverflowStatus.WIDTH_ADJUSTED);a.x+b.width>c.right&&d&goog.positioning.Overflow.ADJUST_X&&(a.x=Math.max(c.right-b.width,c.left),e|=goog.positioning.OverflowStatus.ADJUSTED_X);d&goog.positioning.Overflow.FAIL_X&&(e|=(a.x<c.left?goog.positioning.OverflowStatus.FAILED_LEFT:0)|(a.x+b.width>c.right?goog.positioning.OverflowStatus.FAILED_RIGHT:0));a.y<c.top&&d&goog.positioning.Overflow.ADJUST_Y&&
(a.y=c.top,e|=goog.positioning.OverflowStatus.ADJUSTED_Y);a.y<=c.top&&(a.y+b.height<c.bottom&&d&goog.positioning.Overflow.RESIZE_HEIGHT)&&(b.height=Math.max(b.height-(c.top-a.y),0),a.y=0,e|=goog.positioning.OverflowStatus.HEIGHT_ADJUSTED);a.y>=c.top&&(a.y+b.height>c.bottom&&d&goog.positioning.Overflow.RESIZE_HEIGHT)&&(b.height=Math.max(b.height-(a.y+b.height-c.bottom),0),e|=goog.positioning.OverflowStatus.HEIGHT_ADJUSTED);a.y+b.height>c.bottom&&d&goog.positioning.Overflow.ADJUST_Y&&(a.y=Math.max(c.bottom-
b.height,c.top),e|=goog.positioning.OverflowStatus.ADJUSTED_Y);d&goog.positioning.Overflow.FAIL_Y&&(e|=(a.y<c.top?goog.positioning.OverflowStatus.FAILED_TOP:0)|(a.y+b.height>c.bottom?goog.positioning.OverflowStatus.FAILED_BOTTOM:0));return e};goog.positioning.getEffectiveCorner=function(a,b){return(b&goog.positioning.CornerBit.FLIP_RTL&&goog.style.isRightToLeft(a)?b^goog.positioning.CornerBit.RIGHT:b)&~goog.positioning.CornerBit.FLIP_RTL};
goog.positioning.flipCornerHorizontal=function(a){return a^goog.positioning.CornerBit.RIGHT};goog.positioning.flipCornerVertical=function(a){return a^goog.positioning.CornerBit.BOTTOM};goog.positioning.flipCorner=function(a){return a^goog.positioning.CornerBit.BOTTOM^goog.positioning.CornerBit.RIGHT};goog.positioning.AbstractPosition=function(){};goog.positioning.AbstractPosition.prototype.reposition=function(){};goog.positioning.ViewportPosition=function(a,b){this.coordinate=a instanceof goog.math.Coordinate?a:new goog.math.Coordinate(a,b)};goog.inherits(goog.positioning.ViewportPosition,goog.positioning.AbstractPosition);goog.positioning.ViewportPosition.prototype.reposition=function(a,b,c,d){goog.positioning.positionAtAnchor(goog.style.getClientViewportElement(a),goog.positioning.Corner.TOP_LEFT,a,b,this.coordinate,c,null,d)};goog.positioning.AnchoredPosition=function(a,b,c){this.element=a;this.corner=b;this.overflow_=c};goog.inherits(goog.positioning.AnchoredPosition,goog.positioning.AbstractPosition);goog.positioning.AnchoredPosition.prototype.reposition=function(a,b,c){goog.positioning.positionAtAnchor(this.element,this.corner,a,b,void 0,c,this.overflow_)};goog.fx={};goog.fx.Transition=function(){};goog.fx.Transition.EventType={PLAY:"play",BEGIN:"begin",RESUME:"resume",END:"end",STOP:"stop",FINISH:"finish",PAUSE:"pause"};goog.ui.PopupBase=function(a,b){goog.events.EventTarget.call(this);this.handler_=new goog.events.EventHandler(this);this.setElement(a||null);b&&this.setType(b)};goog.inherits(goog.ui.PopupBase,goog.events.EventTarget);goog.ui.PopupBase.Type={TOGGLE_DISPLAY:"toggle_display",MOVE_OFFSCREEN:"move_offscreen"};goog.ui.PopupBase.prototype.element_=null;goog.ui.PopupBase.prototype.autoHide_=!0;goog.ui.PopupBase.prototype.autoHideRegion_=null;goog.ui.PopupBase.prototype.isVisible_=!1;
goog.ui.PopupBase.prototype.shouldHideAsync_=!1;goog.ui.PopupBase.prototype.lastShowTime_=-1;goog.ui.PopupBase.prototype.lastHideTime_=-1;goog.ui.PopupBase.prototype.hideOnEscape_=!1;goog.ui.PopupBase.prototype.enableCrossIframeDismissal_=!0;goog.ui.PopupBase.prototype.type_=goog.ui.PopupBase.Type.TOGGLE_DISPLAY;goog.ui.PopupBase.EventType={BEFORE_SHOW:"beforeshow",SHOW:"show",BEFORE_HIDE:"beforehide",HIDE:"hide"};goog.ui.PopupBase.DEBOUNCE_DELAY_MS=150;goog.ui.PopupBase.prototype.getType=function(){return this.type_};
goog.ui.PopupBase.prototype.setType=function(a){this.type_=a};goog.ui.PopupBase.prototype.shouldHideAsync=function(){return this.shouldHideAsync_};goog.ui.PopupBase.prototype.setShouldHideAsync=function(a){this.shouldHideAsync_=a};goog.ui.PopupBase.prototype.getElement=function(){return this.element_};goog.ui.PopupBase.prototype.setElement=function(a){this.ensureNotVisible_();this.element_=a};goog.ui.PopupBase.prototype.getAutoHide=function(){return this.autoHide_};
goog.ui.PopupBase.prototype.setAutoHide=function(a){this.ensureNotVisible_();this.autoHide_=a};goog.ui.PopupBase.prototype.getHideOnEscape=function(){return this.hideOnEscape_};goog.ui.PopupBase.prototype.setHideOnEscape=function(a){this.ensureNotVisible_();this.hideOnEscape_=a};goog.ui.PopupBase.prototype.getEnableCrossIframeDismissal=function(){return this.enableCrossIframeDismissal_};goog.ui.PopupBase.prototype.setEnableCrossIframeDismissal=function(a){this.enableCrossIframeDismissal_=a};
goog.ui.PopupBase.prototype.getAutoHideRegion=function(){return this.autoHideRegion_};goog.ui.PopupBase.prototype.setAutoHideRegion=function(a){this.autoHideRegion_=a};goog.ui.PopupBase.prototype.setTransition=function(a,b){this.showTransition_=a;this.hideTransition_=b};goog.ui.PopupBase.prototype.getLastShowTime=function(){return this.lastShowTime_};goog.ui.PopupBase.prototype.getLastHideTime=function(){return this.lastHideTime_};goog.ui.PopupBase.prototype.getHandler=function(){return this.handler_};
goog.ui.PopupBase.prototype.ensureNotVisible_=function(){if(this.isVisible_)throw Error("Can not change this state of the popup while showing.");};goog.ui.PopupBase.prototype.isVisible=function(){return this.isVisible_};goog.ui.PopupBase.prototype.isOrWasRecentlyVisible=function(){return this.isVisible_||goog.now()-this.lastHideTime_<goog.ui.PopupBase.DEBOUNCE_DELAY_MS};
goog.ui.PopupBase.prototype.setVisible=function(a){this.showTransition_&&this.showTransition_.stop();this.hideTransition_&&this.hideTransition_.stop();a?this.show_():this.hide_()};goog.ui.PopupBase.prototype.reposition=goog.nullFunction;
goog.ui.PopupBase.prototype.show_=function(){if(!this.isVisible_&&this.onBeforeShow()){if(!this.element_)throw Error("Caller must call setElement before trying to show the popup");this.reposition();var a=goog.dom.getOwnerDocument(this.element_);this.hideOnEscape_&&this.handler_.listen(a,goog.events.EventType.KEYDOWN,this.onDocumentKeyDown_,!0);if(this.autoHide_)if(this.handler_.listen(a,goog.events.EventType.MOUSEDOWN,this.onDocumentMouseDown_,!0),goog.userAgent.IE){var b;try{b=a.activeElement}catch(c){}for(;b&&
"IFRAME"==b.nodeName;){try{var d=goog.dom.getFrameContentDocument(b)}catch(e){break}a=d;b=a.activeElement}this.handler_.listen(a,goog.events.EventType.MOUSEDOWN,this.onDocumentMouseDown_,!0);this.handler_.listen(a,goog.events.EventType.DEACTIVATE,this.onDocumentBlur_)}else this.handler_.listen(a,goog.events.EventType.BLUR,this.onDocumentBlur_);this.type_==goog.ui.PopupBase.Type.TOGGLE_DISPLAY?this.showPopupElement():this.type_==goog.ui.PopupBase.Type.MOVE_OFFSCREEN&&this.reposition();this.isVisible_=
!0;if(this.showTransition_)goog.events.listenOnce(this.showTransition_,goog.fx.Transition.EventType.END,this.onShow_,!1,this),this.showTransition_.play();else this.onShow_()}};
goog.ui.PopupBase.prototype.hide_=function(a){if(!this.isVisible_||!this.onBeforeHide_(a))return!1;this.handler_&&this.handler_.removeAll();this.isVisible_=!1;this.lastHideTime_=goog.now();this.hideTransition_?(goog.events.listenOnce(this.hideTransition_,goog.fx.Transition.EventType.END,goog.partial(this.continueHidingPopup_,a),!1,this),this.hideTransition_.play()):this.continueHidingPopup_(a);return!0};
goog.ui.PopupBase.prototype.continueHidingPopup_=function(a){this.type_==goog.ui.PopupBase.Type.TOGGLE_DISPLAY?this.shouldHideAsync_?goog.Timer.callOnce(this.hidePopupElement_,0,this):this.hidePopupElement_():this.type_==goog.ui.PopupBase.Type.MOVE_OFFSCREEN&&this.moveOffscreen_();this.onHide_(a)};goog.ui.PopupBase.prototype.showPopupElement=function(){this.element_.style.visibility="visible";goog.style.setElementShown(this.element_,!0)};
goog.ui.PopupBase.prototype.hidePopupElement_=function(){this.element_.style.visibility="hidden";goog.style.setElementShown(this.element_,!1)};goog.ui.PopupBase.prototype.moveOffscreen_=function(){this.element_.style.top="-10000px"};goog.ui.PopupBase.prototype.onBeforeShow=function(){return this.dispatchEvent(goog.ui.PopupBase.EventType.BEFORE_SHOW)};goog.ui.PopupBase.prototype.onShow_=function(){this.lastShowTime_=goog.now();this.lastHideTime_=-1;this.dispatchEvent(goog.ui.PopupBase.EventType.SHOW)};
goog.ui.PopupBase.prototype.onBeforeHide_=function(a){return this.dispatchEvent({type:goog.ui.PopupBase.EventType.BEFORE_HIDE,target:a})};goog.ui.PopupBase.prototype.onHide_=function(a){this.dispatchEvent({type:goog.ui.PopupBase.EventType.HIDE,target:a})};goog.ui.PopupBase.prototype.onDocumentMouseDown_=function(a){a=a.target;!goog.dom.contains(this.element_,a)&&((!this.autoHideRegion_||goog.dom.contains(this.autoHideRegion_,a))&&!this.shouldDebounce_())&&this.hide_(a)};
goog.ui.PopupBase.prototype.onDocumentKeyDown_=function(a){a.keyCode==goog.events.KeyCodes.ESC&&this.hide_(a.target)&&(a.preventDefault(),a.stopPropagation())};goog.ui.PopupBase.prototype.onDocumentBlur_=function(a){if(this.enableCrossIframeDismissal_){var b=goog.dom.getOwnerDocument(this.element_);if(goog.userAgent.IE||goog.userAgent.OPERA){if(a=b.activeElement,!a||goog.dom.contains(this.element_,a)||"BODY"==a.tagName)return}else if(a.target!=b)return;this.shouldDebounce_()||this.hide_()}};
goog.ui.PopupBase.prototype.shouldDebounce_=function(){return goog.now()-this.lastShowTime_<goog.ui.PopupBase.DEBOUNCE_DELAY_MS};goog.ui.PopupBase.prototype.disposeInternal=function(){goog.ui.PopupBase.superClass_.disposeInternal.call(this);this.handler_.dispose();goog.dispose(this.showTransition_);goog.dispose(this.hideTransition_);delete this.element_;delete this.handler_};goog.positioning.ClientPosition=function(a,b){this.coordinate=a instanceof goog.math.Coordinate?a:new goog.math.Coordinate(a,b)};goog.inherits(goog.positioning.ClientPosition,goog.positioning.AbstractPosition);
goog.positioning.ClientPosition.prototype.reposition=function(a,b,c,d){goog.asserts.assert(a);var e=goog.style.getViewportPageOffset(goog.dom.getOwnerDocument(a)),f=this.coordinate.x+e.x,e=this.coordinate.y+e.y,g=goog.positioning.getOffsetParentPageOffset(a),f=f-g.x,e=e-g.y;goog.positioning.positionAtCoordinate(new goog.math.Coordinate(f,e),a,b,c,null,null,d)};goog.positioning.ViewportClientPosition=function(a,b){goog.positioning.ClientPosition.call(this,a,b)};goog.inherits(goog.positioning.ViewportClientPosition,goog.positioning.ClientPosition);goog.positioning.ViewportClientPosition.prototype.lastResortOverflow_=0;goog.positioning.ViewportClientPosition.prototype.setLastResortOverflow=function(a){this.lastResortOverflow_=a};
goog.positioning.ViewportClientPosition.prototype.reposition=function(a,b,c,d){var e=goog.style.getClientViewportElement(a),e=goog.style.getVisibleRectForElement(e),f=goog.dom.getDomHelper(a).getDocumentScrollElement(),f=new goog.math.Coordinate(this.coordinate.x+f.scrollLeft,this.coordinate.y+f.scrollTop),g=goog.positioning.Overflow.FAIL_X|goog.positioning.Overflow.FAIL_Y,h=b,k=goog.positioning.positionAtCoordinate(f,a,h,c,e,g,d);if(0!=(k&goog.positioning.OverflowStatus.FAILED)){if(k&goog.positioning.OverflowStatus.FAILED_LEFT||
k&goog.positioning.OverflowStatus.FAILED_RIGHT)h=goog.positioning.flipCornerHorizontal(h);if(k&goog.positioning.OverflowStatus.FAILED_TOP||k&goog.positioning.OverflowStatus.FAILED_BOTTOM)h=goog.positioning.flipCornerVertical(h);k=goog.positioning.positionAtCoordinate(f,a,h,c,e,g,d);0!=(k&goog.positioning.OverflowStatus.FAILED)&&goog.positioning.positionAtCoordinate(f,a,b,c,e,this.lastResortOverflow_,d)}};goog.positioning.AbsolutePosition=function(a,b){this.coordinate=a instanceof goog.math.Coordinate?a:new goog.math.Coordinate(a,b)};goog.inherits(goog.positioning.AbsolutePosition,goog.positioning.AbstractPosition);goog.positioning.AbsolutePosition.prototype.reposition=function(a,b,c,d){goog.positioning.positionAtCoordinate(this.coordinate,a,b,c,null,null,d)};goog.positioning.AnchoredViewportPosition=function(a,b,c,d){goog.positioning.AnchoredPosition.call(this,a,b);this.lastResortOverflow_=c?goog.positioning.Overflow.ADJUST_X|goog.positioning.Overflow.ADJUST_Y:goog.positioning.Overflow.IGNORE;this.overflowConstraint_=d||void 0};goog.inherits(goog.positioning.AnchoredViewportPosition,goog.positioning.AnchoredPosition);goog.positioning.AnchoredViewportPosition.prototype.getLastResortOverflow=function(){return this.lastResortOverflow_};
goog.positioning.AnchoredViewportPosition.prototype.setLastResortOverflow=function(a){this.lastResortOverflow_=a};
goog.positioning.AnchoredViewportPosition.prototype.reposition=function(a,b,c,d){var e=goog.positioning.positionAtAnchor(this.element,this.corner,a,b,null,c,goog.positioning.Overflow.FAIL_X|goog.positioning.Overflow.FAIL_Y,d,this.overflowConstraint_);if(e&goog.positioning.OverflowStatus.FAILED){var f=this.adjustCorner(e,this.corner);b=this.adjustCorner(e,b);e=goog.positioning.positionAtAnchor(this.element,f,a,b,null,c,goog.positioning.Overflow.FAIL_X|goog.positioning.Overflow.FAIL_Y,d,this.overflowConstraint_);
e&goog.positioning.OverflowStatus.FAILED&&(f=this.adjustCorner(e,f),b=this.adjustCorner(e,b),goog.positioning.positionAtAnchor(this.element,f,a,b,null,c,this.getLastResortOverflow(),d,this.overflowConstraint_))}};goog.positioning.AnchoredViewportPosition.prototype.adjustCorner=function(a,b){a&goog.positioning.OverflowStatus.FAILED_HORIZONTAL&&(b=goog.positioning.flipCornerHorizontal(b));a&goog.positioning.OverflowStatus.FAILED_VERTICAL&&(b=goog.positioning.flipCornerVertical(b));return b};goog.ui.Popup=function(a,b){this.popupCorner_=goog.positioning.Corner.TOP_START;this.position_=b||void 0;goog.ui.PopupBase.call(this,a)};goog.inherits(goog.ui.Popup,goog.ui.PopupBase);goog.ui.Popup.Corner=goog.positioning.Corner;goog.ui.Popup.Overflow=goog.positioning.Overflow;goog.ui.Popup.prototype.getPinnedCorner=function(){return this.popupCorner_};goog.ui.Popup.prototype.setPinnedCorner=function(a){this.popupCorner_=a;this.isVisible()&&this.reposition()};
goog.ui.Popup.prototype.getPosition=function(){return this.position_||null};goog.ui.Popup.prototype.setPosition=function(a){this.position_=a||void 0;this.isVisible()&&this.reposition()};goog.ui.Popup.prototype.getMargin=function(){return this.margin_||null};goog.ui.Popup.prototype.setMargin=function(a,b,c,d){this.margin_=null==a||a instanceof goog.math.Box?a:new goog.math.Box(a,b,c,d);this.isVisible()&&this.reposition()};
goog.ui.Popup.prototype.reposition=function(){if(this.position_){var a=!this.isVisible()&&this.getType()!=goog.ui.PopupBase.Type.MOVE_OFFSCREEN,b=this.getElement();a&&(b.style.visibility="hidden",goog.style.setElementShown(b,!0));this.position_.reposition(b,this.popupCorner_,this.margin_);a&&goog.style.setElementShown(b,!1)}};goog.ui.Popup.AnchoredPosition=goog.positioning.AnchoredPosition;goog.ui.Popup.AnchoredViewPortPosition=goog.positioning.AnchoredViewportPosition;
goog.ui.Popup.AbsolutePosition=goog.positioning.AbsolutePosition;goog.ui.Popup.ViewPortPosition=goog.positioning.ViewportPosition;goog.ui.Popup.ClientPosition=goog.positioning.ClientPosition;goog.ui.Popup.ViewPortClientPosition=goog.positioning.ViewportClientPosition;goog.structs.Collection=function(){};goog.structs.Set=function(a){this.map_=new goog.structs.Map;a&&this.addAll(a)};goog.structs.Set.getKey_=function(a){var b=typeof a;return"object"==b&&a||"function"==b?"o"+goog.getUid(a):b.substr(0,1)+a};goog.structs.Set.prototype.getCount=function(){return this.map_.getCount()};goog.structs.Set.prototype.add=function(a){this.map_.set(goog.structs.Set.getKey_(a),a)};goog.structs.Set.prototype.addAll=function(a){a=goog.structs.getValues(a);for(var b=a.length,c=0;c<b;c++)this.add(a[c])};
goog.structs.Set.prototype.removeAll=function(a){a=goog.structs.getValues(a);for(var b=a.length,c=0;c<b;c++)this.remove(a[c])};goog.structs.Set.prototype.remove=function(a){return this.map_.remove(goog.structs.Set.getKey_(a))};goog.structs.Set.prototype.clear=function(){this.map_.clear()};goog.structs.Set.prototype.isEmpty=function(){return this.map_.isEmpty()};goog.structs.Set.prototype.contains=function(a){return this.map_.containsKey(goog.structs.Set.getKey_(a))};
goog.structs.Set.prototype.containsAll=function(a){return goog.structs.every(a,this.contains,this)};goog.structs.Set.prototype.intersection=function(a){var b=new goog.structs.Set;a=goog.structs.getValues(a);for(var c=0;c<a.length;c++){var d=a[c];this.contains(d)&&b.add(d)}return b};goog.structs.Set.prototype.difference=function(a){var b=this.clone();b.removeAll(a);return b};goog.structs.Set.prototype.getValues=function(){return this.map_.getValues()};goog.structs.Set.prototype.clone=function(){return new goog.structs.Set(this)};
goog.structs.Set.prototype.equals=function(a){return this.getCount()==goog.structs.getCount(a)&&this.isSubsetOf(a)};goog.structs.Set.prototype.isSubsetOf=function(a){var b=goog.structs.getCount(a);if(this.getCount()>b)return!1;!(a instanceof goog.structs.Set)&&5<b&&(a=new goog.structs.Set(a));return goog.structs.every(this,function(b){return goog.structs.contains(a,b)})};goog.structs.Set.prototype.__iterator__=function(){return this.map_.__iterator__(!1)};goog.ui.Tooltip=function(a,b,c){this.dom_=c||(a?goog.dom.getDomHelper(goog.dom.getElement(a)):goog.dom.getDomHelper());goog.ui.Popup.call(this,this.dom_.createDom("div",{style:"position:absolute;display:none;"}));this.cursorPosition=new goog.math.Coordinate(1,1);this.elements_=new goog.structs.Set;a&&this.attach(a);null!=b&&this.setText(b)};goog.inherits(goog.ui.Tooltip,goog.ui.Popup);goog.ui.Tooltip.activeInstances_=[];goog.ui.Tooltip.prototype.activeEl_=null;
goog.ui.Tooltip.prototype.className="goog-tooltip";goog.ui.Tooltip.prototype.showDelayMs_=500;goog.ui.Tooltip.prototype.hideDelayMs_=0;goog.ui.Tooltip.State={INACTIVE:0,WAITING_TO_SHOW:1,SHOWING:2,WAITING_TO_HIDE:3,UPDATING:4};goog.ui.Tooltip.Activation={CURSOR:0,FOCUS:1};goog.ui.Tooltip.prototype.getDomHelper=function(){return this.dom_};goog.ui.Tooltip.prototype.getChildTooltip=function(){return this.childTooltip_};
goog.ui.Tooltip.prototype.attach=function(a){a=goog.dom.getElement(a);this.elements_.add(a);goog.events.listen(a,goog.events.EventType.MOUSEOVER,this.handleMouseOver,!1,this);goog.events.listen(a,goog.events.EventType.MOUSEOUT,this.handleMouseOutAndBlur,!1,this);goog.events.listen(a,goog.events.EventType.MOUSEMOVE,this.handleMouseMove,!1,this);goog.events.listen(a,goog.events.EventType.FOCUS,this.handleFocus,!1,this);goog.events.listen(a,goog.events.EventType.BLUR,this.handleMouseOutAndBlur,!1,this)};
goog.ui.Tooltip.prototype.detach=function(a){if(a)a=goog.dom.getElement(a),this.detachElement_(a),this.elements_.remove(a);else{for(var b=this.elements_.getValues(),c=0;a=b[c];c++)this.detachElement_(a);this.elements_.clear()}};
goog.ui.Tooltip.prototype.detachElement_=function(a){goog.events.unlisten(a,goog.events.EventType.MOUSEOVER,this.handleMouseOver,!1,this);goog.events.unlisten(a,goog.events.EventType.MOUSEOUT,this.handleMouseOutAndBlur,!1,this);goog.events.unlisten(a,goog.events.EventType.MOUSEMOVE,this.handleMouseMove,!1,this);goog.events.unlisten(a,goog.events.EventType.FOCUS,this.handleFocus,!1,this);goog.events.unlisten(a,goog.events.EventType.BLUR,this.handleMouseOutAndBlur,!1,this)};
goog.ui.Tooltip.prototype.setShowDelayMs=function(a){this.showDelayMs_=a};goog.ui.Tooltip.prototype.getShowDelayMs=function(){return this.showDelayMs_};goog.ui.Tooltip.prototype.setHideDelayMs=function(a){this.hideDelayMs_=a};goog.ui.Tooltip.prototype.getHideDelayMs=function(){return this.hideDelayMs_};goog.ui.Tooltip.prototype.setText=function(a){goog.dom.setTextContent(this.getElement(),a)};goog.ui.Tooltip.prototype.setHtml=function(a){this.getElement().innerHTML=a};
goog.ui.Tooltip.prototype.setElement=function(a){var b=this.getElement();b&&goog.dom.removeNode(b);goog.ui.Tooltip.superClass_.setElement.call(this,a);a&&(b=this.dom_.getDocument().body,b.insertBefore(a,b.lastChild))};goog.ui.Tooltip.prototype.getText=function(){return goog.dom.getTextContent(this.getElement())};goog.ui.Tooltip.prototype.getHtml=function(){return this.getElement().innerHTML};
goog.ui.Tooltip.prototype.getState=function(){return this.showTimer?this.isVisible()?goog.ui.Tooltip.State.UPDATING:goog.ui.Tooltip.State.WAITING_TO_SHOW:this.hideTimer?goog.ui.Tooltip.State.WAITING_TO_HIDE:this.isVisible()?goog.ui.Tooltip.State.SHOWING:goog.ui.Tooltip.State.INACTIVE};goog.ui.Tooltip.prototype.setRequireInteraction=function(a){this.requireInteraction_=a};
goog.ui.Tooltip.prototype.isCoordinateInTooltip=function(a){if(!this.isVisible())return!1;var b=goog.style.getPageOffset(this.getElement()),c=goog.style.getSize(this.getElement());return b.x<=a.x&&a.x<=b.x+c.width&&b.y<=a.y&&a.y<=b.y+c.height};
goog.ui.Tooltip.prototype.onBeforeShow=function(){if(!goog.ui.PopupBase.prototype.onBeforeShow.call(this))return!1;if(this.anchor)for(var a,b=0;a=goog.ui.Tooltip.activeInstances_[b];b++)goog.dom.contains(a.getElement(),this.anchor)||a.setVisible(!1);goog.array.insert(goog.ui.Tooltip.activeInstances_,this);a=this.getElement();a.className=this.className;this.clearHideTimer();goog.events.listen(a,goog.events.EventType.MOUSEOVER,this.handleTooltipMouseOver,!1,this);goog.events.listen(a,goog.events.EventType.MOUSEOUT,
this.handleTooltipMouseOut,!1,this);this.clearShowTimer();return!0};
goog.ui.Tooltip.prototype.onHide_=function(){goog.array.remove(goog.ui.Tooltip.activeInstances_,this);for(var a=this.getElement(),b,c=0;b=goog.ui.Tooltip.activeInstances_[c];c++)b.anchor&&goog.dom.contains(a,b.anchor)&&b.setVisible(!1);this.parentTooltip_&&this.parentTooltip_.startHideTimer();goog.events.unlisten(a,goog.events.EventType.MOUSEOVER,this.handleTooltipMouseOver,!1,this);goog.events.unlisten(a,goog.events.EventType.MOUSEOUT,this.handleTooltipMouseOut,!1,this);this.anchor=void 0;this.getState()==
goog.ui.Tooltip.State.INACTIVE&&(this.seenInteraction_=!1);goog.ui.PopupBase.prototype.onHide_.call(this)};goog.ui.Tooltip.prototype.maybeShow=function(a,b){this.anchor==a&&this.elements_.contains(this.anchor)&&(this.seenInteraction_||!this.requireInteraction_?(this.setVisible(!1),this.isVisible()||this.positionAndShow_(a,b)):this.anchor=void 0);this.showTimer=void 0};goog.ui.Tooltip.prototype.getElements=function(){return this.elements_};goog.ui.Tooltip.prototype.getActiveElement=function(){return this.activeEl_};
goog.ui.Tooltip.prototype.setActiveElement=function(a){this.activeEl_=a};goog.ui.Tooltip.prototype.showForElement=function(a,b){this.attach(a);this.activeEl_=a;this.positionAndShow_(a,b)};goog.ui.Tooltip.prototype.positionAndShow_=function(a,b){this.anchor=a;this.setPosition(b||this.getPositioningStrategy(goog.ui.Tooltip.Activation.CURSOR));this.setVisible(!0)};
goog.ui.Tooltip.prototype.maybeHide=function(a){this.hideTimer=void 0;a==this.anchor&&(null==this.activeEl_||this.activeEl_!=this.getElement()&&!this.elements_.contains(this.activeEl_))&&!this.hasActiveChild()&&this.setVisible(!1)};goog.ui.Tooltip.prototype.hasActiveChild=function(){return!(!this.childTooltip_||!this.childTooltip_.activeEl_)};
goog.ui.Tooltip.prototype.saveCursorPosition_=function(a){var b=this.dom_.getDocumentScroll();this.cursorPosition.x=a.clientX+b.x;this.cursorPosition.y=a.clientY+b.y};goog.ui.Tooltip.prototype.handleMouseOver=function(a){var b=this.getAnchorFromElement(a.target);this.activeEl_=b;this.clearHideTimer();b!=this.anchor&&(this.anchor=b,this.startShowTimer(b),this.checkForParentTooltip_(),this.saveCursorPosition_(a))};
goog.ui.Tooltip.prototype.getAnchorFromElement=function(a){try{for(;a&&!this.elements_.contains(a);)a=a.parentNode;return a}catch(b){return null}};goog.ui.Tooltip.prototype.handleMouseMove=function(a){this.saveCursorPosition_(a);this.seenInteraction_=!0};
goog.ui.Tooltip.prototype.handleFocus=function(a){this.activeEl_=a=this.getAnchorFromElement(a.target);this.seenInteraction_=!0;if(this.anchor!=a){this.anchor=a;var b=this.getPositioningStrategy(goog.ui.Tooltip.Activation.FOCUS);this.clearHideTimer();this.startShowTimer(a,b);this.checkForParentTooltip_()}};goog.ui.Tooltip.prototype.getPositioningStrategy=function(a){return a==goog.ui.Tooltip.Activation.CURSOR?(a=this.cursorPosition.clone(),new goog.ui.Tooltip.CursorTooltipPosition(a)):new goog.ui.Tooltip.ElementTooltipPosition(this.activeEl_)};
goog.ui.Tooltip.prototype.checkForParentTooltip_=function(){if(this.anchor)for(var a,b=0;a=goog.ui.Tooltip.activeInstances_[b];b++)goog.dom.contains(a.getElement(),this.anchor)&&(a.childTooltip_=this,this.parentTooltip_=a)};
goog.ui.Tooltip.prototype.handleMouseOutAndBlur=function(a){var b=this.getAnchorFromElement(a.target),c=this.getAnchorFromElement(a.relatedTarget);b!=c&&(b==this.activeEl_&&(this.activeEl_=null),this.clearShowTimer(),this.seenInteraction_=!1,this.isVisible()&&(!a.relatedTarget||!goog.dom.contains(this.getElement(),a.relatedTarget))?this.startHideTimer():this.anchor=void 0)};
goog.ui.Tooltip.prototype.handleTooltipMouseOver=function(){var a=this.getElement();this.activeEl_!=a&&(this.clearHideTimer(),this.activeEl_=a)};goog.ui.Tooltip.prototype.handleTooltipMouseOut=function(a){var b=this.getElement();if(this.activeEl_==b&&(!a.relatedTarget||!goog.dom.contains(b,a.relatedTarget)))this.activeEl_=null,this.startHideTimer()};goog.ui.Tooltip.prototype.startShowTimer=function(a,b){this.showTimer||(this.showTimer=goog.Timer.callOnce(goog.bind(this.maybeShow,this,a,b),this.showDelayMs_))};
goog.ui.Tooltip.prototype.clearShowTimer=function(){this.showTimer&&(goog.Timer.clear(this.showTimer),this.showTimer=void 0)};goog.ui.Tooltip.prototype.startHideTimer=function(){this.getState()==goog.ui.Tooltip.State.SHOWING&&(this.hideTimer=goog.Timer.callOnce(goog.bind(this.maybeHide,this,this.anchor),this.getHideDelayMs()))};goog.ui.Tooltip.prototype.clearHideTimer=function(){this.hideTimer&&(goog.Timer.clear(this.hideTimer),this.hideTimer=void 0)};
goog.ui.Tooltip.prototype.disposeInternal=function(){this.setVisible(!1);this.clearShowTimer();this.detach();this.getElement()&&goog.dom.removeNode(this.getElement());this.activeEl_=null;delete this.dom_;goog.ui.Tooltip.superClass_.disposeInternal.call(this)};goog.ui.Tooltip.CursorTooltipPosition=function(a,b){goog.positioning.ViewportPosition.call(this,a,b)};goog.inherits(goog.ui.Tooltip.CursorTooltipPosition,goog.positioning.ViewportPosition);
goog.ui.Tooltip.CursorTooltipPosition.prototype.reposition=function(a,b,c){b=goog.style.getClientViewportElement(a);b=goog.style.getVisibleRectForElement(b);c=c?new goog.math.Box(c.top+10,c.right,c.bottom,c.left+10):new goog.math.Box(10,0,0,10);goog.positioning.positionAtCoordinate(this.coordinate,a,goog.positioning.Corner.TOP_START,c,b,goog.positioning.Overflow.ADJUST_X|goog.positioning.Overflow.FAIL_Y)&goog.positioning.OverflowStatus.FAILED&&goog.positioning.positionAtCoordinate(this.coordinate,
a,goog.positioning.Corner.TOP_START,c,b,goog.positioning.Overflow.ADJUST_X|goog.positioning.Overflow.ADJUST_Y)};goog.ui.Tooltip.ElementTooltipPosition=function(a){goog.positioning.AnchoredPosition.call(this,a,goog.positioning.Corner.BOTTOM_RIGHT)};goog.inherits(goog.ui.Tooltip.ElementTooltipPosition,goog.positioning.AnchoredPosition);
goog.ui.Tooltip.ElementTooltipPosition.prototype.reposition=function(a,b,c){var d=new goog.math.Coordinate(10,0);goog.positioning.positionAtAnchor(this.element,this.corner,a,b,d,c,goog.positioning.Overflow.ADJUST_X|goog.positioning.Overflow.FAIL_Y)&goog.positioning.OverflowStatus.FAILED&&goog.positioning.positionAtAnchor(this.element,goog.positioning.Corner.TOP_RIGHT,a,goog.positioning.Corner.BOTTOM_LEFT,d,c,goog.positioning.Overflow.ADJUST_X|goog.positioning.Overflow.ADJUST_Y)};X.caption=function(a,b,c,d){if(!goog.isDefAndNotNull(a))throw Error("No valid parent element.");if(!goog.isNumber(b)||!goog.isNumber(c))throw Error("Invalid coordinates.");if(!goog.isDefAndNotNull(d)||!(d instanceof X.interactor))throw Error("Invalid interactor.");goog.ui.Tooltip.call(this);this._classname="caption";this._parent=a;this._x=b;this._y=c;this._interactor=d;this._style=null;this._css=[];a=".x-tooltip {\n  background: #C0C0FF;\n  color: #000000;\n";a+="  border: 1px solid infotext;\n";
a+="  padding: 1px;\n";a+="  font-family: sans-serif;\n";a+="}";this._css=[a];goog.events.listenOnce(d,X.event.events.HOVER_END,this.kill.bind(this));this.init_()};goog.inherits(X.caption,goog.ui.Tooltip);
X.caption.prototype.init_=function(){var a=goog.style.getComputedStyle(this._parent,"position");if("static"==a||""==a)this._parent.style.position="relative";var a=goog.dom.getDocument().getElementsByTagName("head")[0],b=goog.dom.createDom("style");b.type="text/css";b.media="screen";var c=goog.dom.createTextNode(this._css[0]);goog.dom.appendChild(a,b);goog.dom.appendChild(b,c);this._style=b;this.setPosition(new goog.positioning.ViewportPosition(this._x,this._y));this.setVisible(!0);this.attach(this._parent);
this.getElement().classList.add("x-tooltip")};X.caption.prototype.kill=function(){this.setVisible(!1);this._style&&goog.dom.removeNode(this._style);this.getElement()&&goog.dom.removeNode(this.getElement());this._style=null};X.renderer3D=function(){X.renderer.call(this);this._classname="renderer3D";this._maxZ=this._minZ=this._maxY=this._minY=this._maxX=this._minX=this._shaderProgram=this._shaders=null;this._center=[0,0,0];this._bgColor=[0,0,0];this._pickFrameBuffer=null;this._attributePointers=new goog.structs.Map;this._uniformLocations=new goog.structs.Map;this._vertexBuffers=new goog.structs.Map;this._normalBuffers=new goog.structs.Map;this._colorBuffers=new goog.structs.Map;this._scalarBuffers=new goog.structs.Map;
this._texturePositionBuffers=new goog.structs.Map;this._textures=new goog.structs.Map;this._config={PROGRESSBAR_ENABLED:!0,PICKING_ENABLED:!0,ORDERING_ENABLED:!0,STATISTICS_ENABLED:!1,INTERMEDIATE_RENDERING:!1}};goog.inherits(X.renderer3D,X.renderer);X.renderer3D.prototype.__defineGetter__("config",function(){return this._config});X.renderer3D.prototype.resetBoundingBox=function(){this._maxZ=this._minZ=this._maxY=this._minY=this._maxX=this._minX=null;this._center=[0,0,0]};
X.renderer3D.prototype.onHover_=function(a){X.renderer3D.superClass_.onHover_.call(this,a);this.showCaption_(a._x,a._y)};
X.renderer3D.prototype.init=function(){X.renderer3D.superClass_.init.call(this,"experimental-webgl");try{if(this._context.viewport(0,0,this._width,this._height),this._context.clearColor(this._bgColor[0],this._bgColor[1],this._bgColor[2],0),this._context.enable(this._context.BLEND),this._context.blendEquation(this._context.FUNC_ADD),this._context.blendFunc(this._context.SRC_ALPHA,this._context.ONE_MINUS_SRC_ALPHA),this._context.enable(this._context.DEPTH_TEST),this._context.depthFunc(this._context.LEQUAL),
this._context.clear(this._context.COLOR_BUFFER_BIT|this._context.DEPTH_BUFFER_BIT),this._config.PICKING_ENABLED){var a=this._context.createFramebuffer(),b=this._context.createRenderbuffer(),c=this._context.createTexture();this._context.bindTexture(this._context.TEXTURE_2D,c);this._context.texImage2D(this._context.TEXTURE_2D,0,this._context.RGB,this._width,this._height,0,this._context.RGB,this._context.UNSIGNED_BYTE,null);this._context.texParameteri(this._context.TEXTURE_2D,this._context.TEXTURE_WRAP_S,
this._context.CLAMP_TO_EDGE);this._context.texParameteri(this._context.TEXTURE_2D,this._context.TEXTURE_WRAP_T,this._context.CLAMP_TO_EDGE);this._context.texParameteri(this._context.TEXTURE_2D,this._context.TEXTURE_MAG_FILTER,this._context.NEAREST);this._context.texParameteri(this._context.TEXTURE_2D,this._context.TEXTURE_MIN_FILTER,this._context.NEAREST);this._context.bindFramebuffer(this._context.FRAMEBUFFER,a);this._context.bindRenderbuffer(this._context.RENDERBUFFER,b);this._context.renderbufferStorage(this._context.RENDERBUFFER,
this._context.DEPTH_COMPONENT16,this._width,this._height);this._context.bindRenderbuffer(this._context.RENDERBUFFER,null);this._context.framebufferTexture2D(this._context.FRAMEBUFFER,this._context.COLOR_ATTACHMENT0,this._context.TEXTURE_2D,c,0);this._context.framebufferRenderbuffer(this._context.FRAMEBUFFER,this._context.DEPTH_ATTACHMENT,this._context.RENDERBUFFER,b);this._context.bindFramebuffer(this._context.FRAMEBUFFER,null);this._pickFrameBuffer=a}}catch(d){throw Error("Exception while accessing GL Context!\n"+
d);}a=new X.shaders;this.addShaders(a)};
X.renderer3D.prototype.addShaders=function(a){if(!goog.isDefAndNotNull(this._canvas)||!goog.isDefAndNotNull(this._context)||!goog.isDefAndNotNull(this._camera))throw Error("Renderer was not initialized properly.");if(!goog.isDefAndNotNull(a)||!(a instanceof X.shaders))throw Error("Could not add shaders.");a.validate();var b=this._context.createShader(this._context.FRAGMENT_SHADER),c=this._context.createShader(this._context.VERTEX_SHADER);this._context.shaderSource(b,a.fragment());this._context.shaderSource(c,
a.vertex());this._context.compileShader(b);this._context.compileShader(c);if(!this._context.getShaderParameter(b,this._context.COMPILE_STATUS))throw Error("Fragement Shader compilation failed!\n"+this._context.getShaderInfoLog(b));if(!this._context.getShaderParameter(c,this._context.COMPILE_STATUS))throw Error("Vertex Shader compilation failed!\n"+this._context.getShaderInfoLog(c));var d=this._context.createProgram();this._context.attachShader(d,c);this._context.attachShader(d,b);this._context.linkProgram(d);
if(!this._context.getProgramParameter(d,this._context.LINK_STATUS))throw Error("Could not create shader program!\n"+this._context.getShaderInfoLog(b)+"\n"+this._context.getShaderInfoLog(c)+"\n"+this._context.getProgramInfoLog(d));this._context.useProgram(d);this._shaderProgram=d;Object.keys(X.shaders.attributes).forEach(function(a){a=X.shaders.attributes[a];this._attributePointers.set(a,this._context.getAttribLocation(this._shaderProgram,a));this._context.enableVertexAttribArray(this._attributePointers.get(a))}.bind(this));
Object.keys(X.shaders.uniforms).forEach(function(a){a=X.shaders.uniforms[a];this._uniformLocations.set(a,this._context.getUniformLocation(this._shaderProgram,a))}.bind(this));this._shaders=a};
X.renderer3D.prototype.update_=function(a){X.renderer3D.superClass_.update_.call(this,a);var b=!1;if(goog.isDefAndNotNull(a)){this.get(a._id)&&(b=!0);var c=a._id,d=a._points,e=a._normals,f=a._colors,g=a._texture,h=a._file,k=a._transform,j=a._colortable,m=a._labelmap,l=a._scalars;if(goog.isDefAndNotNull(m)&&goog.isDefAndNotNull(m._file)&&m._file._dirty)this.update_(m);else if(goog.isDefAndNotNull(m)&&m._dirty&&this.update_(m),goog.isDefAndNotNull(j)&&goog.isDefAndNotNull(j._file)&&j._file._dirty)this._loader.load(j,
a);else if(goog.isDefAndNotNull(g)&&goog.isDefAndNotNull(g._file)&&g._file._dirty)this._loader.load(g,a);else{if(goog.isDefAndNotNull(h)&&goog.isArray(h))if(goog.isDefAndNotNull(a.MRI)){if(a.MRI.loaded_files!=h.length||!a._dirty)return}else{b=0;c=h.length;for(b=0;b<c;b++)this._loader.load(h[b],a);return}else{if(goog.isDefAndNotNull(h)&&h._dirty){this._loader.load(a,a);return}if(goog.isDefAndNotNull(l)&&goog.isDefAndNotNull(l._file)&&l._file._dirty){this._loader.load(l,a);return}}if(0<a._children.length){h=
a._children;j=h.length;for(m=m=0;m<j;m++)this.update_(h[m])}if(d){for(h=0;this._locked;)h++,window.console.log("Possible thread lock avoided: "+h);this._locked=!0;j=a instanceof X.slice&&a._volume instanceof X.labelmap;b&&(goog.isDefAndNotNull(g)&&g._dirty)&&(h=this._texturePositionBuffers.get(c),goog.isDefAndNotNull(h)&&this._context.isBuffer(h._glBuffer)&&this._context.deleteBuffer(h._glBuffer));h=null;if(goog.isDefAndNotNull(g))if(!b||g._dirty){h=a._textureCoordinateMap;if(!goog.isDefAndNotNull(h))throw Error("Can not add an object and texture without valid coordinate mapping! Set the textureCoordinateMap!");
m=!1;g._rawData&&(m=!0);this._context.pixelStorei(this._context.UNPACK_FLIP_Y_WEBGL,m);m=this._context.createTexture();m.image=g._image;this._textures.set(g._id,m);this._context.bindTexture(this._context.TEXTURE_2D,m);g._rawData?(m=this._context.RGBA,g._grayscale&&(m=this._context.LUMINANCE,this._context.pixelStorei(this._context.UNPACK_ALIGNMENT,1)),this._context.texImage2D(this._context.TEXTURE_2D,0,m,g._rawDataWidth,g._rawDataHeight,0,m,this._context.UNSIGNED_BYTE,g._rawData)):this._context.texImage2D(this._context.TEXTURE_2D,
0,this._context.RGBA,this._context.RGBA,this._context.UNSIGNED_BYTE,m.image);this._context.texParameteri(this._context.TEXTURE_2D,this._context.TEXTURE_WRAP_S,this._context.CLAMP_TO_EDGE);this._context.texParameteri(this._context.TEXTURE_2D,this._context.TEXTURE_WRAP_T,this._context.CLAMP_TO_EDGE);j?(this._context.texParameteri(this._context.TEXTURE_2D,this._context.TEXTURE_MAG_FILTER,this._context.NEAREST),this._context.texParameteri(this._context.TEXTURE_2D,this._context.TEXTURE_MIN_FILTER,this._context.NEAREST)):
(this._context.texParameteri(this._context.TEXTURE_2D,this._context.TEXTURE_MAG_FILTER,this._context.LINEAR),this._context.texParameteri(this._context.TEXTURE_2D,this._context.TEXTURE_MIN_FILTER,this._context.LINEAR));this._context.bindTexture(this._context.TEXTURE_2D,null);m=this._context.createBuffer();this._context.bindBuffer(this._context.ARRAY_BUFFER,m);this._context.bufferData(this._context.ARRAY_BUFFER,new Float32Array(h),this._context.STATIC_DRAW);h=new X.buffer(m,h.length,2);this._texturePositionBuffers.set(c,
h);g._dirty=!1}else h=this._texturePositionBuffers.get(c);this._loader.addProgress(0.1);if(j)this._locked=!1,X.TIMERSTOP(this._classname+".update"),this._loader.addProgress(0.9);else{if(!b||d._dirty||k._dirty){j=k._matrix;g=X.matrix.multiplyByVector(j,d._minA,d._minB,d._minC);j=X.matrix.multiplyByVector(j,d._maxA,d._maxB,d._maxC);if(goog.isNull(this._minX)||g.x<this._minX)this._minX=g.x;if(goog.isNull(this._maxX)||j.x>this._maxX)this._maxX=j.x;if(goog.isNull(this._minY)||g.y<this._minY)this._minY=
g.y;if(goog.isNull(this._maxY)||j.y>this._maxY)this._maxY=j.y;if(goog.isNull(this._minZ)||g.z<this._minZ)this._minZ=g.z;if(goog.isNull(this._maxZ)||j.z>this._maxZ)this._maxZ=j.z;this._center=[(this._minX+this._maxX)/2,(this._minY+this._maxY)/2,(this._minZ+this._maxZ)/2];k._dirty=!1}b&&d._dirty&&(k=this._vertexBuffers.get(c),goog.isDefAndNotNull(k)&&this._context.isBuffer(k._glBuffer)&&this._context.deleteBuffer(k._glBuffer));k=null;!b||d._dirty?(k=this._context.createBuffer(),d.resize(),this._context.bindBuffer(this._context.ARRAY_BUFFER,
k),this._context.bufferData(this._context.ARRAY_BUFFER,d._triplets,this._context.STATIC_DRAW),k=new X.buffer(k,d.count,3),d._dirty=!1):k=this._vertexBuffers.get(c);this._loader.addProgress(0.3);b&&e._dirty&&(g=this._vertexBuffers.get(c),goog.isDefAndNotNull(g)&&this._context.isBuffer(g._glBuffer)&&this._context.deleteBuffer(g._glBuffer));g=null;!b||e._dirty?(g=this._context.createBuffer(),e.resize(),this._context.bindBuffer(this._context.ARRAY_BUFFER,g),this._context.bufferData(this._context.ARRAY_BUFFER,
e._triplets,this._context.STATIC_DRAW),g=new X.buffer(g,e.count,3),e._dirty=!1):g=this._normalBuffers.get(c);this._loader.addProgress(0.3);b&&(f&&f._dirty)&&(e=this._colorBuffers.get(c),goog.isDefAndNotNull(e)&&this._context.isBuffer(e._glBuffer)&&this._context.deleteBuffer(e._glBuffer));e=null;if(f)if(!b||f._dirty){if(f.length!=d.length)throw Error("Mismatch between points and point colors.");e=this._context.createBuffer();f.resize();this._context.bindBuffer(this._context.ARRAY_BUFFER,e);this._context.bufferData(this._context.ARRAY_BUFFER,
f._triplets,this._context.STATIC_DRAW);e=new X.buffer(e,f.count,3);f._dirty=!1}else e=this._colorBuffers.get(c);this._loader.addProgress(0.2);b&&(l&&l._dirty)&&(f=this._scalarBuffers.get(c),goog.isDefAndNotNull(f)&&this._context.isBuffer(f._glBuffer)&&this._context.deleteBuffer(f._glBuffer));f=null;if(l)if(f=l._glArray,!b||l._dirty){if(f.length!=d.length)throw Error("Mismatch between points and scalars.");d=this._context.createBuffer();this._context.bindBuffer(this._context.ARRAY_BUFFER,d);this._context.bufferData(this._context.ARRAY_BUFFER,
f,this._context.STATIC_DRAW);f=new X.buffer(d,f.length,3);l._dirty=!1}else f=this._scalarBuffers.get(c);this._loader.addProgress(0.1);b||this._objects.add(a);this._vertexBuffers.set(c,k);this._normalBuffers.set(c,g);this._colorBuffers.set(c,e);this._texturePositionBuffers.set(c,h);this._scalarBuffers.set(c,f);this._locked=a._dirty=!1}}else a._dirty=!1}}};
X.renderer3D.prototype.showCaption_=function(a,b){var c=this.pick(a,b);if(c=this.get(c))if(c=c._caption){var d=goog.style.getClientPosition(this._container);(new X.caption(this._container,d.x+a+10,d.y+b+10,this._interactor)).setHtml(c)}};
X.renderer3D.prototype.orientVolume_=function(a){var b=X.matrix.multiplyByVector(this._camera._view,a._RASCenter[0]+a._childrenInfo[0]._sliceNormal[0],a._RASCenter[1]+a._childrenInfo[0]._sliceNormal[1],a._RASCenter[2]+a._childrenInfo[0]._sliceNormal[2]),c=X.matrix.multiplyByVector(this._camera._view,a._RASCenter[0]-a._childrenInfo[0]._sliceNormal[0],a._RASCenter[1]-a._childrenInfo[0]._sliceNormal[1],a._RASCenter[2]-a._childrenInfo[0]._sliceNormal[2]),d=Math.abs(b.z-c.z),b=X.matrix.multiplyByVector(this._camera._view,
a._RASCenter[0]+a._childrenInfo[1]._sliceNormal[0],a._RASCenter[1]+a._childrenInfo[1]._sliceNormal[1],a._RASCenter[2]+a._childrenInfo[1]._sliceNormal[2]),c=X.matrix.multiplyByVector(this._camera._view,a._RASCenter[0]-a._childrenInfo[1]._sliceNormal[0],a._RASCenter[1]-a._childrenInfo[1]._sliceNormal[1],a._RASCenter[2]+-a._childrenInfo[1]._sliceNormal[2]),e=Math.abs(b.z-c.z),b=X.matrix.multiplyByVector(this._camera._view,a._RASCenter[0]+a._childrenInfo[2]._sliceNormal[0],a._RASCenter[1]+a._childrenInfo[2]._sliceNormal[1],
a._RASCenter[2]+a._childrenInfo[2]._sliceNormal[2]),c=X.matrix.multiplyByVector(this._camera._view,a._RASCenter[0]-a._childrenInfo[2]._sliceNormal[0],a._RASCenter[1]-a._childrenInfo[2]._sliceNormal[1],a._RASCenter[2]-a._childrenInfo[2]._sliceNormal[2]),b=Math.abs(b.z-c.z),b=Math.max(d,e,b);b==d?a.volumeRendering_(0):b==e?a.volumeRendering_(1):a.volumeRendering_(2)};
X.renderer3D.prototype.distanceToEye_=function(a){var b=a._points._centroid;a=X.matrix.multiplyByVector(a._transform._matrix,b[0],b[1],b[2]);a=X.matrix.multiplyByVector(this._camera._view,a.x,a.y,a.z);a=X.vector.distance(this._camera._position,a);return Math.round(1E3*a)/1E3};
X.renderer3D.prototype.order_=function(){var a=!1,b=this._topLevelObjects,c;c=b.length-1;do{var d=b[c];if(d instanceof X.volume&&d._volumeRendering&&-1!=d._volumeRenderingDirection){var a=d._children[d._volumeRenderingDirection]._children,e=d._volumeRenderingDirection,f=X.matrix.multiplyByVector(this._camera._view,d._RASCenter[0]+d._childrenInfo[e]._sliceDirection[0],d._RASCenter[1]+d._childrenInfo[e]._sliceDirection[1],d._RASCenter[2]+d._childrenInfo[e]._sliceDirection[2]),g=X.matrix.multiplyByVector(this._camera._view,
d._RASCenter[0]-d._childrenInfo[e]._sliceDirection[0],d._RASCenter[1]-d._childrenInfo[e]._sliceDirection[1],d._RASCenter[2]-d._childrenInfo[e]._sliceDirection[2]),f=f.z-g.z,g=Math.max(d._IJKToRAS[d._volumeRenderingDirection],Math.max(d._IJKToRAS[d._volumeRenderingDirection+4],d._IJKToRAS[d._volumeRenderingDirection+8])),h=Math.min(d._IJKToRAS[d._volumeRenderingDirection],Math.min(d._IJKToRAS[d._volumeRenderingDirection+4],d._IJKToRAS[d._volumeRenderingDirection+8]));if(0>f*(g+h))for(f=f=0;f<d._range[e]-
1;f++)a[f]&&(a[f]._opacity=d._opacity,a[f]._distance=d._childrenInfo[e]._sliceSpacing*f);else for(f=d._range[e]-1;0<=f;f--)a[f]&&(a[f]._opacity=d._opacity,a[f]._distance=(d._range[e]-1)*d._childrenInfo[e]._sliceSpacing-d._childrenInfo[e]._sliceSpacing*f);a=!0}}while(c--);b=this._objects.values();c=b.length-1;do if(d=b[c],d._visible&&!(1==d._opacity||d instanceof X.slice))d._distance=this.distanceToEye_(d),a=!0;while(c--);a&&this._objects.sort()};
X.renderer3D.prototype.pick=function(a,b){if(this._config.PICKING_ENABLED){this.render_(!0,!1);var c=new Uint8Array(4);this._context.readPixels(a,this._height-b,1,1,this._context.RGBA,this._context.UNSIGNED_BYTE,c);return c[0]+255*c[1]+65025*c[2]}return-1};
X.renderer3D.prototype.render_=function(a,b){X.renderer3D.superClass_.render_.call(this,a,b);this._context.viewport(0,0,this._width,this._height);this._context.clear(this._context.COLOR_BUFFER_BIT|this._context.DEPTH_BUFFER_BIT);var c=this._objects.values(),d=c.length;if(0!=d){a?this._context.bindFramebuffer(this._context.FRAMEBUFFER,this._pickFrameBuffer):this._context.bindFramebuffer(this._context.FRAMEBUFFER,null);var e=this._camera._perspective,f=this._camera._view;this._context.uniformMatrix4fv(this._uniformLocations.get(X.shaders.uniforms.PERSPECTIVE),
!1,e);this._context.uniformMatrix4fv(this._uniformLocations.get(X.shaders.uniforms.VIEW),!1,f);e=this._center;this._context.uniform3f(this._uniformLocations.get(X.shaders.uniforms.CENTER),parseFloat(e[0]),parseFloat(e[1]),parseFloat(e[2]));f=this._topLevelObjects.length;for(e=0;e<f;++e){var g=this._topLevelObjects[e];g instanceof X.volume&&this.orientVolume_(g)}this._config.ORDERING_ENABLED&&this.order_();if(f=!a&&goog.isDefAndNotNull(b)&&b&&this._config.STATISTICS_ENABLED)var h=0;var e=this._attributePointers,
g=e.get(X.shaders.attributes.VERTEXPOSITION),k=e.get(X.shaders.attributes.VERTEXNORMAL),j=e.get(X.shaders.attributes.VERTEXCOLOR),m=e.get(X.shaders.attributes.VERTEXTEXTUREPOS),l=e.get(X.shaders.attributes.VERTEXSCALAR),e=this._uniformLocations,n=e.get(X.shaders.uniforms.USEPICKING),p=e.get(X.shaders.uniforms.USEOBJECTCOLOR),q=e.get(X.shaders.uniforms.OBJECTCOLOR),r=e.get(X.shaders.uniforms.USESCALARS),s=e.get(X.shaders.uniforms.SCALARSREPLACEMODE),z=e.get(X.shaders.uniforms.SCALARSMIN),x=e.get(X.shaders.uniforms.SCALARSMAX),
t=e.get(X.shaders.uniforms.SCALARSMINCOLOR),u=e.get(X.shaders.uniforms.SCALARSMAXCOLOR),v=e.get(X.shaders.uniforms.SCALARSINTERPOLATION),y=e.get(X.shaders.uniforms.SCALARSMINTHRESHOLD),B=e.get(X.shaders.uniforms.SCALARSMAXTHRESHOLD),A=e.get(X.shaders.uniforms.OBJECTOPACITY),D=e.get(X.shaders.uniforms.LABELMAPOPACITY),G=e.get(X.shaders.uniforms.LABELMAPCOLOR),w=e.get(X.shaders.uniforms.USETEXTURE),C=e.get(X.shaders.uniforms.USELABELMAPTEXTURE),H=e.get(X.shaders.uniforms.TEXTURESAMPLER),E=e.get(X.shaders.uniforms.TEXTURESAMPLER2),
F=e.get(X.shaders.uniforms.VOLUMELOWERTHRESHOLD),L=e.get(X.shaders.uniforms.VOLUMEUPPERTHRESHOLD),Q=e.get(X.shaders.uniforms.VOLUMESCALARMIN),R=e.get(X.shaders.uniforms.VOLUMESCALARMAX),S=e.get(X.shaders.uniforms.VOLUMEWINDOWLOW),N=e.get(X.shaders.uniforms.VOLUMEWINDOWHIGH),U=e.get(X.shaders.uniforms.VOLUMESCALARMINCOLOR),Z=e.get(X.shaders.uniforms.VOLUMESCALARMAXCOLOR),Y=e.get(X.shaders.uniforms.VOLUMETEXTURE),aa=e.get(X.shaders.uniforms.OBJECTTRANSFORM),ba=e.get(X.shaders.uniforms.POINTSIZE),e=
d;do{var I=c[d-e];if(I){var J=null;I instanceof X.slice&&I._volume&&(J=I._volume);if(I._visible&&(!J||J._visible)&&(!a||I._pickable)){var K=I._id,M=I._magicmode,O=this._vertexBuffers.get(K),P=this._normalBuffers.get(K),V=this._colorBuffers.get(K),T=this._scalarBuffers.get(K),W=this._texturePositionBuffers.get(K);this._context.bindBuffer(this._context.ARRAY_BUFFER,O._glBuffer);this._context.vertexAttribPointer(g,O._itemSize,this._context.FLOAT,!1,0,0);this._context.bindBuffer(this._context.ARRAY_BUFFER,
P._glBuffer);this._context.vertexAttribPointer(k,P._itemSize,this._context.FLOAT,!1,0,0);a?this._context.uniform1i(n,!0):this._context.uniform1i(n,!1);V&&!a&&!M?(this._context.uniform1i(p,!1),this._context.bindBuffer(this._context.ARRAY_BUFFER,V._glBuffer),this._context.vertexAttribPointer(j,V._itemSize,this._context.FLOAT,!1,0,0)):(P=1,M&&!a&&(P=0),this._context.uniform1i(p,P),P=I._color,a&&(P=[Math.floor(K%65025%255)/255,Math.floor(K%65025/255)/255,Math.floor(K/65025)/255]),this._context.uniform3f(q,
parseFloat(P[0]),parseFloat(P[1]),parseFloat(P[2])),this._context.vertexAttribPointer(j,O._itemSize,this._context.FLOAT,!1,0,0));T&&!a&&!M?(this._context.uniform1i(r,!0),this._context.uniform1i(s,I._scalars._replaceMode),K=I._scalars._minColor,M=I._scalars._maxColor,this._context.uniform3f(t,parseFloat(K[0]),parseFloat(K[1]),parseFloat(K[2])),this._context.uniform3f(u,parseFloat(M[0]),parseFloat(M[1]),parseFloat(M[2])),this._context.uniform1f(y,parseFloat(I._scalars._lowerThreshold)),this._context.uniform1f(B,
parseFloat(I._scalars._upperThreshold)),this._context.uniform1f(z,parseFloat(I._scalars._min)),this._context.uniform1f(x,parseFloat(I._scalars._max)),this._context.uniform1i(v,parseInt(I._scalars._interpolation,10)),this._context.bindBuffer(this._context.ARRAY_BUFFER,T._glBuffer),this._context.vertexAttribPointer(l,T._itemSize,this._context.FLOAT,!1,0,0)):(this._context.uniform1i(r,!1),this._context.vertexAttribPointer(l,O._itemSize,this._context.FLOAT,!1,0,0));this._context.uniform1f(A,parseFloat(I._opacity));
I._texture&&W&&!a?(this._context.uniform1i(w,!0),this._context.activeTexture(this._context.TEXTURE0),this._context.bindTexture(this._context.TEXTURE_2D,this._textures.get(I._texture._id)),this._context.uniform1i(H,0),this._context.bindBuffer(this._context.ARRAY_BUFFER,W._glBuffer),this._context.vertexAttribPointer(m,W._itemSize,this._context.FLOAT,!1,0,0),this._context.uniform1i(Y,!1)):(this._context.uniform1i(w,!1),this._context.vertexAttribPointer(m,O._itemSize,this._context.FLOAT,!1,0,0));J&&(this._context.uniform1i(Y,
!0),this._context.uniform1f(F,J._lowerThreshold),this._context.uniform1f(L,J._upperThreshold),this._context.uniform1f(Q,J._min),this._context.uniform1f(R,J._max),K=J._minColor,M=J._maxColor,this._context.uniform3f(U,parseFloat(K[0]),parseFloat(K[1]),parseFloat(K[2])),this._context.uniform3f(Z,parseFloat(M[0]),parseFloat(M[1]),parseFloat(M[2])),this._context.uniform1f(S,J._windowLow),this._context.uniform1f(N,J._windowHigh),T=J._labelmap,this._context.uniform1i(C,!1),J._volumeRendering?this._context.uniform1f(A,
parseFloat(J._opacity)):T&&T._visible&&(J=I._labelmap._id,this._context.uniform1i(C,!0),this._context.activeTexture(this._context.TEXTURE1),this._context.bindTexture(this._context.TEXTURE_2D,this._textures.get(J)),this._context.uniform1i(E,1),this._context.uniform1f(D,T._opacity),this._context.uniform4fv(G,T._showOnlyColor)));this._context.uniformMatrix4fv(aa,!1,I._transform._matrix);J=1;I._type==X.displayable.types.POINTS&&(J=I._pointsize);this._context.uniform1f(ba,J);J=-1;I._type==X.displayable.types.TRIANGLES?
(J=this._context.TRIANGLES,f&&(h+=O._itemCount/3)):I._type==X.displayable.types.LINES?(this._context.lineWidth(I._linewidth),J=this._context.LINES):I._type==X.displayable.types.POINTS?J=this._context.POINTS:I._type==X.displayable.types.TRIANGLE_STRIPS?(J=this._context.TRIANGLE_STRIP,f&&(h+=O._itemCount/3)):I._type==X.displayable.types.POLYGONS&&(J=0==O._itemCount%3?this._context.TRIANGLES:this._context.TRIANGLE_FAN,f&&(h+=O._itemCount/3));this._context.drawArrays(J,0,O._itemCount)}}}while(--e);f&&
(Math.round(h),this._textures.getCount())}};
X.renderer3D.prototype.remove=function(a){X.renderer3D.superClass_.remove.call(this,a);if(0<a._children.length)for(var b=a._children,c=b.length,d=0,d=0;d<c;d++)"undefined"!=typeof b[d]&&this.remove(b[d]);b=a._id;c=this._texturePositionBuffers.get(b);goog.isDefAndNotNull(c)&&this._context.isBuffer(c._glBuffer)&&this._context.deleteBuffer(c._glBuffer);if(a._texture&&(c=this._textures.get(a._texture._id)))this._context.deleteTexture(c),this._textures.remove(a._texture._id);c=this._vertexBuffers.get(b);
goog.isDefAndNotNull(c)&&this._context.isBuffer(c._glBuffer)&&this._context.deleteBuffer(c._glBuffer);c=this._normalBuffers.get(b);goog.isDefAndNotNull(c)&&this._context.isBuffer(c._glBuffer)&&this._context.deleteBuffer(c._glBuffer);c=this._colorBuffers.get(b);goog.isDefAndNotNull(c)&&this._context.isBuffer(c._glBuffer)&&this._context.deleteBuffer(c._glBuffer);c=this._scalarBuffers.get(b);goog.isDefAndNotNull(c)&&this._context.isBuffer(c._glBuffer)&&this._context.deleteBuffer(c._glBuffer);this._vertexBuffers.remove(b);
this._normalBuffers.remove(b);this._colorBuffers.remove(b);this._texturePositionBuffers.remove(b);this._scalarBuffers.remove(b);this._objects.remove(a);return!0};X.renderer3D.prototype.destroy=function(){this._shaders=null;delete this._shaders;this._context.clear(this._context.COLOR_BUFFER_BIT|this._context.DEPTH_BUFFER_BIT);X.renderer3D.superClass_.destroy.call(this)};X.renderer3D.prototype.__defineGetter__("bgColor",function(){return this._bgColor});
X.renderer3D.prototype.__defineSetter__("bgColor",function(a){this._bgColor=a});X.renderer3D.prototype.ray_intersect_box_=function(a,b,c){for(var d=[],e=[],f=0;6>f;f++){var g=Math.floor(f/2),h=(g+1)%3,k=(g+2)%3,j=(2+2*g)%6,m=(4+2*g)%6,l=(a[f]-b[g])*(1/c[g]);if(Infinity!=l&&-Infinity!=l){var n=b[h]+c[h]*l,l=b[k]+c[k]*l;n>=a[j]&&n<=a[j+1]&&l>=a[m]&&l<=a[m+1]?(j=[],j[g]=a[f],j[h]=n,j[k]=l,d.push(j)):(j=[],j[g]=a[f],j[h]=n,j[k]=l,e.push(j))}}return[d,e]};
X.renderer3D.prototype.pick3d=function(a,b,c,d,e){goog.isDefAndNotNull(c)||(c=4);goog.isDefAndNotNull(d)||(d=2);if(!goog.isDefAndNotNull(e)){e=this.pick(a,b);if(-1==e)return null;e=this.get(e);if(!e)return null}var f=this._camera.unproject_(2*(a/this._width)-1,2*((this._height-b)/this._height)-1,0);a=this._camera.unproject_(2*(a/this._width)-1,2*((this._height-b)/this._height)-1,1);f[0]+=this._center[0];f[1]+=this._center[1];f[2]+=this._center[2];a[0]+=this._center[0];a[1]+=this._center[1];a[2]+=
this._center[2];b=[e._points._minA,e._points._minB,e._points._minC];var g=[e._points._maxA,e._points._minB,e._points._minC],h=[e._points._maxA,e._points._maxB,e._points._minC],k=[e._points._minA,e._points._maxB,e._points._minC],j=[e._points._minA,e._points._maxB,e._points._maxC],m=[e._points._minA,e._points._minB,e._points._maxC],l=[e._points._maxA,e._points._maxB,e._points._maxC],n=[e._points._maxA,e._points._minB,e._points._maxC];b=[X.matrix.multiplyByVector(e._transform._matrix,b[0],b[1],b[2]),
X.matrix.multiplyByVector(e._transform._matrix,g[0],g[1],g[2]),X.matrix.multiplyByVector(e._transform._matrix,h[0],h[1],h[2]),X.matrix.multiplyByVector(e._transform._matrix,k[0],k[1],k[2]),X.matrix.multiplyByVector(e._transform._matrix,j[0],j[1],j[2]),X.matrix.multiplyByVector(e._transform._matrix,m[0],m[1],m[2]),X.matrix.multiplyByVector(e._transform._matrix,l[0],l[1],l[2]),X.matrix.multiplyByVector(e._transform._matrix,n[0],n[1],n[2])];var g=[Infinity,-Infinity,Infinity,-Infinity,Infinity,-Infinity],
p;for(p in b)p=b[p],g=[Math.min(g[0],p.x),Math.max(g[1],p.x),Math.min(g[2],p.y),Math.max(g[3],p.y),Math.min(g[4],p.z),Math.max(g[5],p.z)];p=this.ray_intersect_box_(g,f,a);p=p[0];if(0==p.length)return null;g=Array(2);for(a=0;2>a;a++)b=p[a],g[a]=Math.sqrt((b[0]-f[0])*(b[0]-f[0])+(b[1]-f[1])*(b[1]-f[1])+(b[2]-f[2])*(b[2]-f[2]));f=b=a=null;g[0]<g[1]?(a=p[0],b=p[1]):(a=p[1],b=p[0]);f=Math.sqrt((a[0]-b[0])*(a[0]-b[0])+(a[1]-b[1])*(a[1]-b[1])+(a[2]-b[2])*(a[2]-b[2]));f/=c;p=a;a=[b[0]-a[0],b[1]-a[1],b[2]-
a[2]];b=Math.sqrt(a[0]*a[0]+a[1]*a[1]+a[2]*a[2]);g=[a[0]/b,a[1]/b,a[2]/b];h=e._points._triplets;k=h.length;for(a=0;a<f;a+=c){p=[p[0]+c*g[0],p[1]+c*g[1],p[2]+c*g[2]];for(b=0;b<k;b+=3)if(j=h[b],m=h[b+1],l=h[b+2],n=new X.vector(j,m,l),n=X.matrix.multiplyByVector(e._transform._matrix,j,m,l),Math.sqrt((p[0]-n.x)*(p[0]-n.x)+(p[1]-n.y)*(p[1]-n.y)+(p[2]-n.z)*(p[2]-n.z))<=d)return[n.x,n.y,n.z]}return null};goog.exportSymbol("X.renderer3D",X.renderer3D);goog.exportSymbol("X.renderer3D.prototype.init",X.renderer3D.prototype.init);
goog.exportSymbol("X.renderer3D.prototype.add",X.renderer3D.prototype.add);goog.exportSymbol("X.renderer3D.prototype.onShowtime",X.renderer3D.prototype.onShowtime);goog.exportSymbol("X.renderer3D.prototype.onRender",X.renderer3D.prototype.onRender);goog.exportSymbol("X.renderer3D.prototype.get",X.renderer3D.prototype.get);goog.exportSymbol("X.renderer3D.prototype.render",X.renderer3D.prototype.render);goog.exportSymbol("X.renderer3D.prototype.destroy",X.renderer3D.prototype.destroy);
goog.exportSymbol("X.renderer3D.prototype.remove",X.renderer3D.prototype.remove);goog.exportSymbol("X.renderer3D.prototype.resetBoundingBox",X.renderer3D.prototype.resetBoundingBox);goog.exportSymbol("X.renderer3D.prototype.resetViewAndRender",X.renderer3D.prototype.resetViewAndRender);goog.exportSymbol("X.renderer3D.prototype.pick",X.renderer3D.prototype.pick);goog.exportSymbol("X.renderer3D.prototype.pick3d",X.renderer3D.prototype.pick3d);goog.exportSymbol("X.renderer3D.prototype.afterRender",X.renderer3D.prototype.afterRender);
goog.exportSymbol("X.renderer3D.prototype.resize",X.renderer3D.prototype.resize);X.mesh=function(){X.object.call(this);this._classname="mesh";inject(this,new X.loadable)};goog.inherits(X.mesh,X.object);goog.exportSymbol("X.mesh",X.mesh);X.fibers=function(){X.object.call(this);this._classname="fibers";inject(this,new X.loadable)};goog.inherits(X.fibers,X.object);goog.exportSymbol("X.fibers",X.fibers);X.renderer2D=function(){X.renderer.call(this);this._classname="renderer2D";this._orientation=null;this._orientationIndex=-1;this._orientationColors=[];this._labelFrameBufferContext=this._labelFrameBuffer=this._frameBufferContext=this._frameBuffer=null;this._sliceHeightSpacing=this._sliceWidthSpacing=this._sliceHeight=this._sliceWidth=0;this._windowHigh=this._windowLow=this._upperThreshold=this._lowerThreshold=this._currentSlice=-1;this._labelmapShowOnlyColor=new Float32Array([-255,-255,-255,-255]);
this._radiological=!0;this._normalizedScale=1};goog.inherits(X.renderer2D,X.renderer);X.renderer2D.prototype.remove=function(a){X.renderer2D.superClass_.remove.call(this,a);this._objects.remove(a);return!0};X.renderer2D.prototype.onScroll=function(){};X.renderer2D.prototype.onWindowLevel=function(){};
X.renderer2D.prototype.onScroll_=function(a){X.renderer2D.superClass_.onScroll_.call(this,a);var b=this._topLevelObjects[0];if(b){var c="",c=0==this._orientationIndex?"indexX":1==this._orientationIndex?"indexY":"indexZ";b[c]=a._up?b[c]+1:b[c]-1;eval("this.onScroll();")}};
X.renderer2D.prototype.onWindowLevel_=function(a){var b=this._topLevelObjects[0];if(b){var c=b._windowHigh-b._windowLow,d=c/2,e=parseInt(c+c/15*-a._window,10);a=parseInt(d+d/15*a._level,10);c==e&&e++;d==a&&a++;b._windowLow-=parseInt(d-a,10);b._windowLow-=parseInt(c-e,10);b._windowLow=Math.max(b._windowLow,b._min);b._windowHigh-=parseInt(d-a,10);b._windowHigh+=parseInt(c-e,10);b._windowHigh=Math.min(b._windowHigh,b._max);eval("this.onWindowLevel();")}};
X.renderer2D.prototype.__defineGetter__("orientation",function(){return this._orientation});X.renderer2D.prototype.__defineSetter__("orientation",function(a){a=a.toUpperCase();"AXIAL"==a?(a="Z",this._orientationIndex=2):"SAGITTAL"==a?(a="X",this._orientationIndex=0):"CORONAL"==a&&(a="Y",this._orientationIndex=1);if("X"!=a&&"Y"!=a&&"Z"!=a)throw Error("Invalid orientation.");this._orientation=a});X.renderer2D.prototype.__defineGetter__("radiological",function(){return this._radiological});
X.renderer2D.prototype.__defineGetter__("normalizedScale",function(){return this._normalizedScale});X.renderer2D.prototype.__defineGetter__("canvasWidth",function(){return this._canvas.width});X.renderer2D.prototype.__defineGetter__("canvasHeight",function(){return this._canvas.height});X.renderer2D.prototype.__defineGetter__("sliceWidth",function(){return this._sliceWidth});X.renderer2D.prototype.__defineGetter__("sliceHeight",function(){return this._sliceHeight});
X.renderer2D.prototype.__defineSetter__("radiological",function(a){this._radiological=a});
X.renderer2D.prototype.init=function(){if(!this._orientation)throw Error("No 2D orientation set.");X.renderer2D.superClass_.init.call(this,"2d");this._context.fillStyle="rgba(50,50,50,0)";this._context.fillRect(0,0,this._canvas.width,this._canvas.height);this._frameBuffer=goog.dom.createDom("canvas");this._labelFrameBuffer=goog.dom.createDom("canvas");this._labelFrameBuffer.style.imageRendering="pixelated";goog.events.listen(this._camera,X.event.events.WINDOWLEVEL,this.onWindowLevel_.bind(this))};
X.renderer2D.prototype.onResize_=function(){X.renderer2D.superClass_.onResize_.call(this);this.autoScale_()};X.renderer2D.prototype.resetViewAndRender=function(){X.renderer2D.superClass_.resetViewAndRender.call(this);this.autoScale_();var a=this._topLevelObjects[0];a&&(a._windowHigh=a._max,a._windowLow=a._min)};X.renderer2D.prototype.volumeChildrenIndex_=function(a){return"X"==a?0:"Y"==a?1:2};X.renderer2D.prototype.update=function(a){this.update_(a);this._currentSlice=-1};
X.renderer2D.prototype.update_=function(a){X.renderer2D.superClass_.update_.call(this,a);var b=!1;this.get(a._id)&&(b=!0);if(a instanceof X.volume){var c=a._file,d=a._labelmap,e=a._colortable;if(goog.isDefAndNotNull(d)&&goog.isDefAndNotNull(d._file)&&d._file._dirty)this.update_(d);else if(goog.isDefAndNotNull(e)&&goog.isDefAndNotNull(e._file)&&e._file._dirty)this._loader.load(e,a);else{if(goog.isDefAndNotNull(c)&&goog.isArray(c))if(goog.isDefAndNotNull(a.MRI)){if(a.MRI.loaded_files!=c.length)return}else{b=
0;d=c.length;for(b=0;b<d;b++)this._loader.load(c[b],a);return}else if(goog.isDefAndNotNull(c)&&c._dirty){this._loader.load(a,a);return}this._orientationIndex=this.volumeChildrenIndex_(this._orientation);this._slices=a._children[this._orientationIndex]._children;e=null;e=0==this._orientationIndex?a.indexX:1==this._orientationIndex?a.indexY:a.indexZ;c=a._children[this._orientationIndex]._children[e]._iWidth;d=a._children[this._orientationIndex]._children[e]._iHeight;this._sliceWidthSpacing=a._children[this._orientationIndex]._children[e]._widthSpacing;
this._sliceHeightSpacing=a._children[this._orientationIndex]._children[e]._heightSpacing;this._sliceWidth=c;this._sliceHeight=d;e=this._frameBuffer;e.width=c;e.height=d;var f=this._labelFrameBuffer;f.width=c;f.height=d;this._frameBufferContext=e.getContext("2d");this._labelFrameBufferContext=f.getContext("2d");b||(this._objects.add(a),this.autoScale_())}}};
X.renderer2D.prototype.autoScale_=function(){var a=Math.min(this._width/(this._sliceWidth*this._sliceWidthSpacing),this._height/(this._sliceHeight*this._sliceHeightSpacing));this._camera._view[14]=a};X.renderer2D.prototype.onSliceNavigation=function(){};
X.renderer2D.prototype.xy2ijk=function(a,b){var c=this._topLevelObjects[0],d=this._camera._view,e=null,f=this._sliceWidth,g=this._sliceHeight,h=null,k=null;if("Y"==this._orientation)e=this._slices[parseInt(c.indexY,10)],h=e._widthSpacing,k=e._heightSpacing,this._orientationColors[0]="rgba(255,0,0,.3)",this._orientationColors[1]="rgba(0,0,255,.3)";else if("Z"==this._orientation)e=this._slices[parseInt(c.indexZ,10)],h=e._widthSpacing,k=e._heightSpacing,this._orientationColors[0]="rgba(255,0,0,.3)",
this._orientationColors[1]="rgba(0,255,0,.3)";else{e=this._slices[parseInt(c.indexX,10)];h=e._heightSpacing;k=e._widthSpacing;this._orientationColors[0]="rgba(0,255,0,.3)";this._orientationColors[1]="rgba(0,0,255,.3)";var j=f,f=g,g=j}var m=1*d[12],d=-1*d[13],j=[this._width/2,this._height/2],h=f*h*this._normalizedScale,k=g*k*this._normalizedScale,l=j[0]-h/2,j=j[1]-k/2,l=l+m*this._normalizedScale,j=j+d*this._normalizedScale;return a>l&&a<l+h&&b>j&&b<j+k?(m=(a-l)/h*f,d=(b-j)/k*g,k=e._xyBBox[4],"X"==
this._orientation?(j=f-m,m=d,d=j):"Y"==this._orientation?m=f-m:"Z"==this._orientation&&(m=f-m,d=g-d),m=e._wmin+m*e._widthSpacing,d=e._hmin+d*e._heightSpacing,m=goog.vec.Vec4.createFloat32FromValues(m,d,k,1),f=goog.vec.Mat4.createFloat32(),goog.vec.Mat4.multVec4(e._XYToIJK,m,f),f=[Math.floor(f[0]),Math.floor(f[1]),Math.floor(f[2])],g=goog.vec.Mat4.createFloat32(),goog.vec.Mat4.multVec4(e._XYToRAS,m,g),e=Math.round((c._childrenInfo[0]._sliceNormal[0]*g[0]+c._childrenInfo[0]._sliceNormal[1]*g[1]+c._childrenInfo[0]._sliceNormal[2]*
g[2]+c._childrenInfo[0]._originD)/c._childrenInfo[0]._sliceSpacing),e>=c._childrenInfo[0]._nb?e=c._childrenInfo[0]._nb-1:0>e&&(e=0),m=Math.round((c._childrenInfo[1]._sliceNormal[0]*g[0]+c._childrenInfo[1]._sliceNormal[1]*g[1]+c._childrenInfo[1]._sliceNormal[2]*g[2]+c._childrenInfo[1]._originD)/c._childrenInfo[1]._sliceSpacing),m>=c._childrenInfo[1]._nb?m=c._childrenInfo[1]._nb-1:0>m&&(m=0),d=Math.round((c._childrenInfo[2]._sliceNormal[0]*g[0]+c._childrenInfo[2]._sliceNormal[1]*g[1]+c._childrenInfo[2]._sliceNormal[2]*
g[2]+c._childrenInfo[2]._originD)/c._childrenInfo[2]._sliceSpacing),d>=c._childrenInfo[2]._nb?d=c._childrenInfo[2]._nb-1:0>d&&(d=0),[[e,m,d],[f[0],f[1],f[2]],[g[0],g[1],g[2]]]):null};
X.renderer2D.prototype.render_=function(a,b){X.renderer2D.superClass_.render_.call(this,a,b);if(0!=this._objects.values().length){var c=this._topLevelObjects[0],d=null,d=0==this._orientationIndex?c.indexX:1==this._orientationIndex?c.indexY:c.indexZ,e=this._slices[parseInt(d,10)]._iWidth,f=this._slices[parseInt(d,10)]._iHeight;this._sliceWidthSpacing=this._slices[parseInt(d,10)]._widthSpacing;this._sliceHeightSpacing=this._slices[parseInt(d,10)]._heightSpacing;this._sliceWidth=e;this._sliceHeight=
f;var g=this._width,h=this._height,k=this._camera._view;this._context.save();this._context.clearRect(-g,-h,2*g,2*h);this._context.restore();this._normalizedScale=Math.max(k[14],1E-4);this._context.setTransform(this._normalizedScale,0,0,this._normalizedScale,0,0);var j=1*k[12],k=-1*k[13],m=null;c._labelmap&&(m=c._labelmap._showOnlyColor);var l=this._slices[parseInt(d,10)],n=l._texture._rawData,l=l._labelmap,p=null;l&&(p=l._rawData);var q=this._sliceWidth,r=this._sliceHeight,s=this._frameBufferContext,
z=this._labelFrameBufferContext,x=s.getImageData(0,0,q,r),t=z.getImageData(0,0,q,r),u=x.data,v=t.data,y=u.length,B=c._lowerThreshold,A=c._upperThreshold,D=c._windowLow,G=c._windowHigh;if(this._currentSlice!=d||this._lowerThreshold!=B||this._upperThreshold!=A||this._windowLow!=D||this._windowHigh!=G||m&&!X.array.compare(m,this._labelmapShowOnlyColor,0,0,4)){var w=this._frameBuffer;w.width=e;w.height=f;w=this._labelFrameBuffer;w.width=e;w.height=f;e=0;do{var w=[0,0,0,0],f=[0,0,0,0],C=n[e]/255*(c._max-
c._min)+c._min,H=G-D,E=H/2+D,F=0,F=C<E-H/2?0:C>E+H/2?255:255*(C-(E-H/2))/H;C>=B&&C<=A&&(w=new goog.math.Vec3(c._maxColor[0],c._maxColor[1],c._maxColor[2]),C=new goog.math.Vec3(c._minColor[0],c._minColor[1],c._minColor[2]),w=w.scale(F).add(C.scale(255-F)),w=[Math.floor(w.x),Math.floor(w.y),Math.floor(w.z),255],l&&(-255==m[3]?f=[p[e],p[e+1],p[e+2],p[e+3]]:X.array.compare(m,p,0,e,4)&&(f=[p[e],p[e+1],p[e+2],p[e+3]])));"X"==this._orientation?(u[e]=w[0],u[e+1]=w[1],u[e+2]=w[2],u[e+3]=w[3],v[e]=f[0],v[e+
1]=f[1],v[e+2]=f[2],v[e+3]=f[3]):"Y"==this._orientation?(F=Math.floor(e/(4*q)),F=4*F*q+(4*(q-1)-(e-4*F*q)),u[F]=w[0],u[F+1]=w[1],u[F+2]=w[2],u[F+3]=w[3],v[F]=f[0],v[F+1]=f[1],v[F+2]=f[2],v[F+3]=f[3]):(F=y-1-e,u[F-3]=w[0],u[F-2]=w[1],u[F-1]=w[2],u[F]=w[3],v[F-3]=f[0],v[F-2]=f[1],v[F-1]=f[2],v[F]=f[3]);e+=4}while(e<y);s.putImageData(x,0,0);z.putImageData(t,0,0);this._currentSlice=d;this._lowerThreshold=B;this._upperThreshold=A;this._windowLow=D;this._windowHigh=G;l&&(this._labelmapShowOnlyColor=m)}this._context.globalAlpha=
1;this._context.translate(g/2/this._normalizedScale,h/2/this._normalizedScale);"X"==this._orientation&&(this._context.rotate(0.5*Math.PI),d=j,j=k,k=-d);j=-q*this._sliceWidthSpacing/2+j;k=-r*this._sliceHeightSpacing/2+k;this._context.drawImage(this._frameBuffer,j,k,q*this._sliceWidthSpacing,r*this._sliceHeightSpacing);l&&c._labelmap._visible&&(this._context.globalAlpha=1,this._context.drawImage(this._labelFrameBuffer,j,k,q*this._sliceWidthSpacing,r*this._sliceHeightSpacing));if(this._config.SLICENAVIGATORS)if(this._canvas.style.cursor=
"none",this._interactor._mouseInside&&this._interactor._shiftDown&&!this._interactor._leftButtonDown){if(j=this._interactor._mousePosition,j=this.xy2ijk(j[0],j[1]))c._indexX=j[0][0],c._indexY=j[0][1],c._indexZ=j[0][2],c.modified(!1),this.onSliceNavigation(),this._context.setTransform(1,0,0,1,0,0),this._context.beginPath(),this._context.moveTo(this._interactor._mousePosition[0],0),this._context.lineTo(this._interactor._mousePosition[0],this._interactor._mousePosition[1]-1),this._context.moveTo(this._interactor._mousePosition[0],
this._interactor._mousePosition[1]+1),this._context.lineTo(this._interactor._mousePosition[0],this._height),this._context.strokeStyle=this._orientationColors[0],this._context.stroke(),this._context.closePath(),this._context.beginPath(),this._context.moveTo(0,this._interactor._mousePosition[1]),this._context.lineTo(this._interactor._mousePosition[0]-1,this._interactor._mousePosition[1]),this._context.moveTo(this._interactor._mousePosition[0]+1,this._interactor._mousePosition[1]),this._context.lineTo(this._width,
this._interactor._mousePosition[1]),this._context.strokeStyle=this._orientationColors[1],this._context.stroke(),this._context.closePath(),this._context.font="10pt Arial",this._context.textAlign="left",this._context.textBaseline="top",this._context.fillStyle="white",this._context.fillText("RAS: "+j[2][0].toFixed(2)+", "+j[2][1].toFixed(2)+", "+j[2][2].toFixed(2),0,0),q=l=k="undefined","undefined"!=typeof c._IJKVolume[j[1][2].toFixed(0)]&&"undefined"!=typeof c._IJKVolume[j[1][2].toFixed(0)][j[1][1].toFixed(0)]&&
(k=c._IJKVolume[j[1][2].toFixed(0)][j[1][1].toFixed(0)][j[1][0].toFixed(0)],c.hasLabelMap&&(l=c._labelmap._IJKVolume[j[1][2].toFixed(0)][j[1][1].toFixed(0)][j[1][0].toFixed(0)],c._labelmap._colorTable&&(q=c._labelmap._colorTable.get(l),"undefined"!=typeof q&&(q=q[0])))),this._context.fillText("Background:  "+k+" ("+j[1][0].toFixed(0)+", "+j[1][1].toFixed(0)+", "+j[1][2].toFixed(0)+")",0,15),c.hasLabelMap&&this._context.fillText("Labelmap:  "+q+" ("+l+")",0,30)}else this._canvas.style.cursor="default"}};
goog.exportSymbol("X.renderer2D",X.renderer2D);goog.exportSymbol("X.renderer2D.prototype.init",X.renderer2D.prototype.init);goog.exportSymbol("X.renderer2D.prototype.add",X.renderer2D.prototype.add);goog.exportSymbol("X.renderer2D.prototype.onShowtime",X.renderer2D.prototype.onShowtime);goog.exportSymbol("X.renderer2D.prototype.onRender",X.renderer2D.prototype.onRender);goog.exportSymbol("X.renderer2D.prototype.onScroll",X.renderer2D.prototype.onScroll);
goog.exportSymbol("X.renderer2D.prototype.onWindowLevel",X.renderer2D.prototype.onWindowLevel);goog.exportSymbol("X.renderer2D.prototype.get",X.renderer2D.prototype.get);goog.exportSymbol("X.renderer2D.prototype.resetViewAndRender",X.renderer2D.prototype.resetViewAndRender);goog.exportSymbol("X.renderer2D.prototype.xy2ijk",X.renderer2D.prototype.xy2ijk);goog.exportSymbol("X.renderer2D.prototype.render",X.renderer2D.prototype.render);goog.exportSymbol("X.renderer2D.prototype.destroy",X.renderer2D.prototype.destroy);
goog.exportSymbol("X.renderer2D.prototype.onSliceNavigation",X.renderer2D.prototype.onSliceNavigation);goog.exportSymbol("X.renderer2D.prototype.afterRender",X.renderer2D.prototype.afterRender);goog.exportSymbol("X.renderer2D.prototype.resize",X.renderer2D.prototype.resize);
